<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">

<script>
    (function(){
        if(''){
            if (prompt('博主私有文章，请输入密码:  shulu520') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>


  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">










  <meta name="baidu-site-verification" content="J3muXvxFkF">







  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.jpg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Python,">





  <link rel="alternate" href="/rss2.xml" title="梦不成" type="application/atom+xml">







  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "5af61f84"
    });
  daovoice('update');
  </script>


<meta name="description" content="数据分析工具：Pandas数据处理">
<meta name="keywords" content="Python">
<meta property="og:type" content="article">
<meta property="og:title" content="Python数据分析之pandas">
<meta property="og:url" content="https://shulu520.com/数据分析/Python数据分析之工具-pandas笔记/index.html">
<meta property="og:site_name" content="梦不成">
<meta property="og:description" content="数据分析工具：Pandas数据处理">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c5a39f844ef46bb238dceb.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c5a4f2844ef46bb251d529.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c5a634844ef46bb26964a1.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c5a6c4844ef46bb273d040.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c59c6a844ef46bb2add6ef.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c59dd9844ef46bb2c98a74.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c5efa3844ef46bb2788259.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c5f042844ef46bb27ed87d.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c78486844ef46bb22b3173.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c784c9844ef46bb231010d.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c785d5844ef46bb2482f34.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/60c7852a844ef46bb2394e54.jpg">
<meta property="og:updated_time" content="2021-06-15T15:51:12.220Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python数据分析之pandas">
<meta name="twitter:description" content="数据分析工具：Pandas数据处理">
<meta name="twitter:image" content="https://pic.imgdb.cn/item/60c5a39f844ef46bb238dceb.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://shulu520.com/数据分析/Python数据分析之工具-pandas笔记/">





  <title>Python数据分析之pandas | 梦不成</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">梦不成</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">思念如马-自别离-未停蹄</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于我
          </a>
        </li>
      
        
        <li class="menu-item menu-item-love">
          <a href="/love/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            love
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            文章标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            文章分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            文章归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-留言板">
          <a href="/guestbook" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br>
            
            留言板
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="来啊，快来探索我的秘密吧..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>




<link href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" rel="stylesheet"> </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://shulu520.com/数据分析/Python数据分析之工具-pandas笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="梦不成">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head_icon.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="梦不成">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Python数据分析之pandas</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-04-15T12:42:39+08:00">
                2021-04-15
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新&#58;</span>
              
              <time title="更新" itemprop="dateModified" datetime="2021-06-15T23:51:12+08:00">
                2021-06-15
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据分析/" itemprop="url" rel="index">
                    <span itemprop="name">数据分析</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-free-code-camp"></i> 热度
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>🔥
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数&#58;</span>
                
                <span title="字数">
                  9.3k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  48 分钟
                </span>
              
            </div>
          

          
              <div class="post-description">
                  数据分析工具：Pandas数据处理
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="忽略警告warnings"><a href="#忽略警告warnings" class="headerlink" title="忽略警告warnings"></a>忽略警告warnings</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import warnings</span><br><span class="line">warnings.filterwarnings(&quot;ignore&quot;)</span><br></pre></td></tr></table></figure>
<h2 id="读取指定列的数据usecols"><a href="#读取指定列的数据usecols" class="headerlink" title="读取指定列的数据usecols"></a>读取指定列的数据usecols</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data=pd.read_excel(&apos;./豆瓣电影数据.xlsx&apos;,usecols=[&apos;名字&apos;,&apos;评分&apos;])</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>
<h2 id="Serious对象转list，只拿到值，不要索引"><a href="#Serious对象转list，只拿到值，不要索引" class="headerlink" title="Serious对象转list，只拿到值，不要索引"></a>Serious对象转list，只拿到值，不要索引</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ls=[1,2,3]</span><br><span class="line">s=pd.Series(ls)</span><br><span class="line">print(s) #带索引的1，2，3</span><br><span class="line">print(s.values[0]) #转为列表，就可以只拿到值了</span><br></pre></td></tr></table></figure>
<h2 id="pandas-DataFrame列操作"><a href="#pandas-DataFrame列操作" class="headerlink" title="pandas DataFrame列操作"></a>pandas DataFrame列操作</h2><h3 id="列获取选择"><a href="#列获取选择" class="headerlink" title="列获取选择"></a>列获取选择</h3><h4 id="单列选择"><a href="#单列选择" class="headerlink" title="单列选择"></a>单列选择</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[&apos;name&apos;] 或df.name 或df.get(&apos;name&apos;) </span><br><span class="line">#只有get方法找不到不报错，返回none</span><br></pre></td></tr></table></figure>
<h4 id="多列选择"><a href="#多列选择" class="headerlink" title="多列选择"></a>多列选择</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[(df[&apos;one&apos;] &gt; 0) &amp; (df[&apos;two&apos;] &lt; 3)]</span><br></pre></td></tr></table></figure>
<h3 id="列删除-del-df-‘age’"><a href="#列删除-del-df-‘age’" class="headerlink" title="列删除 del df[‘age’]"></a>列删除 del df[‘age’]</h3><h2 id="pandas-DataFrame行操作"><a href="#pandas-DataFrame行操作" class="headerlink" title="pandas DataFrame行操作"></a>pandas DataFrame行操作</h2><h3 id="行选择df-loc-‘b’"><a href="#行选择df-loc-‘b’" class="headerlink" title="行选择df.loc[‘b’]"></a>行选择df.loc[‘b’]</h3><h3 id="行选择df-iloc-2-按数字index值"><a href="#行选择df-iloc-2-按数字index值" class="headerlink" title="行选择df.iloc[2] 按数字index值"></a>行选择df.iloc[2] 按数字index值</h3><h3 id="切片操作-运算符可以选择多行"><a href="#切片操作-运算符可以选择多行" class="headerlink" title="切片操作: 运算符可以选择多行"></a>切片操作<code>:</code> 运算符可以选择多行</h3><h3 id="loc和iloc，第二个参数都表示列选择，不写和写一个冒号都表示所有列，参数之间逗号隔开"><a href="#loc和iloc，第二个参数都表示列选择，不写和写一个冒号都表示所有列，参数之间逗号隔开" class="headerlink" title="loc和iloc，第二个参数都表示列选择，不写和写一个冒号都表示所有列，参数之间逗号隔开"></a>loc和iloc，第二个参数都表示列选择，不写和写一个冒号都表示所有列，参数之间逗号隔开</h3><h3 id="行修改"><a href="#行修改" class="headerlink" title="行修改"></a>行修改</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;&quot;name&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;, &quot;ren&quot;, &quot;dao&quot;], &quot;age&quot;:[18, 20, 16, 34, 25]&#125;</span><br><span class="line">df=pd.DataFrame(data,index=[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;])</span><br><span class="line">df.loc[&apos;b&apos;]=&#123;&apos;shu&apos;,22&#125;</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">	name age</span><br><span class="line">a	sun	18</span><br><span class="line">b	shu	22</span><br><span class="line">c	hao	16</span><br><span class="line">d	ren	34</span><br><span class="line">e	dao	25</span><br></pre></td></tr></table></figure>
<h3 id="行添加append"><a href="#行添加append" class="headerlink" title="行添加append"></a>行添加append</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df2=pd.DataFrame([[&apos;lul&apos;,17],[&apos;yun&apos;,19]],index=[&apos;f&apos;,&apos;g&apos;],columns=[&apos;name&apos;,&apos;age&apos;])</span><br><span class="line">df=df.append(df2)</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">name	age</span><br><span class="line">a	sun	18</span><br><span class="line">b	lu	23</span><br><span class="line">c	hao	16</span><br><span class="line">d	ren	34</span><br><span class="line">e	dao	25</span><br><span class="line">f	lul	17</span><br><span class="line">g	yun	19</span><br></pre></td></tr></table></figure>
<h3 id="行删除"><a href="#行删除" class="headerlink" title="行删除"></a>行删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df3=df[:3]</span><br><span class="line">print(df3)</span><br><span class="line">  name  age</span><br><span class="line">a  sun   18</span><br><span class="line">b   lu   23</span><br><span class="line">c  hao   16</span><br><span class="line"></span><br><span class="line">df4=df3.drop(&apos;b&apos;) </span><br><span class="line">print(df4)</span><br><span class="line">  name  age</span><br><span class="line">a  sun   18</span><br><span class="line">c  hao   16</span><br></pre></td></tr></table></figure>
<h2 id="删除小数-8-0这种不算-，某一列含小数所有行"><a href="#删除小数-8-0这种不算-，某一列含小数所有行" class="headerlink" title="删除小数(8.0这种不算)，某一列含小数所有行"></a>删除小数(8.0这种不算)，某一列含小数所有行</h2><h3 id="number-1-0-这就是小数"><a href="#number-1-0-这就是小数" class="headerlink" title="number % 1 != 0 这就是小数"></a>number % 1 != 0 这就是小数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;&quot;name&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;zhan&quot;, &quot;ren&quot;, &quot;dao&quot;], &quot;age&quot;:[18.0, 20.3, 16, 34.5, 25]&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(d, index=[&quot;rank1&quot;, &quot;rank2&quot;, &quot;rank3&quot;, &quot;rank4&quot;, &quot;rank5&quot;])</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">df1=df.drop(df[df[&apos;age&apos;] % 1 != 0].index) </span><br><span class="line">df1</span><br></pre></td></tr></table></figure>
<h2 id="行列选择-第几行第几列"><a href="#行列选择-第几行第几列" class="headerlink" title="行列选择 第几行第几列"></a>行列选择 第几行第几列</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[2].get(&apos;name&apos;) </span><br><span class="line">df[&apos;name&apos;].iloc[3]</span><br><span class="line">df.name.loc[4]</span><br><span class="line">df.iloc[2][[&apos;name&apos;,&apos;age&apos;]]</span><br><span class="line"></span><br><span class="line">df[:3] #到索引为3之前的行</span><br><span class="line">df.iloc[[1,3]] #索引第一行和第三行</span><br><span class="line"></span><br><span class="line">df.iloc[2:3,1:2] #第行索引为2，列索引为1</span><br></pre></td></tr></table></figure>
<h2 id="查看头尾"><a href="#查看头尾" class="headerlink" title="查看头尾"></a>查看头尾</h2><ul>
<li>快速浏览数据结构，可以传数字参数，表示获取几条数据</li>
<li>df.head()</li>
<li>df.tail()</li>
</ul>
<h2 id="显示Dateframe所有行-列"><a href="#显示Dateframe所有行-列" class="headerlink" title="显示Dateframe所有行/列"></a>显示Dateframe所有行/列</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#显示Dateframe所有列(参数设置为None代表显示所有行，也可以自行设置数字)</span><br><span class="line">pd.set_option(&apos;display.max_columns&apos;,None)</span><br><span class="line">#显示Dateframe所有行</span><br><span class="line">pd.set_option(&apos;display.max_rows&apos;,None)</span><br><span class="line">#设置Dataframe数据的显示长度，默认为50</span><br><span class="line">pd.set_option(&apos;max_colwidth&apos;,20)</span><br></pre></td></tr></table></figure>
<h2 id="重建索引reindex"><a href="#重建索引reindex" class="headerlink" title="重建索引reindex"></a>重建索引reindex</h2><ul>
<li>其作用是创建一个适应新索引的新对象</li>
<li>参数index行索引</li>
<li>参数columns列索引</li>
<li>index和columns必须是原索引的子集</li>
<li>copy=true</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">df=pd.DataFrame([[&apos;lul&apos;,17],[&apos;yun&apos;,19]],columns=[&apos;name&apos;,&apos;age&apos;])</span><br><span class="line">print(df)</span><br><span class="line">df2=df.reindex(index=[1],columns=[&apos;name&apos;,&apos;age&apos;])</span><br><span class="line">print(&apos;df2:&apos;)</span><br><span class="line">print(df2)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">0  lul   17</span><br><span class="line">1  yun   19</span><br><span class="line"></span><br><span class="line">df2:</span><br><span class="line">  name  age</span><br><span class="line">1  yun   19</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">0  lul   17</span><br><span class="line">1  yun   19</span><br></pre></td></tr></table></figure>
<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><h3 id="按行索引排序"><a href="#按行索引排序" class="headerlink" title="按行索引排序"></a>按行索引排序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;&quot;name&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;, &quot;ren&quot;, &quot;dao&quot;], &quot;age&quot;:[18, 20, 16, 34, 25]&#125;</span><br><span class="line">df=pd.DataFrame(data,index=[3,2,4,0,1])</span><br><span class="line">print(df)</span><br><span class="line">df2=df.sort_index()</span><br></pre></td></tr></table></figure>
<h3 id="升降序可选ascending参数"><a href="#升降序可选ascending参数" class="headerlink" title="升降序可选ascending参数"></a>升降序可选ascending参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df3=df.sort_index(ascending=False) #降序</span><br><span class="line">print(df3)</span><br></pre></td></tr></table></figure>
<h3 id="对列索引的名称排序"><a href="#对列索引的名称排序" class="headerlink" title="对列索引的名称排序"></a>对列索引的名称排序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;&quot;col2&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;], &quot;col3&quot;:[18, 20, 16],&quot;col1&quot;:[&apos;sd&apos;,&apos;dd&apos;,8]&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">df2=df.sort_index(axis=1) </span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line">  col2  col3 col1</span><br><span class="line">0  sun    18   sd</span><br><span class="line">1  liu    20   dd</span><br><span class="line">2  hao    16    8</span><br><span class="line"></span><br><span class="line">  col1 col2  col3</span><br><span class="line">0   sd  sun    18</span><br><span class="line">1   dd  liu    20</span><br><span class="line">2    8  hao    16</span><br></pre></td></tr></table></figure>
<h3 id="按某列的值排序"><a href="#按某列的值排序" class="headerlink" title="按某列的值排序"></a>按某列的值排序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;&quot;col2&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;], &quot;col3&quot;:[18, 20, 16],&quot;col1&quot;:[&apos;sd&apos;,&apos;dd&apos;,8]&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">df2=df.sort_values(by=&apos;col3&apos;) #对col3列的值排序</span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line">  col2  col3 col1</span><br><span class="line">0  sun    18   sd</span><br><span class="line">1  liu    20   dd</span><br><span class="line">2  hao    16    8</span><br><span class="line"></span><br><span class="line">  col2  col3 col1</span><br><span class="line">2  hao    16    8</span><br><span class="line">0  sun    18   sd</span><br><span class="line">1  liu    20   dd</span><br></pre></td></tr></table></figure>
<h2 id="层次化索引"><a href="#层次化索引" class="headerlink" title="层次化索引"></a>层次化索引</h2><h2 id="层次化行索引"><a href="#层次化行索引" class="headerlink" title="层次化行索引"></a>层次化行索引</h2><h2 id="层次化列索引"><a href="#层次化列索引" class="headerlink" title="层次化列索引"></a>层次化列索引</h2><h2 id="行列同时层次化索引"><a href="#行列同时层次化索引" class="headerlink" title="行列同时层次化索引"></a>行列同时层次化索引</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mindex1 = pd.MultiIndex.from_product([list(&quot;ABC&quot;),[&apos;期中&apos;,&apos;期末&apos;]])</span><br><span class="line">mindex2=pd.MultiIndex.from_product([[&apos;Python&apos;,&apos;Java&apos;, &apos;C++&apos;],[&apos;去年&apos;,&apos;今年&apos;]])</span><br><span class="line">socre = np.random.randint(0,150,(6,6))</span><br><span class="line">df = pd.DataFrame(data = socre,index = mindex1,columns = mindex2)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/60c5a39f844ef46bb238dceb.jpg" alt></p>
<h2 id="层次化索引选择"><a href="#层次化索引选择" class="headerlink" title="层次化索引选择"></a>层次化索引选择</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[[&apos;Java&apos;,&apos;C++&apos;]]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&apos;Java&apos;][&apos;今年&apos;]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[&apos;A&apos;]</span><br></pre></td></tr></table></figure>
<h2 id="层次化行索引行列转置"><a href="#层次化行索引行列转置" class="headerlink" title="层次化行索引行列转置"></a>层次化行索引行列转置</h2><ul>
<li>stack()将列索引变为行索引</li>
<li>unstack()将行索引变为列索引</li>
<li>level参数：level=0对一级索引操作，=1对二级索引操作</li>
</ul>
<h3 id="一级列索引变为最小级行索引"><a href="#一级列索引变为最小级行索引" class="headerlink" title="一级列索引变为最小级行索引"></a>一级列索引变为最小级行索引</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.stack(level=0)</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/60c5a4f2844ef46bb251d529.jpg" alt></p>
<h3 id="二级列索引变为最小级行索引"><a href="#二级列索引变为最小级行索引" class="headerlink" title="二级列索引变为最小级行索引"></a>二级列索引变为最小级行索引</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.stack(level=1)</span><br></pre></td></tr></table></figure>
<h3 id="一级行索引变为最小级列索引"><a href="#一级行索引变为最小级列索引" class="headerlink" title="一级行索引变为最小级列索引"></a>一级行索引变为最小级列索引</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.unstack(level=0)</span><br></pre></td></tr></table></figure>
<h3 id="二级行索引变为最小级列索引"><a href="#二级行索引变为最小级列索引" class="headerlink" title="二级行索引变为最小级列索引"></a>二级行索引变为最小级列索引</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.unstack(level=1)</span><br></pre></td></tr></table></figure>
<h2 id="日期与时间"><a href="#日期与时间" class="headerlink" title="日期与时间"></a>日期与时间</h2><ul>
<li>pandas模块下的datetime模块在将来的版本中会被弃用</li>
<li>建议直接引入datetime模块使用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">from datetime import datetime</span><br></pre></td></tr></table></figure>
<h3 id="获取日期、时间和时间戳"><a href="#获取日期、时间和时间戳" class="headerlink" title="获取日期、时间和时间戳"></a>获取日期、时间和时间戳</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(datetime.now())</span><br><span class="line">print(datetime.now().date())</span><br><span class="line">print(datetime.now().time())</span><br><span class="line">print(datetime.now().timestamp())</span><br><span class="line"></span><br><span class="line">2021-04-12 14:11:17.790021</span><br><span class="line">2021-04-12</span><br><span class="line">14:11:17.791025</span><br><span class="line">1618207877.791025</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">print(datetime.today())</span><br><span class="line">print(datetime.today().date())</span><br><span class="line">print(datetime.today().time())</span><br><span class="line">print(datetime.today().timestamp())</span><br><span class="line"></span><br><span class="line">2021-04-12 14:35:16.016302</span><br><span class="line">2021-04-12</span><br><span class="line">14:35:16.016302</span><br><span class="line">1618209316.016302</span><br><span class="line"></span><br><span class="line">pd.datetime.now()</span><br><span class="line">2021-04-12 14:35:16.017273</span><br></pre></td></tr></table></figure>
<h3 id="字符串转日期时间pd-to-datetime"><a href="#字符串转日期时间pd-to-datetime" class="headerlink" title="字符串转日期时间pd.to_datetime"></a>字符串转日期时间pd.to_datetime</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">d=&apos;2021-5-1&apos;</span><br><span class="line">d1=[&apos;2021-1-1&apos;,&apos;2021-2-8&apos;,&apos;2021-3-2&apos;]</span><br><span class="line">d2=[&apos;2021-1-1&apos;,&apos;shulu&apos;,&apos;2021-3-2&apos;]</span><br><span class="line">print(pd.to_datetime(d))</span><br><span class="line">print(pd.to_datetime(d1))</span><br><span class="line">print(pd.to_datetime(d2,errors=&apos;ignore&apos;))</span><br><span class="line">print(pd.to_datetime(d2,errors=&apos;coerce&apos;))</span><br><span class="line"></span><br><span class="line">print(pd.Timestamp(d))</span><br><span class="line"></span><br><span class="line">2021-05-01 00:00:00</span><br><span class="line">DatetimeIndex([&apos;2021-01-01&apos;, &apos;2021-02-08&apos;, &apos;2021-03-02&apos;], dtype=&apos;datetime64[ns]&apos;, freq=None)</span><br><span class="line">Index([&apos;2021-1-1&apos;, &apos;shulu&apos;, &apos;2021-3-2&apos;], dtype=&apos;object&apos;)</span><br><span class="line">DatetimeIndex([&apos;2021-01-01&apos;, &apos;NaT&apos;, &apos;2021-03-02&apos;], dtype=&apos;datetime64[ns]&apos;, freq=None)</span><br><span class="line">2021-05-01 00:00:00</span><br><span class="line">#NaT表示不是一个时间的值(相当于NaN)</span><br></pre></td></tr></table></figure>
<h3 id="时间差"><a href="#时间差" class="headerlink" title="时间差"></a>时间差</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">past=datetime(2017, 4, 16, 21, 21, 20, 871000)</span><br><span class="line">now=datetime.now()</span><br><span class="line">delta=now-past</span><br><span class="line">print(delta) </span><br><span class="line">print(delta.days)</span><br><span class="line"></span><br><span class="line">1456 days, 17:30:33.216922</span><br><span class="line">1456</span><br><span class="line"></span><br><span class="line">print(pd.Timedelta(now - past))</span><br><span class="line">1456 days 17:30:33.216922</span><br></pre></td></tr></table></figure>
<h3 id="时间戳索引DatetimeIndex的快速创建"><a href="#时间戳索引DatetimeIndex的快速创建" class="headerlink" title="时间戳索引DatetimeIndex的快速创建"></a>时间戳索引DatetimeIndex的快速创建</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(pd.date_range(start=&apos;2021-5-1&apos;,end=&apos;2021-5-3&apos;))</span><br><span class="line">print(pd.date_range(start=&apos;2021-6-15&apos;,end=&apos;2021-8-6&apos;,freq=&apos;M&apos;))</span><br><span class="line">print(pd.date_range(start=&apos;2021-5-1&apos;,periods=3))</span><br><span class="line">print(pd.date_range(end=&apos;2021-5-1&apos;,periods=3))</span><br><span class="line"></span><br><span class="line">DatetimeIndex([&apos;2021-05-01&apos;, &apos;2021-05-02&apos;, &apos;2021-05-03&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)</span><br><span class="line">DatetimeIndex([&apos;2021-06-30&apos;, &apos;2021-07-31&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;M&apos;)</span><br><span class="line">DatetimeIndex([&apos;2021-05-01&apos;, &apos;2021-05-02&apos;, &apos;2021-05-03&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)</span><br><span class="line">DatetimeIndex([&apos;2021-04-29&apos;, &apos;2021-04-30&apos;, &apos;2021-05-01&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)</span><br></pre></td></tr></table></figure>
<h2 id="重采样pd-date-range"><a href="#重采样pd-date-range" class="headerlink" title="重采样pd.date_range"></a>重采样pd.date_range</h2><ul>
<li>重新采样，是对原样本重新处理的一个方法，是一个对常规时间序列数据重新采样和频率转换的便捷的方法。</li>
<li>降采样：高频数据到低频数据</li>
<li>升采样：低频数据到高频数据</li>
</ul>
<h3 id="降采样"><a href="#降采样" class="headerlink" title="降采样"></a>降采样</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index = pd.date_range(&apos;1/1/2021&apos;, periods=9, freq=&apos;D&apos;)</span><br><span class="line">series = pd.Series(range(9), index=index)</span><br><span class="line">print(series)</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/60c5a634844ef46bb26964a1.jpg" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#默认：closed=left, label=left</span><br><span class="line">print(series.resample(&apos;3D&apos;)) #DatetimeIndexResampler 得到这个重采样构建器</span><br><span class="line">DatetimeIndexResampler [freq=&lt;3 * Days&gt;, axis=0, closed=left, label=left, convention=start, origin=start_day]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(series.resample(&apos;3D&apos;).sum()) #通过聚合方法可以展现出来</span><br><span class="line">2021-01-01     3</span><br><span class="line">2021-01-04    12</span><br><span class="line">2021-01-07    21</span><br><span class="line">Freq: 3D, dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(series.resample(&apos;3D&apos;,label=&apos;right&apos;).sum())</span><br><span class="line">2021-01-04     3</span><br><span class="line">2021-01-07    12</span><br><span class="line">2021-01-10    21</span><br><span class="line">Freq: 3D, dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print(series.resample(&apos;3D&apos;,closed=&apos;right&apos;).sum())</span><br><span class="line">2020-12-29     0</span><br><span class="line">2021-01-01     6</span><br><span class="line">2021-01-04    15</span><br><span class="line">2021-01-07    15</span><br><span class="line">Freq: 3D, dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print(series.resample(&apos;3D&apos;,label=&apos;right&apos;,closed=&apos;right&apos;).sum())</span><br><span class="line">2021-01-01     0</span><br><span class="line">2021-01-04     6</span><br><span class="line">2021-01-07    15</span><br><span class="line">2021-01-10    15</span><br><span class="line">Freq: 3D, dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="增采样"><a href="#增采样" class="headerlink" title="增采样"></a>增采样</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index = pd.date_range(&apos;1/1/2000&apos;, periods=9, freq=&apos;T&apos;)</span><br><span class="line">series = pd.Series(range(9), index=index)</span><br><span class="line">series</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/60c5a6c4844ef46bb273d040.jpg" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">series.resample(&apos;30S&apos;)</span><br><span class="line">&lt;pandas.core.resample.DatetimeIndexResampler object at 0x000002B91F375CA0&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">series.resample(&apos;30S&apos;).asfreq().head() #新索引没有值，为nan</span><br><span class="line"></span><br><span class="line">2000-01-01 00:00:00    0.0</span><br><span class="line">2000-01-01 00:00:30    NaN</span><br><span class="line">2000-01-01 00:01:00    1.0</span><br><span class="line">2000-01-01 00:01:30    NaN</span><br><span class="line">2000-01-01 00:02:00    2.0</span><br><span class="line">Freq: 30S, dtype: float64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">series.resample(&apos;30S&apos;).asfreq().bfill().head(8) #用后面的一个数据填充nan</span><br><span class="line">2000-01-01 00:00:00    0.0</span><br><span class="line">2000-01-01 00:00:30    1.0</span><br><span class="line">2000-01-01 00:01:00    1.0</span><br><span class="line">2000-01-01 00:01:30    2.0</span><br><span class="line">2000-01-01 00:02:00    2.0</span><br><span class="line">2000-01-01 00:02:30    3.0</span><br><span class="line">2000-01-01 00:03:00    3.0</span><br><span class="line">2000-01-01 00:03:30    4.0</span><br><span class="line">Freq: 30S, dtype: float64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">series.resample(&apos;30S&apos;).asfreq().ffill().head(6) #用前面的一个数据填充nan</span><br><span class="line">2000-01-01 00:00:00    0.0</span><br><span class="line">2000-01-01 00:00:30    0.0</span><br><span class="line">2000-01-01 00:01:00    1.0</span><br><span class="line">2000-01-01 00:01:30    1.0</span><br><span class="line">2000-01-01 00:02:00    2.0</span><br><span class="line">2000-01-01 00:02:30    2.0</span><br><span class="line">Freq: 30S, dtype: float64</span><br></pre></td></tr></table></figure>
<h2 id="描述性统计信息函数"><a href="#描述性统计信息函数" class="headerlink" title="描述性统计信息函数"></a>描述性统计信息函数</h2><h3 id="非空观测数量"><a href="#非空观测数量" class="headerlink" title="非空观测数量"></a>非空观测数量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;count():非空观测数量&quot;)</span><br><span class="line">print(df.count())</span><br></pre></td></tr></table></figure>
<h3 id="累计总和"><a href="#累计总和" class="headerlink" title="累计总和"></a>累计总和</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;cumsum()累计总和&apos;)</span><br><span class="line">print(df.cumsum())</span><br></pre></td></tr></table></figure>
<h3 id="累计乘积"><a href="#累计乘积" class="headerlink" title="累计乘积"></a>累计乘积</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;cumprod()累计乘积&apos;)</span><br><span class="line">print(df[[&apos;Age&apos;,&apos;Rating&apos;]].cumprod())</span><br></pre></td></tr></table></figure>
<h3 id="唯一值-去重"><a href="#唯一值-去重" class="headerlink" title="唯一值 去重"></a>唯一值 去重</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">s=pd.Series(list(&apos;asaddvfshu&apos;))</span><br><span class="line">print(s.value_counts()) #重复值计数</span><br><span class="line">sq=s.unique() #去重</span><br><span class="line">print(s) </span><br><span class="line">print(sq) #[&apos;a&apos; &apos;s&apos; &apos;d&apos; &apos;v&apos; &apos;f&apos; &apos;h&apos; &apos;u&apos;]</span><br><span class="line">print(pd.Series(sq)) #包装成Series</span><br></pre></td></tr></table></figure>
<h3 id="成员资格"><a href="#成员资格" class="headerlink" title="成员资格"></a>成员资格</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s=pd.Series(list([123]))</span><br><span class="line">s.isin([123,22])</span><br><span class="line"></span><br><span class="line">0    True</span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure>
<h2 id="pandas的字符串操作"><a href="#pandas的字符串操作" class="headerlink" title="pandas的字符串操作"></a>pandas的字符串操作</h2><ul>
<li>某一列.str.contains(字符) 筛选出含有特定字符串的行</li>
<li>某一列.str.split(分割字符) 分割字符串(加参数expand=True分割后变两列)</li>
<li>某一列.str.replace(old,new)字符串的替换</li>
<li>某一列.str.startswith() 与 endswith()字符串两端的字符的判断 </li>
<li>某一列.str.findall()正则表达式 以数组形式返回 </li>
<li>某一列.str.cat()拼接字符串</li>
<li>某一列.str.extract() 抽取匹配的字符串出来，注意要加上括号，如extract(“([d-z])”)</li>
<li>某一列.str.match() 检测是否全部匹配给定点的字符串或者表达式</li>
<li>某一列.str.strip()去除特定字符(包括lstrip和rstrip)</li>
<li>某一列.str.get() 获取指定位置的字符串</li>
<li>某一列.str.pad() 左右补齐</li>
<li>某一列.str.len()len() 计算字符串的长度</li>
<li>某一列.str.center() 中间补齐</li>
<li>某一列.str.ljust() 右边补齐 rjust() 左边补齐</li>
<li>某一列.str.zfill() 左边补0</li>
<li>某一列.str.lower() 全部小写 upper() 全部大写</li>
<li>某一列.str.repeat() 重复</li>
<li>某一列.str.wrap() 在指定的位置加回车符号</li>
<li>某一列.str.slice() 按给点的开始结束位置切割字符串</li>
<li>某一列.str.slice_replace() 使用给定的字符串，替换指定的位置的字符</li>
<li>某一列.str.count() 计算给定单词出现的次数</li>
<li>某一列.str.strip() 去除前后的空白字符</li>
<li>某一列.str.strip() lstrip() rstrip() 去除前后的空白字符</li>
<li>某一列.str.find() 从左边开始，查找给定字符串的所在位置 rfind() 从右边开始</li>
<li>某一列.str.index() 查找给定字符串的位置，注意，如果不存在这个字符串，那么会报错</li>
<li>某一列.str.capitalize() 首字符大写</li>
<li>某一列.str.swapcase() 大小写互换</li>
<li>某一列.str.isalnum() 是否全部是数字和字母组成</li>
<li>某一列.str.isdecimal() 是否全是数字</li>
<li>某一列.str.isdigit() 是否全部都是数字</li>
<li>某一列.str.istitle() 是否只有首字母为大写，其他字母为小写</li>
<li>某一列.str.isspace() 是否空格</li>
<li>某一列.str.islower() 是否全部小写</li>
<li>某一列.str.isalpha() 是否全部是字母</li>
</ul>
<h2 id="列的合并merge-以某个键为参考，默认how-’inner’使用键的交集"><a href="#列的合并merge-以某个键为参考，默认how-’inner’使用键的交集" class="headerlink" title="列的合并merge,以某个键为参考，默认how=’inner’使用键的交集"></a>列的合并merge,以某个键为参考，默认how=’inner’使用键的交集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">left = pd.DataFrame(&#123;</span><br><span class="line">         &apos;id&apos;:[1,2,3,4,5],</span><br><span class="line">         &apos;Name&apos;: [&apos;Alex&apos;, &apos;Amy&apos;, &apos;Allen&apos;, &apos;Alice&apos;, &apos;Ayoung&apos;],</span><br><span class="line">         &apos;subject_id&apos;:[&apos;sub1&apos;,&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">right = pd.DataFrame(</span><br><span class="line">         &#123;&apos;id&apos;:[1,2,3,4,5],</span><br><span class="line">         &apos;Name&apos;: [&apos;Billy&apos;, &apos;Brian&apos;, &apos;Bran&apos;, &apos;Bryce&apos;, &apos;Betty&apos;],</span><br><span class="line">         &apos;subject_id&apos;:[&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub3&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">print (left)</span><br><span class="line"></span><br><span class="line">print (right)</span><br></pre></td></tr></table></figure>
<h3 id="在一个键上合并两个数据帧"><a href="#在一个键上合并两个数据帧" class="headerlink" title="在一个键上合并两个数据帧"></a>在一个键上合并两个数据帧</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mdf=pd.merge(left,right,on=&apos;id&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">   id  Name_x subject_id_x Name_y subject_id_y</span><br><span class="line">0   1    Alex         sub1  Billy         sub2</span><br><span class="line">1   2     Amy         sub2  Brian         sub4</span><br><span class="line">2   3   Allen         sub4   Bran         sub3</span><br><span class="line">3   4   Alice         sub6  Bryce         sub6</span><br><span class="line">4   5  Ayoung         sub5  Betty         sub5</span><br></pre></td></tr></table></figure>
<h3 id="合并多个键上的两个数据帧"><a href="#合并多个键上的两个数据帧" class="headerlink" title="合并多个键上的两个数据帧"></a>合并多个键上的两个数据帧</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mdf=pd.merge(left,right,on=[&apos;id&apos;,&apos;subject_id&apos;])</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">   id  Name_x subject_id Name_y</span><br><span class="line">0   4   Alice       sub6  Bryce</span><br><span class="line">1   5  Ayoung       sub5  Betty</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># 使用“how”的参数</span><br><span class="line"># left使用左侧对象的键</span><br><span class="line"># right使用右侧对象的键</span><br><span class="line"># outer使用键的并集</span><br><span class="line"># inner使用键的交集 默认inner</span><br><span class="line">mdf=pd.merge(left,right,on=&apos;subject_id&apos;,how=&apos;left&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">mdf=pd.merge(left,right,on=&apos;subject_id&apos;,how=&apos;right&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">mdf=pd.merge(left,right,on=&apos;subject_id&apos;,how=&apos;inner&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">mdf=pd.merge(left,right,on=&apos;subject_id&apos;,how=&apos;outer&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">   id_x  Name_x subject_id  id_y Name_y</span><br><span class="line">0     1    Alex       sub1   NaN    NaN</span><br><span class="line">1     2     Amy       sub2   1.0  Billy</span><br><span class="line">2     3   Allen       sub4   2.0  Brian</span><br><span class="line">3     4   Alice       sub6   4.0  Bryce</span><br><span class="line">4     5  Ayoung       sub5   5.0  Betty</span><br><span class="line">========================================</span><br><span class="line">   id_x  Name_x subject_id  id_y Name_y</span><br><span class="line">0   2.0     Amy       sub2     1  Billy</span><br><span class="line">1   3.0   Allen       sub4     2  Brian</span><br><span class="line">2   NaN     NaN       sub3     3   Bran</span><br><span class="line">3   4.0   Alice       sub6     4  Bryce</span><br><span class="line">4   5.0  Ayoung       sub5     5  Betty</span><br><span class="line">========================================</span><br><span class="line">   id_x  Name_x subject_id  id_y Name_y</span><br><span class="line">0     2     Amy       sub2     1  Billy</span><br><span class="line">1     3   Allen       sub4     2  Brian</span><br><span class="line">2     4   Alice       sub6     4  Bryce</span><br><span class="line">3     5  Ayoung       sub5     5  Betty</span><br><span class="line">========================================</span><br><span class="line">   id_x  Name_x subject_id  id_y Name_y</span><br><span class="line">0   1.0    Alex       sub1   NaN    NaN</span><br><span class="line">1   2.0     Amy       sub2   1.0  Billy</span><br><span class="line">2   3.0   Allen       sub4   2.0  Brian</span><br><span class="line">3   4.0   Alice       sub6   4.0  Bryce</span><br><span class="line">4   5.0  Ayoung       sub5   5.0  Betty</span><br><span class="line">5   NaN     NaN       sub3   3.0   Bran</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">left = pd.DataFrame(&#123;</span><br><span class="line">         &apos;id&apos;:[1,2,3,4,5],</span><br><span class="line">         &apos;Name&apos;: [&apos;Alex&apos;, &apos;Amy&apos;, &apos;Allen&apos;, &apos;Alice&apos;, &apos;Ayoung&apos;],</span><br><span class="line">         &apos;sub_l&apos;:[&apos;sub1&apos;,&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">right = pd.DataFrame(</span><br><span class="line">         &#123;&apos;id&apos;:[1,2,3,4,5],</span><br><span class="line">         &apos;Name&apos;: [&apos;Billy&apos;, &apos;Brian&apos;, &apos;Bran&apos;, &apos;Bryce&apos;, &apos;Betty&apos;],</span><br><span class="line">         &apos;sub_r&apos;:[&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub3&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">print (left)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">print (right)</span><br><span class="line"></span><br><span class="line">   id    Name sub_l</span><br><span class="line">0   1    Alex  sub1</span><br><span class="line">1   2     Amy  sub2</span><br><span class="line">2   3   Allen  sub4</span><br><span class="line">3   4   Alice  sub6</span><br><span class="line">4   5  Ayoung  sub5</span><br><span class="line">========================================</span><br><span class="line">   id   Name sub_r</span><br><span class="line">0   1  Billy  sub2</span><br><span class="line">1   2  Brian  sub4</span><br><span class="line">2   3   Bran  sub3</span><br><span class="line">3   4  Bryce  sub6</span><br><span class="line">4   5  Betty  sub5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mdf=pd.merge(left,right,left_on=&apos;sub_l&apos;,right_on=&apos;sub_r&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">   id_x  Name_x sub_l  id_y Name_y sub_r</span><br><span class="line">0     2     Amy  sub2     1  Billy  sub2</span><br><span class="line">1     3   Allen  sub4     2  Brian  sub4</span><br><span class="line">2     4   Alice  sub6     4  Bryce  sub6</span><br><span class="line">3     5  Ayoung  sub5     5  Betty  sub5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">left = pd.DataFrame(&#123;</span><br><span class="line">         &apos;id&apos;:[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;],</span><br><span class="line">         &apos;Name&apos;: [&apos;Alex&apos;, &apos;Amy&apos;, &apos;Allen&apos;, &apos;Alice&apos;, &apos;Ayoung&apos;],</span><br><span class="line">         &apos;sub_l&apos;:[&apos;sub1&apos;,&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">right = pd.DataFrame(</span><br><span class="line">         &#123;&apos;Name&apos;: [&apos;Billy&apos;, &apos;Brian&apos;, &apos;Bran&apos;, &apos;Bryce&apos;, &apos;Betty&apos;],</span><br><span class="line">         &apos;sub_r&apos;:[&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub3&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;,index=[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;])</span><br><span class="line">print (left)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">print (right)</span><br><span class="line"></span><br><span class="line">  id    Name sub_l</span><br><span class="line">0  a    Alex  sub1</span><br><span class="line">1  b     Amy  sub2</span><br><span class="line">2  c   Allen  sub4</span><br><span class="line">3  d   Alice  sub6</span><br><span class="line">4  e  Ayoung  sub5</span><br><span class="line">========================================</span><br><span class="line">    Name sub_r</span><br><span class="line">a  Billy  sub2</span><br><span class="line">b  Brian  sub4</span><br><span class="line">c   Bran  sub3</span><br><span class="line">d  Bryce  sub6</span><br><span class="line">e  Betty  sub5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mdf=pd.merge(left,right,left_on=&apos;id&apos;,right_index=True)</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">  id  Name_x sub_l Name_y sub_r</span><br><span class="line">0  a    Alex  sub1  Billy  sub2</span><br><span class="line">1  b     Amy  sub2  Brian  sub4</span><br><span class="line">2  c   Allen  sub4   Bran  sub3</span><br><span class="line">3  d   Alice  sub6  Bryce  sub6</span><br><span class="line">4  e  Ayoung  sub5  Betty  sub5</span><br></pre></td></tr></table></figure>
<h2 id="数据帧的堆叠concat，默认join-’outer’取并集，axis-0竖向堆叠"><a href="#数据帧的堆叠concat，默认join-’outer’取并集，axis-0竖向堆叠" class="headerlink" title="数据帧的堆叠concat，默认join=’outer’取并集，axis=0竖向堆叠"></a>数据帧的堆叠concat，默认join=’outer’取并集，axis=0竖向堆叠</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;, &apos;A3&apos;],</span><br><span class="line">                    &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;, &apos;B3&apos;],</span><br><span class="line">                    &apos;C&apos;: [&apos;C0&apos;, &apos;C1&apos;, &apos;C2&apos;, &apos;C3&apos;],</span><br><span class="line">                    &apos;D&apos;: [&apos;D0&apos;, &apos;D1&apos;, &apos;D2&apos;, &apos;D3&apos;]&#125;,</span><br><span class="line">                   index=[0, 1, 2, 3])</span><br><span class="line">df2 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A4&apos;, &apos;A5&apos;, &apos;A6&apos;, &apos;A7&apos;],</span><br><span class="line">                    &apos;B&apos;: [&apos;B4&apos;, &apos;B5&apos;, &apos;B6&apos;, &apos;B7&apos;],</span><br><span class="line">                    &apos;C&apos;: [&apos;C4&apos;, &apos;C5&apos;, &apos;C6&apos;, &apos;C7&apos;],</span><br><span class="line">                    &apos;D&apos;: [&apos;D4&apos;, &apos;D5&apos;, &apos;D6&apos;, &apos;D7&apos;]&#125;,</span><br><span class="line">                   index=[4, 5, 6, 7])</span><br><span class="line">df3 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A8&apos;, &apos;A9&apos;, &apos;A10&apos;, &apos;A11&apos;],</span><br><span class="line">                    &apos;B&apos;: [&apos;B8&apos;, &apos;B9&apos;, &apos;B10&apos;, &apos;B11&apos;],</span><br><span class="line">                    &apos;C&apos;: [&apos;C8&apos;, &apos;C9&apos;, &apos;C10&apos;, &apos;C11&apos;],</span><br><span class="line">                    &apos;D&apos;: [&apos;D8&apos;, &apos;D9&apos;, &apos;D10&apos;, &apos;D11&apos;]&#125;,</span><br><span class="line">                   index=[8, 9, 10, 11])</span><br><span class="line"></span><br><span class="line">print(&quot;df1:&quot;)</span><br><span class="line">print(df1)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">print(&quot;df2:&quot;)</span><br><span class="line">print(df2)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">print(&quot;df3:&quot;)</span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line">df1:</span><br><span class="line">    A   B   C   D</span><br><span class="line">0  A0  B0  C0  D0</span><br><span class="line">1  A1  B1  C1  D1</span><br><span class="line">2  A2  B2  C2  D2</span><br><span class="line">3  A3  B3  C3  D3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df2:</span><br><span class="line">    A   B   C   D</span><br><span class="line">4  A4  B4  C4  D4</span><br><span class="line">5  A5  B5  C5  D5</span><br><span class="line">6  A6  B6  C6  D6</span><br><span class="line">7  A7  B7  C7  D7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df3:</span><br><span class="line">      A    B    C    D</span><br><span class="line">8    A8   B8   C8   D8</span><br><span class="line">9    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#默认join=&apos;outer&apos;取并集，默认axis=0竖向堆叠</span><br><span class="line">cdf=pd.concat([df1,df2,df3]) </span><br><span class="line">print(cdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line"># 使用传递的键作为最外层构建层次索引。</span><br><span class="line">cdf=pd.concat([df1,df2,df3],keys=[&apos;x&apos;,&apos;y&apos;,&apos;z&apos;])</span><br><span class="line">print(cdf)</span><br><span class="line"></span><br><span class="line">      A    B    C    D</span><br><span class="line">0    A0   B0   C0   D0</span><br><span class="line">1    A1   B1   C1   D1</span><br><span class="line">2    A2   B2   C2   D2</span><br><span class="line">3    A3   B3   C3   D3</span><br><span class="line">4    A4   B4   C4   D4</span><br><span class="line">5    A5   B5   C5   D5</span><br><span class="line">6    A6   B6   C6   D6</span><br><span class="line">7    A7   B7   C7   D7</span><br><span class="line">8    A8   B8   C8   D8</span><br><span class="line">9    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br><span class="line">========================================</span><br><span class="line">        A    B    C    D</span><br><span class="line">x 0    A0   B0   C0   D0</span><br><span class="line">  1    A1   B1   C1   D1</span><br><span class="line">  2    A2   B2   C2   D2</span><br><span class="line">  3    A3   B3   C3   D3</span><br><span class="line">y 4    A4   B4   C4   D4</span><br><span class="line">  5    A5   B5   C5   D5</span><br><span class="line">  6    A6   B6   C6   D6</span><br><span class="line">  7    A7   B7   C7   D7</span><br><span class="line">z 8    A8   B8   C8   D8</span><br><span class="line">  9    A9   B9   C9   D9</span><br><span class="line">  10  A10  B10  C10  D10</span><br><span class="line">  11  A11  B11  C11  D11</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#修改df3的index索引，方便对比</span><br><span class="line">df3 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A8&apos;, &apos;A9&apos;, &apos;A10&apos;, &apos;A11&apos;],</span><br><span class="line">                    &apos;B&apos;: [&apos;B8&apos;, &apos;B9&apos;, &apos;B10&apos;, &apos;B11&apos;],</span><br><span class="line">                    &apos;C&apos;: [&apos;C8&apos;, &apos;C9&apos;, &apos;C10&apos;, &apos;C11&apos;],</span><br><span class="line">                    &apos;D&apos;: [&apos;D8&apos;, &apos;D9&apos;, &apos;D10&apos;, &apos;D11&apos;]&#125;,</span><br><span class="line">                   index=[6, 7, 10, 11])</span><br><span class="line">print(df3)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line"></span><br><span class="line">cdf=pd.concat([df1,df2,df3])</span><br><span class="line">print(cdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line"># 如果想要生成的对象遵循新的索引，请将ignore_index设置为True</span><br><span class="line">cdf=pd.concat([df1,df2,df3],ignore_index=True)</span><br><span class="line">print(cdf)</span><br><span class="line"></span><br><span class="line">      A    B    C    D</span><br><span class="line">6    A8   B8   C8   D8</span><br><span class="line">7    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br><span class="line">========================================</span><br><span class="line">      A    B    C    D</span><br><span class="line">0    A0   B0   C0   D0</span><br><span class="line">1    A1   B1   C1   D1</span><br><span class="line">2    A2   B2   C2   D2</span><br><span class="line">3    A3   B3   C3   D3</span><br><span class="line">4    A4   B4   C4   D4</span><br><span class="line">5    A5   B5   C5   D5</span><br><span class="line">6    A6   B6   C6   D6</span><br><span class="line">7    A7   B7   C7   D7</span><br><span class="line">6    A8   B8   C8   D8</span><br><span class="line">7    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br><span class="line">========================================</span><br><span class="line">      A    B    C    D</span><br><span class="line">0    A0   B0   C0   D0</span><br><span class="line">1    A1   B1   C1   D1</span><br><span class="line">2    A2   B2   C2   D2</span><br><span class="line">3    A3   B3   C3   D3</span><br><span class="line">4    A4   B4   C4   D4</span><br><span class="line">5    A5   B5   C5   D5</span><br><span class="line">6    A6   B6   C6   D6</span><br><span class="line">7    A7   B7   C7   D7</span><br><span class="line">8    A8   B8   C8   D8</span><br><span class="line">9    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">cdf=pd.concat([df1,df2],axis=1) #横向堆叠数据帧</span><br><span class="line">print(cdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">cdf=pd.concat([df2,df3],axis=1) #6,7两行索引一样</span><br><span class="line">print(cdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">cdf=pd.concat([df2,df3],axis=1,join=&apos;inner&apos;) #取交集</span><br><span class="line">print(cdf)</span><br><span class="line"></span><br><span class="line">     A    B    C    D    A    B    C    D</span><br><span class="line">0   A0   B0   C0   D0  NaN  NaN  NaN  NaN</span><br><span class="line">1   A1   B1   C1   D1  NaN  NaN  NaN  NaN</span><br><span class="line">2   A2   B2   C2   D2  NaN  NaN  NaN  NaN</span><br><span class="line">3   A3   B3   C3   D3  NaN  NaN  NaN  NaN</span><br><span class="line">4  NaN  NaN  NaN  NaN   A4   B4   C4   D4</span><br><span class="line">5  NaN  NaN  NaN  NaN   A5   B5   C5   D5</span><br><span class="line">6  NaN  NaN  NaN  NaN   A6   B6   C6   D6</span><br><span class="line">7  NaN  NaN  NaN  NaN   A7   B7   C7   D7</span><br><span class="line">========================================</span><br><span class="line">      A    B    C    D    A    B    C    D</span><br><span class="line">4    A4   B4   C4   D4  NaN  NaN  NaN  NaN</span><br><span class="line">5    A5   B5   C5   D5  NaN  NaN  NaN  NaN</span><br><span class="line">6    A6   B6   C6   D6   A8   B8   C8   D8</span><br><span class="line">7    A7   B7   C7   D7   A9   B9   C9   D9</span><br><span class="line">10  NaN  NaN  NaN  NaN  A10  B10  C10  D10</span><br><span class="line">11  NaN  NaN  NaN  NaN  A11  B11  C11  D11</span><br><span class="line">========================================</span><br><span class="line">    A   B   C   D   A   B   C   D</span><br><span class="line">6  A6  B6  C6  D6  A8  B8  C8  D8</span><br><span class="line">7  A7  B7  C7  D7  A9  B9  C9  D9</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cdf.index=[0,1]</span><br><span class="line">print(cdf)</span><br><span class="line"></span><br><span class="line">    A   B   C   D   A   B   C   D</span><br><span class="line">0  A6  B6  C6  D6  A8  B8  C8  D8</span><br><span class="line">1  A7  B7  C7  D7  A9  B9  C9  D9</span><br></pre></td></tr></table></figure>
<h2 id="去重duplicated-drop-duplicates"><a href="#去重duplicated-drop-duplicates" class="headerlink" title="去重duplicated(),drop_duplicates()"></a>去重duplicated(),drop_duplicates()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 去重</span><br><span class="line">data=&#123;</span><br><span class="line">    &apos;age&apos;:[1,2,1,2,3,2,1,4,5,3]</span><br><span class="line">&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line">print(df.duplicated()) #得到布尔型df</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line">#通过布尔型索引得到去重后的值</span><br><span class="line">print(df[df.duplicated()==False])</span><br></pre></td></tr></table></figure>
<h3 id="在原数据之上修改"><a href="#在原数据之上修改" class="headerlink" title="在原数据之上修改"></a>在原数据之上修改</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.drop_duplicates(inplace=True)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<h2 id="替换replace"><a href="#替换replace" class="headerlink" title="替换replace"></a>替换replace</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">data=&#123;</span><br><span class="line">    &apos;name&apos;:[&apos;shu&apos;,&apos;lu&apos;,&apos;yun&apos;,&apos;wu&apos;,&apos;jia&apos;,&apos;yi&apos;],</span><br><span class="line">    &apos;age&apos;:[1,2,1,4,5,3]</span><br><span class="line">&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line"></span><br><span class="line">print(df[&apos;age&apos;].replace(1,18)) #用18替换所有的1</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line"></span><br><span class="line">print(df[&apos;age&apos;].replace([2,4],20)) #用20替换所有的2，4</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line"></span><br><span class="line">df[&apos;name&apos;].replace(&#123; #多个值分别替换</span><br><span class="line">    &apos;lu&apos;:&apos;lulu&apos;,</span><br><span class="line">    &apos;yi&apos;:&apos;loveyi&apos;,</span><br><span class="line">    &apos;jia&apos;:&apos;jiaa&apos;</span><br><span class="line">&#125;,inplace=True) #inplace=True修改原始值</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">0  shu    1</span><br><span class="line">1   lu    2</span><br><span class="line">2  yun    1</span><br><span class="line">3   wu    4</span><br><span class="line">4  jia    5</span><br><span class="line">5   yi    3</span><br><span class="line"></span><br><span class="line">0    18</span><br><span class="line">1     2</span><br><span class="line">2    18</span><br><span class="line">3     4</span><br><span class="line">4     5</span><br><span class="line">5     3</span><br><span class="line">Name: age, dtype: int64</span><br><span class="line"></span><br><span class="line">0     1</span><br><span class="line">1    20</span><br><span class="line">2     1</span><br><span class="line">3    20</span><br><span class="line">4     5</span><br><span class="line">5     3</span><br><span class="line">Name: age, dtype: int64</span><br><span class="line"></span><br><span class="line">     name  age</span><br><span class="line">0     shu    1</span><br><span class="line">1    lulu    2</span><br><span class="line">2     yun    1</span><br><span class="line">3      wu    4</span><br><span class="line">4    jiaa    5</span><br><span class="line">5  loveyi    3</span><br></pre></td></tr></table></figure>
<h2 id="分组groupby，我们将数据分成多个集合，并在每个子集上应用一些函数"><a href="#分组groupby，我们将数据分成多个集合，并在每个子集上应用一些函数" class="headerlink" title="分组groupby，我们将数据分成多个集合，并在每个子集上应用一些函数"></a>分组groupby，我们将数据分成多个集合，并在每个子集上应用一些函数</h2><ul>
<li>分组后可以执行操作：</li>
<li>聚合：计算汇总统计，指对有关数据进行内容挑选、分析、归类，最后分析得到想要的结果</li>
<li>转换：执行一些特定于组的操作</li>
<li>过滤：在某些情况下丢弃数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">**数据拆分成组并查看**</span><br><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    &apos;Team&apos;: [&apos;Riders&apos;, &apos;Riders&apos;, &apos;Devils&apos;, &apos;Devils&apos;, &apos;Kings&apos;,</span><br><span class="line">    &apos;king&apos;, &apos;Kings&apos;, &apos;Kings&apos;, &apos;Riders&apos;, &apos;Royals&apos;, &apos;Royals&apos;, &apos;Riders&apos;],</span><br><span class="line">    &apos;Rank&apos;: [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2],</span><br><span class="line">    &apos;Year&apos;: [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017],</span><br><span class="line">    &apos;Points&apos;:[876,789,863,673,741,812,756,788,694,701,804,690]</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">gs = df.groupby(&quot;Team&quot;) #按列分组</span><br><span class="line">print(gs) #DataFrameGroupBy类对象</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">print(gs.groups) #字典形式，键为队名，值为索引构成的列表</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">2   Devils     2  2014     863</span><br><span class="line">3   Devils     3  2015     673</span><br><span class="line">4    Kings     3  2014     741</span><br><span class="line">5     king     4  2015     812</span><br><span class="line">6    Kings     1  2016     756</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x000001FF1ACEE4C0&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;&apos;Devils&apos;: [2, 3], &apos;Kings&apos;: [4, 6, 7], &apos;Riders&apos;: [0, 1, 8, 11], &apos;Royals&apos;: [9, 10], &apos;king&apos;: [5]&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 遍历分组结果</span><br><span class="line">gs = df.groupby(&quot;Team&quot;)</span><br><span class="line">for name, g in gs:</span><br><span class="line">    print(name)</span><br><span class="line">    print(g)</span><br><span class="line">    print(&quot;------------------------------&quot;)</span><br><span class="line"></span><br><span class="line">Devils</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">2  Devils     2  2014     863</span><br><span class="line">3  Devils     3  2015     673</span><br><span class="line">------------------------------</span><br><span class="line">Kings</span><br><span class="line">    Team  Rank  Year  Points</span><br><span class="line">4  Kings     3  2014     741</span><br><span class="line">6  Kings     1  2016     756</span><br><span class="line">7  Kings     1  2017     788</span><br><span class="line">------------------------------</span><br><span class="line">Riders</span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line">------------------------------</span><br><span class="line">Royals</span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">------------------------------</span><br><span class="line">king</span><br><span class="line">   Team  Rank  Year  Points</span><br><span class="line">5  king     4  2015     812</span><br><span class="line">------------------------------</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">gs = df.groupby([&quot;Team&quot;, &quot;Year&quot;]) #按多列分组</span><br><span class="line">print(gs.groups)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">for name, g in gs:</span><br><span class="line">    print(name)</span><br><span class="line">    print(g)</span><br><span class="line">    print(&quot;-------------------------------&quot;)</span><br><span class="line"></span><br><span class="line">&#123;(&apos;Devils&apos;, 2014): [2], (&apos;Devils&apos;, 2015): [3], (&apos;Kings&apos;, 2014): [4], (&apos;Kings&apos;, 2016): [6], (&apos;Kings&apos;, 2017): [7], (&apos;Riders&apos;, 2014): [0], (&apos;Riders&apos;, 2015): [1], (&apos;Riders&apos;, 2016): [8], (&apos;Riders&apos;, 2017): [11], (&apos;Royals&apos;, 2014): [9], (&apos;Royals&apos;, 2015): [10], (&apos;king&apos;, 2015): [5]&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(&apos;Devils&apos;, 2014)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">2  Devils     2  2014     863</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Devils&apos;, 2015)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">3  Devils     3  2015     673</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Kings&apos;, 2014)</span><br><span class="line">    Team  Rank  Year  Points</span><br><span class="line">4  Kings     3  2014     741</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Kings&apos;, 2016)</span><br><span class="line">    Team  Rank  Year  Points</span><br><span class="line">6  Kings     1  2016     756</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Kings&apos;, 2017)</span><br><span class="line">    Team  Rank  Year  Points</span><br><span class="line">7  Kings     1  2017     788</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Riders&apos;, 2014)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">0  Riders     1  2014     876</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Riders&apos;, 2015)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">1  Riders     2  2015     789</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Riders&apos;, 2016)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">8  Riders     2  2016     694</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Riders&apos;, 2017)</span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Royals&apos;, 2014)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">9  Royals     4  2014     701</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Royals&apos;, 2015)</span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;king&apos;, 2015)</span><br><span class="line">   Team  Rank  Year  Points</span><br><span class="line">5  king     4  2015     812</span><br><span class="line">-------------------------------</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># **选择一个分组**</span><br><span class="line">gs = df.groupby(&quot;Year&quot;)</span><br><span class="line">g = gs.get_group(2017)</span><br><span class="line">print(g)</span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">11  Riders     2  2017     690</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">gs=df.groupby(df.dtypes,axis=1) #按数据类型分组</span><br><span class="line">for name, g in gs:</span><br><span class="line">    print(name)</span><br><span class="line">    print(g)</span><br><span class="line">    print(&quot;-------------------------------&quot;)</span><br><span class="line"></span><br><span class="line">int64</span><br><span class="line">    Rank  Year  Points</span><br><span class="line">0      1  2014     876</span><br><span class="line">1      2  2015     789</span><br><span class="line">2      2  2014     863</span><br><span class="line">3      3  2015     673</span><br><span class="line">4      3  2014     741</span><br><span class="line">5      4  2015     812</span><br><span class="line">6      1  2016     756</span><br><span class="line">7      1  2017     788</span><br><span class="line">8      2  2016     694</span><br><span class="line">9      4  2014     701</span><br><span class="line">10     1  2015     804</span><br><span class="line">11     2  2017     690</span><br><span class="line">-------------------------------</span><br><span class="line">object</span><br><span class="line">      Team</span><br><span class="line">0   Riders</span><br><span class="line">1   Riders</span><br><span class="line">2   Devils</span><br><span class="line">3   Devils</span><br><span class="line">4    Kings</span><br><span class="line">5     king</span><br><span class="line">6    Kings</span><br><span class="line">7    Kings</span><br><span class="line">8   Riders</span><br><span class="line">9   Royals</span><br><span class="line">10  Royals</span><br><span class="line">11  Riders</span><br><span class="line">-------------------------------</span><br></pre></td></tr></table></figure>
<h2 id="聚合，操作分组后的数据"><a href="#聚合，操作分组后的数据" class="headerlink" title="聚合，操作分组后的数据"></a>聚合，操作分组后的数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 聚合 **操作分组后的数据**  忽略nan值</span><br><span class="line">data = &#123;</span><br><span class="line">    &apos;Team&apos;: [&apos;Riders&apos;, &apos;Riders&apos;, &apos;Devils&apos;, &apos;Devils&apos;, &apos;Kings&apos;,</span><br><span class="line">    &apos;king&apos;, &apos;Kings&apos;, &apos;Kings&apos;, &apos;Riders&apos;, &apos;Royals&apos;, &apos;Royals&apos;, &apos;Riders&apos;],</span><br><span class="line">    &apos;Rank&apos;: [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2],</span><br><span class="line">    &apos;Year&apos;: [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017],</span><br><span class="line">    &apos;Points&apos;:[876,789,863,673,741,812,756,788,694,701,804,690]</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">print(&quot;\n&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="应用一个聚合函数"><a href="#应用一个聚合函数" class="headerlink" title="应用一个聚合函数"></a>应用一个聚合函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">gs=df.groupby(&apos;Team&apos;).sum()#按队名分组，并对每个队的其他项目求和</span><br><span class="line">print(gs)</span><br><span class="line">print(&apos;----------------------------&apos;)</span><br><span class="line"></span><br><span class="line"># 同时应用多个聚合函数</span><br><span class="line">gs=df.groupby(&apos;Team&apos;)</span><br><span class="line"></span><br><span class="line"># 若要对每个项目都应用多个函数，则只需df.groupby(&apos;Team&apos;).agg([各个方法即可])</span><br><span class="line">#这里，按队名分组，并对每个队的&apos;Rank&apos;项目求各个值</span><br><span class="line">g=gs[&apos;Rank&apos;].agg([np.sum,np.min,np.size])#按队名分组，并对每个队的其他项目求和</span><br><span class="line">print(g)</span><br><span class="line">g.columns=[&apos;求和&apos;,&apos;最小值&apos;,&apos;个数&apos;]</span><br><span class="line">g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">2   Devils     2  2014     863</span><br><span class="line">3   Devils     3  2015     673</span><br><span class="line">4    Kings     3  2014     741</span><br><span class="line">5     king     4  2015     812</span><br><span class="line">6    Kings     1  2016     756</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Rank  Year  Points</span><br><span class="line">Team                      </span><br><span class="line">Devils     5  4029    1536</span><br><span class="line">Kings      5  6047    2285</span><br><span class="line">Riders     7  8062    3049</span><br><span class="line">Royals     5  4029    1505</span><br><span class="line">king       4  2015     812</span><br><span class="line">----------------------------</span><br><span class="line">        sum  amin  size</span><br><span class="line">Team                   </span><br><span class="line">Devils    5     2     2</span><br><span class="line">Kings     5     1     3</span><br><span class="line">Riders    7     1     4</span><br><span class="line">Royals    5     1     2</span><br><span class="line">king      4     4     1</span><br><span class="line"></span><br><span class="line">      求和	最小值	个数</span><br><span class="line">Team			</span><br><span class="line">Devils	5	    2	    2</span><br><span class="line">Kings	  5	    1	    3</span><br><span class="line">Riders	7	    1	    4</span><br><span class="line">Royals	5	    1	    2</span><br><span class="line">king	  4	    4	    1</span><br></pre></td></tr></table></figure>
<h3 id="apply聚合-应用自己写的函数"><a href="#apply聚合-应用自己写的函数" class="headerlink" title="apply聚合 应用自己写的函数"></a>apply聚合 应用自己写的函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;</span><br><span class="line">    &apos;Team&apos;: [&apos;Riders&apos;, &apos;Riders&apos;, &apos;Devils&apos;, &apos;Devils&apos;, &apos;Kings&apos;,</span><br><span class="line">    &apos;king&apos;, &apos;Kings&apos;, &apos;Kings&apos;, &apos;Riders&apos;, &apos;Royals&apos;, &apos;Royals&apos;, &apos;Riders&apos;],</span><br><span class="line">    &apos;Rank&apos;: [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2],</span><br><span class="line">    &apos;Year&apos;: [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017],</span><br><span class="line">    &apos;Points&apos;:[876,789,863,673,741,812,756,788,694,701,804,690]</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">print(&quot;\n&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="应用一个自定义的聚合函数"><a href="#应用一个自定义的聚合函数" class="headerlink" title="应用一个自定义的聚合函数"></a>应用一个自定义的聚合函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gs=df.groupby(&apos;Team&apos;)[&apos;Rank&apos;].apply(lambda x:x+10)</span><br><span class="line">print(gs)</span><br></pre></td></tr></table></figure>
<h2 id="转换"><a href="#转换" class="headerlink" title="转换"></a>转换</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">print(df)</span><br><span class="line">gs = df.groupby(&quot;Team&quot;)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line"># 转换返回索引与原DataFrame的索引相同的对象</span><br><span class="line"># 对比gs=df.groupby(&apos;Team&apos;).sum()看更好理解</span><br><span class="line"></span><br><span class="line">print(gs.transform(np.sum))</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">print(gs[&quot;Points&quot;].transform(np.sum))</span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">2   Devils     2  2014     863</span><br><span class="line">3   Devils     3  2015     673</span><br><span class="line">4    Kings     3  2014     741</span><br><span class="line">5     king     4  2015     812</span><br><span class="line">6    Kings     1  2016     756</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Rank  Year  Points</span><br><span class="line">0      7  8062    3049</span><br><span class="line">1      7  8062    3049</span><br><span class="line">2      5  4029    1536</span><br><span class="line">3      5  4029    1536</span><br><span class="line">4      5  6047    2285</span><br><span class="line">5      4  2015     812</span><br><span class="line">6      5  6047    2285</span><br><span class="line">7      5  6047    2285</span><br><span class="line">8      7  8062    3049</span><br><span class="line">9      5  4029    1505</span><br><span class="line">10     5  4029    1505</span><br><span class="line">11     7  8062    3049</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0     3049</span><br><span class="line">1     3049</span><br><span class="line">2     1536</span><br><span class="line">3     1536</span><br><span class="line">4     2285</span><br><span class="line">5      812</span><br><span class="line">6     2285</span><br><span class="line">7     2285</span><br><span class="line">8     3049</span><br><span class="line">9     1505</span><br><span class="line">10    1505</span><br><span class="line">11    3049</span><br><span class="line">Name: Points, dtype: int64</span><br></pre></td></tr></table></figure>
<h2 id="过滤-根据定义的标准，过滤数据并返回数据的子集"><a href="#过滤-根据定义的标准，过滤数据并返回数据的子集" class="headerlink" title="过滤 根据定义的标准，过滤数据并返回数据的子集"></a>过滤 根据定义的标准，过滤数据并返回数据的子集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">print(df)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">gs = df.groupby(&quot;Team&quot;)</span><br><span class="line">print(gs.groups)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">print(gs.filter(lambda x: len(x) &gt;= 4))</span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">2   Devils     2  2014     863</span><br><span class="line">3   Devils     3  2015     673</span><br><span class="line">4    Kings     3  2014     741</span><br><span class="line">5     king     4  2015     812</span><br><span class="line">6    Kings     1  2016     756</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;&apos;Devils&apos;: [2, 3], &apos;Kings&apos;: [4, 6, 7], &apos;Riders&apos;: [0, 1, 8, 11], &apos;Royals&apos;: [9, 10], &apos;king&apos;: [5]&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">11  Riders     2  2017     690</span><br></pre></td></tr></table></figure>
<h2 id="数据透视表"><a href="#数据透视表" class="headerlink" title="数据透视表"></a>数据透视表</h2><ul>
<li>未设置aggfunc时，它默认aggfunc=’mean’计算均值</li>
<li>它根据一个或多个键对数据进行聚合，</li>
<li>并根据行和列上的分组键将数据分配到各个矩形区域中。</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>DataFrame</td>
</tr>
<tr>
<td>values</td>
<td>待聚合的列的名称。默认聚合所有数值列</td>
</tr>
<tr>
<td>index</td>
<td>用于分组的列名或其他分组键，出现在结果透视表的行</td>
</tr>
<tr>
<td>columns</td>
<td>用于分组的列名或其他分组键，出现在结果透视表的列</td>
</tr>
<tr>
<td>aggfunc</td>
<td>聚合函数或函数列表，默认为‘mean’。可以使任何对groupby有效的函数</td>
</tr>
<tr>
<td>fill_value</td>
<td>用于替换结果表中的缺失值</td>
</tr>
<tr>
<td>dropna</td>
<td>boolean，默认为True</td>
</tr>
<tr>
<td>margins_name</td>
<td>string，默认为‘ALL’，当参数margins为True时，ALL行和列的名字</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">path=&apos;E:/Users/lqy/Desktop/Pandas学习/James_Harden.csv&apos;</span><br><span class="line">df = pd.read_csv(path)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">index</span><br><span class="line">作用：每个pivot_table必须拥有一个index，Index就是层次字段，</span><br><span class="line">要通过透视表获取什么信息就按照相应的顺序设置字段，</span><br><span class="line">所以在进行pivot之前你也需要足够了解你的数据</span><br><span class="line"></span><br><span class="line"># 如果想查看哈登对阵每个队伍的得分，首先我们将对手设置为index</span><br><span class="line">pd.pivot_table(df,index=[u&apos;对手&apos;]).head()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 对手成为了第一层索引，还想看看对阵同一对手在不同主客场下的数据，</span><br><span class="line"># 试着将对手与胜负与主客场都设置为index，其实就变成为了两层索引</span><br><span class="line">pd.pivot_table(df,index=[u&apos;对手&apos;, u&apos;主客场&apos;]).head()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 试着交换下它们的顺序，数据结果一样</span><br><span class="line">pd.pivot_table(df,index=[u&apos;主客场&apos;,u&apos;对手&apos;]).head(15)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># values</span><br><span class="line"># 作用：可以对需要的计算数据进行筛选</span><br><span class="line"># 案例：我们只需要james harden在主客场和不同胜负情况下的得分、篮板与助攻三项数据</span><br><span class="line">pd.pivot_table(df,index=[u&apos;主客场&apos;,u&apos;胜负&apos;],values=[u&apos;得分&apos;,u&apos;助攻&apos;,u&apos;篮板&apos;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                助攻	得分	篮板</span><br><span class="line">主客场 胜负			</span><br><span class="line">  主	  胜	10.555556	34.222222	5.444444</span><br><span class="line">        负	8.666667	29.666667	5.000000</span><br><span class="line">  客	  胜	9.000000	32.000000	4.916667</span><br><span class="line">        负	8.000000	20.000000	4.000000</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># aggfunc</span><br><span class="line"></span><br><span class="line"># 作用：设置我们对数据聚合时进行的函数操作，未设置aggfunc时，它默认aggfunc=&apos;mean&apos;计算均值</span><br><span class="line"></span><br><span class="line"># 1. 获得james harden在主客场和不同胜负情况下的总得分、总篮板、总助攻</span><br><span class="line">pd.pivot_table(df,index=[u&apos;主客场&apos;,u&apos;胜负&apos;],values=[u&apos;得分&apos;,u&apos;助攻&apos;,u&apos;篮板&apos;],aggfunc=[np.sum,np.max])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    sum	amax</span><br><span class="line">          助攻	得分	篮板	助攻	得分	篮板</span><br><span class="line">主客场	胜负						</span><br><span class="line">    主	胜	95	308	49	17	56	11</span><br><span class="line">        负	26	89	15	11	38	6</span><br><span class="line">    客	胜	108	384	59	15	48	10</span><br><span class="line">        负	8	  20	4	  8	  20	4</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># aggfunc也可以使用dict类型，助攻求min,max和mean,得分求mean</span><br><span class="line">pd.pivot_table(df,index=[u&apos;对手&apos;,u&apos;胜负&apos;],values=[u&apos;得分&apos;,u&apos;助攻&apos;,u&apos;篮板&apos;],</span><br><span class="line">               aggfunc=&#123;u&apos;得分&apos;:np.mean, u&apos;助攻&apos;:[min, max, np.mean]&#125;).head()</span><br><span class="line"></span><br><span class="line">		      助攻	        得分</span><br><span class="line">          max	mean	min	mean</span><br><span class="line">对手	胜负				</span><br><span class="line">76人	胜	13.0	13.0	13.0	27.0</span><br><span class="line">      负	7.0	  7.0	  7.0	  29.0</span><br><span class="line">勇士	胜	11.0	11.0	11.0	27.0</span><br><span class="line">国王	胜	9.0	  9.0	  9.0	  27.0</span><br><span class="line">太阳	胜	7.0	  7.0	  7.0	  48.0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># columns</span><br><span class="line"></span><br><span class="line"># 作用：类似Index可以设置列层次字段，它不是一个必要参数，作为一种分割数据的可选方式</span><br><span class="line">pd.pivot_table(df,index=[u&apos;对手&apos;,u&apos;胜负&apos;],columns=[u&apos;主客场&apos;],values=[u&apos;得分&apos;]).head()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        得分</span><br><span class="line">    主客场	主	客</span><br><span class="line">对手	胜负		</span><br><span class="line">76人	胜	NaN	27.0</span><br><span class="line">      负	29.0	NaN</span><br><span class="line">勇士	胜	NaN	27.0</span><br><span class="line">国王	胜	NaN	27.0</span><br><span class="line">太阳	胜	NaN	48.0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># fill_value</span><br><span class="line"></span><br><span class="line"># 作用：填充空值</span><br><span class="line">pd.pivot_table(df,index=[u&apos;对手&apos;,u&apos;胜负&apos;],columns=[u&apos;主客场&apos;],values=[u&apos;得分&apos;], fill_value=0).head()</span><br><span class="line"></span><br><span class="line">		  得分</span><br><span class="line">    主客场 主	客</span><br><span class="line">对手	胜负		</span><br><span class="line">76人	胜	0	  27</span><br><span class="line">      负	29	0</span><br><span class="line">勇士	胜	0	  27</span><br><span class="line">国王	胜	0	  27</span><br><span class="line">太阳	胜	0	  48</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># margins</span><br><span class="line"></span><br><span class="line"># 作用：是否进行汇总</span><br><span class="line">pd.pivot_table(df,index=[u&apos;主客场&apos;],columns=[u&apos;对手&apos;],values=[u&apos;得分&apos;],aggfunc=[np.sum],fill_value=0,margins=1)</span><br><span class="line"></span><br><span class="line">	    sum</span><br><span class="line">      得分</span><br><span class="line">对手	76人	勇士	国王	太阳	小牛	尼克斯	开拓者	掘金	步行者	湖人	灰熊	爵士	猛龙	篮网	老鹰	骑士	鹈鹕	黄蜂	All</span><br><span class="line">主客场																			</span><br><span class="line">  主	29	0	0	0	29	37	0	21	29	0	60	56	38	37	0	35	26	0	397</span><br><span class="line">  客	27	27	27	48	0	31	48	0	26	36	49	29	0	0	29	0	0	27	404</span><br><span class="line">  All	56	27	27	48	29	68	48	21	55	36	109	85	38	37	29	35	26	27	801</span><br></pre></td></tr></table></figure>
<h2 id="数据交叉表"><a href="#数据交叉表" class="headerlink" title="数据交叉表"></a>数据交叉表</h2><ol>
<li>透视表pivot_table()是一种进行分组统计的函数，参数aggfunc决定统计类型</li>
<li>交叉表crosstab()是一种特殊的pivot_table()，专用于计算分组频率</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;&apos;Sample&apos;: range(1, 8), </span><br><span class="line">                   &apos;Gender&apos;: [&apos;Female&apos;, &apos;Male&apos;, &apos;Female&apos;, &apos;Male&apos;, &apos;Male&apos;, &apos;Male&apos;, &apos;Female&apos;], </span><br><span class="line">                   &apos;Handedness&apos;: [&apos;Right-handed&apos;, &apos;Left-handed&apos;, &apos;Right-handed&apos;, &apos;Right-handed&apos;, &apos;Left-handed&apos;, &apos;Right-handed&apos;, &apos;Right-handed&apos;]&#125;)</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">	Sample	Gender	Handedness</span><br><span class="line">0	1	Female	Right-handed</span><br><span class="line">1	2	Male	Left-handed</span><br><span class="line">2	3	Female	Right-handed</span><br><span class="line">3	4	Male	Right-handed</span><br><span class="line">4	5	Male	Left-handed</span><br><span class="line">5	6	Male	Right-handed</span><br><span class="line">6	7	Female	Right-handed</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 需求：根据性别和用手习惯对这段数据进行统计汇总</span><br><span class="line"></span><br><span class="line"># 1. pivot_table()实现该功能</span><br><span class="line">pd.pivot_table(df, index=[&apos;Gender&apos;], columns=&apos;Handedness&apos;, aggfunc=len, margins=True)</span><br><span class="line"></span><br><span class="line">	    Sample</span><br><span class="line">Handedness	Left-handed	Right-handed	All</span><br><span class="line">    Gender			</span><br><span class="line">    Female	NaN	          3.0       	3</span><br><span class="line">      Male	2.0	          2.0	        4</span><br><span class="line">       All	2.0	          5.0	         7</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># crosstab()函数会更方便</span><br><span class="line">pd.crosstab(df.Gender, df.Handedness, margins=True)</span><br><span class="line"></span><br><span class="line">Handedness	Left-handed	Right-handed	All</span><br><span class="line">    Gender			</span><br><span class="line">    Female	0	              3	          3</span><br><span class="line">      Male	2	              2	          4</span><br><span class="line">      All	  2	              5	          7</span><br></pre></td></tr></table></figure>
<h2 id="IO操作-文件读写"><a href="#IO操作-文件读写" class="headerlink" title="IO操作 文件读写"></a>IO操作 文件读写</h2><table>
<thead>
<tr>
<th>read_csv</th>
<th>读取CSV文件</th>
</tr>
</thead>
<tbody>
<tr>
<td>read_excel</td>
<td>读取Excel文件</td>
</tr>
<tr>
<td>read_html</td>
<td>读取网页HTML文件</td>
</tr>
<tr>
<td>read_sql</td>
<td>读取sql数据库</td>
</tr>
<tr>
<td>read_sql_table</td>
<td>读取sql数据库中的表</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>常用写文件方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>to_csv</td>
<td>写CSV文件</td>
</tr>
<tr>
<td>to_excel</td>
<td>写Excel文件</td>
</tr>
<tr>
<td>to_sql</td>
<td>写数据库</td>
</tr>
</tbody>
</table>
<h3 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h3><ol>
<li><p>encoding一般情况下我们用utf-8编码进行保存，如果出现中文编码错误，则可以依次换用gbk，gb2312 , gb18030，一般总能成功的，本例中用utf-8</p>
</li>
<li><p>to_csv方法，具体参数还有很多，可以去看官方文档，这里提到一个index = False参数，表示保存csv的时候，我们不保存pandas 的Data frame的行索引1234这样的序号，默认情况不加的话是index = True，会有行号，这点在保存数据库mysql的时候体现尤其明显，不注意的话可能会出错</p>
</li>
</ol>
<p><strong>从csv文件读取后，作为DataFrame时，会自动添加索引列，然后保存，当再次读取时，会多一列叫：Unnamed: 0 ，处理如下：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df=pd.read_csv(&quot;./data.csv&quot;, index_col=[&quot;Unnamed: 0&quot;])</span><br><span class="line"></span><br><span class="line">或者直接删除这一列：del df[&apos;Unnamed: 0&apos;]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#dtype的列可以作为字典传递,分别指定某一列的数据类型</span><br><span class="line">dtype=&#123;&apos;id&apos;: np.float64&#125;</span><br></pre></td></tr></table></figure>
<h2 id="日期时间样式数据统计"><a href="#日期时间样式数据统计" class="headerlink" title="日期时间样式数据统计"></a>日期时间样式数据统计</h2><h3 id="将上映时间设置为行索引-1986-06-08"><a href="#将上映时间设置为行索引-1986-06-08" class="headerlink" title="将上映时间设置为行索引 1986-06-08"></a>将上映时间设置为行索引 1986-06-08</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=data_dr.set_index(data_dr[&apos;上映时间&apos;])</span><br></pre></td></tr></table></figure>
<h3 id="并转换为日期时间格式"><a href="#并转换为日期时间格式" class="headerlink" title="并转换为日期时间格式"></a>并转换为日期时间格式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[&apos;上映时间&apos;]=pd.to_datetime(data[&apos;上映时间&apos;])</span><br></pre></td></tr></table></figure>
<h3 id="按年计数-即可得到每一年上应的电影数据"><a href="#按年计数-即可得到每一年上应的电影数据" class="headerlink" title="按年计数 即可得到每一年上应的电影数据"></a>按年计数 即可得到每一年上应的电影数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[&apos;上映时间&apos;].resample(&apos;Y&apos;).count()</span><br></pre></td></tr></table></figure>
<h2 id="数据清理笔记"><a href="#数据清理笔记" class="headerlink" title="数据清理笔记"></a>数据清理笔记</h2><h3 id="从原始文件读取我们需要的字段usecols"><a href="#从原始文件读取我们需要的字段usecols" class="headerlink" title="从原始文件读取我们需要的字段usecols"></a>从原始文件读取我们需要的字段usecols</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data=pd.read_excel(&apos;./豆瓣电影数据.xlsx&apos;,usecols=[&apos;名字&apos;,&apos;类型&apos;,&apos;评分&apos;,&apos;投票人数&apos;,&apos;上映时间&apos;,&apos;产地&apos;])</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>
<h3 id="对日期长度不足10位的设置为nan"><a href="#对日期长度不足10位的设置为nan" class="headerlink" title="对日期长度不足10位的设置为nan"></a>对日期长度不足10位的设置为nan</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df5=data[&apos;上映时间&apos;].apply(lambda x: x if (len(x)==10) else np.nan)</span><br></pre></td></tr></table></figure>
<h3 id="删除包含nan的数据"><a href="#删除包含nan的数据" class="headerlink" title="删除包含nan的数据"></a>删除包含nan的数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data_dr=data.drop(data[pd.isna(data[&apos;上映时间&apos;])].index)</span><br><span class="line">pd.isna(data_dr[&apos;上映时间&apos;]).value_counts()</span><br></pre></td></tr></table></figure>
<h3 id="删除包含斜杠的数据"><a href="#删除包含斜杠的数据" class="headerlink" title="删除包含斜杠的数据 /"></a>删除包含斜杠的数据 /</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_dr=data_dr.drop(data_dr[data_dr[&apos;上映时间&apos;].str.contains(&apos;/&apos;)].index)</span><br></pre></td></tr></table></figure>
<h3 id="对包含点的数据删除"><a href="#对包含点的数据删除" class="headerlink" title="对包含点的数据删除"></a>对包含点的数据删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_dr=data_dr.drop(data_dr[data_dr[&apos;上映时间&apos;].str.contains(&apos;\.&apos;)].index)</span><br></pre></td></tr></table></figure>
<h3 id="对包含’（’的数据删除"><a href="#对包含’（’的数据删除" class="headerlink" title="对包含’（’的数据删除"></a>对包含’（’的数据删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=data.drop(data[data[&apos;上映时间&apos;].str.contains(&apos;（&apos;)].index)</span><br></pre></td></tr></table></figure>
<h3 id="删除投票人数小于0的数据"><a href="#删除投票人数小于0的数据" class="headerlink" title="删除投票人数小于0的数据"></a>删除投票人数小于0的数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_dr2 = data_dr.drop(data_dr[data_dr[&apos;投票人数&apos;] &lt; 0].index)</span><br></pre></td></tr></table></figure>
<h3 id="投票人数有小数，为异常值，删除"><a href="#投票人数有小数，为异常值，删除" class="headerlink" title="投票人数有小数，为异常值，删除"></a>投票人数有小数，为异常值，删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_dr3 = data_dr2.drop(data_dr2[data_dr2[&apos;投票人数&apos;] % 1 != 0].index)</span><br></pre></td></tr></table></figure>
<h3 id="对异常日期的清理，包括闰年等"><a href="#对异常日期的清理，包括闰年等" class="headerlink" title="对异常日期的清理，包括闰年等"></a>对异常日期的清理，包括闰年等</h3><h4 id="如下age字段第一条张三正常，其他都不符要求"><a href="#如下age字段第一条张三正常，其他都不符要求" class="headerlink" title="如下age字段第一条张三正常，其他都不符要求"></a>如下age字段第一条张三正常，其他都不符要求</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">import re</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data=&#123;&apos;name&apos;:[&apos;张三&apos;,&apos;李四&apos;,&apos;王武&apos;,&apos;赵柳&apos;,&apos;马强&apos;,&apos;杨波&apos;],</span><br><span class="line">     &apos;age&apos;:[&apos;1994-09-10&apos;,&apos;20136-2013&apos;,&apos;2020-02-29&apos;,&apos;19955.1997&apos;,&apos;19898/1989&apos;,&apos;2011-7（台湾）&apos;]&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/60c59c6a844ef46bb2add6ef.jpg" alt></p>
<h4 id="yy-mm-dd格式的日期正则匹配"><a href="#yy-mm-dd格式的日期正则匹配" class="headerlink" title="yy-mm-dd格式的日期正则匹配"></a>yy-mm-dd格式的日期正则匹配</h4><h4 id="apply函数作用后返回一个新的列-，可以重新覆盖"><a href="#apply函数作用后返回一个新的列-，可以重新覆盖" class="headerlink" title="apply函数作用后返回一个新的列 ，可以重新覆盖"></a>apply函数作用后返回一个新的列 ，可以重新覆盖</h4><h4 id="将不匹配的数据全部转换为NAN，然后统一删除"><a href="#将不匹配的数据全部转换为NAN，然后统一删除" class="headerlink" title="将不匹配的数据全部转换为NAN，然后统一删除"></a>将不匹配的数据全部转换为NAN，然后统一删除</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[&apos;age&apos;]=df[&apos;age&apos;].apply(lambda x: x if (re.fullmatch(r&quot;([0-9]&#123;3&#125;[1-9]|[0-9]&#123;2&#125;[1-9][0-9]&#123;1&#125;|[0-9]&#123;1&#125;[1-9][0-9]&#123;2&#125;|[1-9][0-9]&#123;3&#125;)-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8])))&quot;,x)) else np.nan)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/60c59dd9844ef46bb2c98a74.jpg" alt></p>
<h4 id="删除NAN-相应的行也删除"><a href="#删除NAN-相应的行也删除" class="headerlink" title="删除NAN,相应的行也删除"></a>删除NAN,相应的行也删除</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data_dr=df.drop(df[pd.isna(df[&apos;age&apos;])].index)</span><br><span class="line">data_dr </span><br><span class="line"></span><br><span class="line">  name	age</span><br><span class="line">0	张三	1994-09-10</span><br></pre></td></tr></table></figure>
<h2 id="将一列字段元组拆分成两列字段，非常好"><a href="#将一列字段元组拆分成两列字段，非常好" class="headerlink" title="将一列字段元组拆分成两列字段，非常好"></a>将一列字段元组拆分成两列字段，非常好</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/60c5efa3844ef46bb2788259.jpg" alt><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for i in range (len(df2)):</span><br><span class="line">    l1 = [list(j)[0] for j in df2[0]]</span><br><span class="line">    l2 = [list(k)[1] for k in df2[0]]</span><br><span class="line">l1</span><br><span class="line">l2</span><br><span class="line">df2[&apos;country&apos;] = l1</span><br><span class="line">df2[&apos;year&apos;] = l2</span><br><span class="line">df2</span><br></pre></td></tr></table></figure></p>
<p><img src="https://pic.imgdb.cn/item/60c5f042844ef46bb27ed87d.jpg" alt></p>
<h2 id="找到2008年，中国产的电影数量"><a href="#找到2008年，中国产的电影数量" class="headerlink" title="找到2008年，中国产的电影数量"></a>找到2008年，中国产的电影数量</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(df2[df2[&apos;country&apos;]==&apos;中国&apos;][df2[&apos;year&apos;]==&apos;2008&apos;][&apos;num&apos;])</span><br></pre></td></tr></table></figure>
<h2 id="生成2-0到3-9步长为0-1的列表"><a href="#生成2-0到3-9步长为0-1的列表" class="headerlink" title="生成2.0到3.9步长为0.1的列表"></a>生成2.0到3.9步长为0.1的列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bins=[]</span><br><span class="line">ls=[]</span><br><span class="line">x=20</span><br><span class="line">while x &lt;= 39:</span><br><span class="line">    bins.append(x)</span><br><span class="line">    x+= 1</span><br><span class="line"> </span><br><span class="line">for i in bins:</span><br><span class="line">    ls.append(i/10)</span><br><span class="line">ls</span><br></pre></td></tr></table></figure>
<h2 id="DataFrame-竖向形式的表遍历转为横向的表"><a href="#DataFrame-竖向形式的表遍历转为横向的表" class="headerlink" title="DataFrame 竖向形式的表遍历转为横向的表"></a>DataFrame 竖向形式的表遍历转为横向的表</h2><ul>
<li>其核心是根据第二个表的坐标，找到第一个表对应的值，填入第二个表对应的位置</li>
<li>若在第一个表中找不到，则填入np.nan，最后统一用0填补</li>
<li>坐标对应的两个字段必须是两个表都有的字段</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># country_year_num是竖向的表</span><br><span class="line"># df是横向的表</span><br><span class="line">for i in df.index:</span><br><span class="line">    for j in df.columns:</span><br><span class="line">        ls=country_year_num[country_year_num[&apos;country&apos;]==j][country_year_num[&apos;year&apos;]==i][&apos;num&apos;].values</span><br><span class="line">        if len(ls) &gt; 0:</span><br><span class="line">            df.loc[i][j]=ls[0] </span><br><span class="line">        else:</span><br><span class="line">            df.loc[i][j]=np.nan</span><br></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/60c78486844ef46bb22b3173.jpg" alt="country_year_num是竖向的表"><br><img src="https://pic.imgdb.cn/item/60c784c9844ef46bb231010d.jpg" alt="df是横向的表"><br><img src="https://pic.imgdb.cn/item/60c785d5844ef46bb2482f34.jpg" alt="填充后"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.fillna(0)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://pic.imgdb.cn/item/60c7852a844ef46bb2394e54.jpg" alt></p>
<h2 id="热力图heatmap"><a href="#热力图heatmap" class="headerlink" title="热力图heatmap"></a>热力图heatmap</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import matplotlib</span><br><span class="line"></span><br><span class="line">rates=df.index</span><br><span class="line">geners=df.columns</span><br><span class="line">nums=df.values</span><br></pre></td></tr></table></figure>
<h2 id="箱形图"><a href="#箱形图" class="headerlink" title="箱形图"></a>箱形图</h2><ul>
<li>四分位：一列数据从小到大排列，第四分之一位置即下四分位，上四分位即四分之三位，或从大到小的第四分之一位</li>
<li>IQR:上四分位减去下四分位</li>
<li>上界：上四分位+1.5IQR</li>
<li>下界：下四分位-1.5IQR</li>
<li>异常值：超过上界或下界的值</li>
<li>中位数：中间位置的数</li>
<li>最值：排除异常值之后的极值</li>
<li>箱子越短数据越集中</li>
</ul>
<p><div style="width:100%;height:1px;background-color:pink;opacity:.7"></div></p>
<center><a target="_blank" style="color:skyblue;font-weight:bold;" href="http://wpa.qq.com/msgrd?v=3&uin=2642816105&site=qq&menu=yes">有事您Q我👇</a></center>


      
    </div>
    
    
    

    
      <div>
        
<div style="text-align:center;color: #006400;font-size:14px;">
	------ The Happy Ending<i class="fa fa-paw"></i>Thanks for your reading! ------</div>

      </div>
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>写的不错嘛，赏你吃🍬</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>🤞🤞🤞</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="梦不成 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="梦不成 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    梦不成
  </li>
  <li class="post-copyright-link">
    <strong>原始链接：</strong>
    <a href="https://shulu520.com/数据分析/Python数据分析之工具-pandas笔记/" title="Python数据分析之pandas">https://shulu520.com/数据分析/Python数据分析之工具-pandas笔记/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。欢迎转载，请保留原文链接及作者
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        
          <div class="wp_rating">
            <div id="wpac-rating"></div>
          </div>
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/数据分析/Python数据分析之工具-NumPy笔记/" rel="next" title="数据分析之NumPy笔记">
                <i class="fa fa-chevron-left"></i> 数据分析之NumPy笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/数据分析/Python数据分析之工具-Matplotlib笔记/" rel="prev" title="Matplotlib">
                Matplotlib <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80MzgyMi8yMDM1Nw=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/head_icon.gif" alt="梦不成">
            
              <p class="site-author-name" itemprop="name">梦不成</p>
              <p class="site-description motion-element" itemprop="description">君子生非异也，善假于物也</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">125</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">62</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">57</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/rss2.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lqyasl" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:2642816105@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#忽略警告warnings"><span class="nav-number">1.</span> <span class="nav-text">忽略警告warnings</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#读取指定列的数据usecols"><span class="nav-number">2.</span> <span class="nav-text">读取指定列的数据usecols</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Serious对象转list，只拿到值，不要索引"><span class="nav-number">3.</span> <span class="nav-text">Serious对象转list，只拿到值，不要索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pandas-DataFrame列操作"><span class="nav-number">4.</span> <span class="nav-text">pandas DataFrame列操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#列获取选择"><span class="nav-number">4.1.</span> <span class="nav-text">列获取选择</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#单列选择"><span class="nav-number">4.1.1.</span> <span class="nav-text">单列选择</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多列选择"><span class="nav-number">4.1.2.</span> <span class="nav-text">多列选择</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#列删除-del-df-‘age’"><span class="nav-number">4.2.</span> <span class="nav-text">列删除 del df[‘age’]</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pandas-DataFrame行操作"><span class="nav-number">5.</span> <span class="nav-text">pandas DataFrame行操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#行选择df-loc-‘b’"><span class="nav-number">5.1.</span> <span class="nav-text">行选择df.loc[‘b’]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#行选择df-iloc-2-按数字index值"><span class="nav-number">5.2.</span> <span class="nav-text">行选择df.iloc[2] 按数字index值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#切片操作-运算符可以选择多行"><span class="nav-number">5.3.</span> <span class="nav-text">切片操作: 运算符可以选择多行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#loc和iloc，第二个参数都表示列选择，不写和写一个冒号都表示所有列，参数之间逗号隔开"><span class="nav-number">5.4.</span> <span class="nav-text">loc和iloc，第二个参数都表示列选择，不写和写一个冒号都表示所有列，参数之间逗号隔开</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#行修改"><span class="nav-number">5.5.</span> <span class="nav-text">行修改</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#行添加append"><span class="nav-number">5.6.</span> <span class="nav-text">行添加append</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#行删除"><span class="nav-number">5.7.</span> <span class="nav-text">行删除</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除小数-8-0这种不算-，某一列含小数所有行"><span class="nav-number">6.</span> <span class="nav-text">删除小数(8.0这种不算)，某一列含小数所有行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#number-1-0-这就是小数"><span class="nav-number">6.1.</span> <span class="nav-text">number % 1 != 0 这就是小数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#行列选择-第几行第几列"><span class="nav-number">7.</span> <span class="nav-text">行列选择 第几行第几列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看头尾"><span class="nav-number">8.</span> <span class="nav-text">查看头尾</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#显示Dateframe所有行-列"><span class="nav-number">9.</span> <span class="nav-text">显示Dateframe所有行/列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#重建索引reindex"><span class="nav-number">10.</span> <span class="nav-text">重建索引reindex</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#排序"><span class="nav-number">11.</span> <span class="nav-text">排序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#按行索引排序"><span class="nav-number">11.1.</span> <span class="nav-text">按行索引排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#升降序可选ascending参数"><span class="nav-number">11.2.</span> <span class="nav-text">升降序可选ascending参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对列索引的名称排序"><span class="nav-number">11.3.</span> <span class="nav-text">对列索引的名称排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#按某列的值排序"><span class="nav-number">11.4.</span> <span class="nav-text">按某列的值排序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#层次化索引"><span class="nav-number">12.</span> <span class="nav-text">层次化索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#层次化行索引"><span class="nav-number">13.</span> <span class="nav-text">层次化行索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#层次化列索引"><span class="nav-number">14.</span> <span class="nav-text">层次化列索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#行列同时层次化索引"><span class="nav-number">15.</span> <span class="nav-text">行列同时层次化索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#层次化索引选择"><span class="nav-number">16.</span> <span class="nav-text">层次化索引选择</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#层次化行索引行列转置"><span class="nav-number">17.</span> <span class="nav-text">层次化行索引行列转置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一级列索引变为最小级行索引"><span class="nav-number">17.1.</span> <span class="nav-text">一级列索引变为最小级行索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二级列索引变为最小级行索引"><span class="nav-number">17.2.</span> <span class="nav-text">二级列索引变为最小级行索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一级行索引变为最小级列索引"><span class="nav-number">17.3.</span> <span class="nav-text">一级行索引变为最小级列索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二级行索引变为最小级列索引"><span class="nav-number">17.4.</span> <span class="nav-text">二级行索引变为最小级列索引</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#日期与时间"><span class="nav-number">18.</span> <span class="nav-text">日期与时间</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#获取日期、时间和时间戳"><span class="nav-number">18.1.</span> <span class="nav-text">获取日期、时间和时间戳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符串转日期时间pd-to-datetime"><span class="nav-number">18.2.</span> <span class="nav-text">字符串转日期时间pd.to_datetime</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#时间差"><span class="nav-number">18.3.</span> <span class="nav-text">时间差</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#时间戳索引DatetimeIndex的快速创建"><span class="nav-number">18.4.</span> <span class="nav-text">时间戳索引DatetimeIndex的快速创建</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#重采样pd-date-range"><span class="nav-number">19.</span> <span class="nav-text">重采样pd.date_range</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#降采样"><span class="nav-number">19.1.</span> <span class="nav-text">降采样</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#增采样"><span class="nav-number">19.2.</span> <span class="nav-text">增采样</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#描述性统计信息函数"><span class="nav-number">20.</span> <span class="nav-text">描述性统计信息函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#非空观测数量"><span class="nav-number">20.1.</span> <span class="nav-text">非空观测数量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#累计总和"><span class="nav-number">20.2.</span> <span class="nav-text">累计总和</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#累计乘积"><span class="nav-number">20.3.</span> <span class="nav-text">累计乘积</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#唯一值-去重"><span class="nav-number">20.4.</span> <span class="nav-text">唯一值 去重</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#成员资格"><span class="nav-number">20.5.</span> <span class="nav-text">成员资格</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pandas的字符串操作"><span class="nav-number">21.</span> <span class="nav-text">pandas的字符串操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列的合并merge-以某个键为参考，默认how-’inner’使用键的交集"><span class="nav-number">22.</span> <span class="nav-text">列的合并merge,以某个键为参考，默认how=’inner’使用键的交集</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#在一个键上合并两个数据帧"><span class="nav-number">22.1.</span> <span class="nav-text">在一个键上合并两个数据帧</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#合并多个键上的两个数据帧"><span class="nav-number">22.2.</span> <span class="nav-text">合并多个键上的两个数据帧</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据帧的堆叠concat，默认join-’outer’取并集，axis-0竖向堆叠"><span class="nav-number">23.</span> <span class="nav-text">数据帧的堆叠concat，默认join=’outer’取并集，axis=0竖向堆叠</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#去重duplicated-drop-duplicates"><span class="nav-number">24.</span> <span class="nav-text">去重duplicated(),drop_duplicates()</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#在原数据之上修改"><span class="nav-number">24.1.</span> <span class="nav-text">在原数据之上修改</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#替换replace"><span class="nav-number">25.</span> <span class="nav-text">替换replace</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分组groupby，我们将数据分成多个集合，并在每个子集上应用一些函数"><span class="nav-number">26.</span> <span class="nav-text">分组groupby，我们将数据分成多个集合，并在每个子集上应用一些函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#聚合，操作分组后的数据"><span class="nav-number">27.</span> <span class="nav-text">聚合，操作分组后的数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#应用一个聚合函数"><span class="nav-number">27.1.</span> <span class="nav-text">应用一个聚合函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#apply聚合-应用自己写的函数"><span class="nav-number">27.2.</span> <span class="nav-text">apply聚合 应用自己写的函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#应用一个自定义的聚合函数"><span class="nav-number">27.3.</span> <span class="nav-text">应用一个自定义的聚合函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#转换"><span class="nav-number">28.</span> <span class="nav-text">转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#过滤-根据定义的标准，过滤数据并返回数据的子集"><span class="nav-number">29.</span> <span class="nav-text">过滤 根据定义的标准，过滤数据并返回数据的子集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据透视表"><span class="nav-number">30.</span> <span class="nav-text">数据透视表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据交叉表"><span class="nav-number">31.</span> <span class="nav-text">数据交叉表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IO操作-文件读写"><span class="nav-number">32.</span> <span class="nav-text">IO操作 文件读写</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注意事项："><span class="nav-number">32.1.</span> <span class="nav-text">注意事项：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#日期时间样式数据统计"><span class="nav-number">33.</span> <span class="nav-text">日期时间样式数据统计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#将上映时间设置为行索引-1986-06-08"><span class="nav-number">33.1.</span> <span class="nav-text">将上映时间设置为行索引 1986-06-08</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#并转换为日期时间格式"><span class="nav-number">33.2.</span> <span class="nav-text">并转换为日期时间格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#按年计数-即可得到每一年上应的电影数据"><span class="nav-number">33.3.</span> <span class="nav-text">按年计数 即可得到每一年上应的电影数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据清理笔记"><span class="nav-number">34.</span> <span class="nav-text">数据清理笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#从原始文件读取我们需要的字段usecols"><span class="nav-number">34.1.</span> <span class="nav-text">从原始文件读取我们需要的字段usecols</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对日期长度不足10位的设置为nan"><span class="nav-number">34.2.</span> <span class="nav-text">对日期长度不足10位的设置为nan</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除包含nan的数据"><span class="nav-number">34.3.</span> <span class="nav-text">删除包含nan的数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除包含斜杠的数据"><span class="nav-number">34.4.</span> <span class="nav-text">删除包含斜杠的数据 /</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对包含点的数据删除"><span class="nav-number">34.5.</span> <span class="nav-text">对包含点的数据删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对包含’（’的数据删除"><span class="nav-number">34.6.</span> <span class="nav-text">对包含’（’的数据删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除投票人数小于0的数据"><span class="nav-number">34.7.</span> <span class="nav-text">删除投票人数小于0的数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#投票人数有小数，为异常值，删除"><span class="nav-number">34.8.</span> <span class="nav-text">投票人数有小数，为异常值，删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对异常日期的清理，包括闰年等"><span class="nav-number">34.9.</span> <span class="nav-text">对异常日期的清理，包括闰年等</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#如下age字段第一条张三正常，其他都不符要求"><span class="nav-number">34.9.1.</span> <span class="nav-text">如下age字段第一条张三正常，其他都不符要求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#yy-mm-dd格式的日期正则匹配"><span class="nav-number">34.9.2.</span> <span class="nav-text">yy-mm-dd格式的日期正则匹配</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#apply函数作用后返回一个新的列-，可以重新覆盖"><span class="nav-number">34.9.3.</span> <span class="nav-text">apply函数作用后返回一个新的列 ，可以重新覆盖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#将不匹配的数据全部转换为NAN，然后统一删除"><span class="nav-number">34.9.4.</span> <span class="nav-text">将不匹配的数据全部转换为NAN，然后统一删除</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除NAN-相应的行也删除"><span class="nav-number">34.9.5.</span> <span class="nav-text">删除NAN,相应的行也删除</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将一列字段元组拆分成两列字段，非常好"><span class="nav-number">35.</span> <span class="nav-text">将一列字段元组拆分成两列字段，非常好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#找到2008年，中国产的电影数量"><span class="nav-number">36.</span> <span class="nav-text">找到2008年，中国产的电影数量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生成2-0到3-9步长为0-1的列表"><span class="nav-number">37.</span> <span class="nav-text">生成2.0到3.9步长为0.1的列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DataFrame-竖向形式的表遍历转为横向的表"><span class="nav-number">38.</span> <span class="nav-text">DataFrame 竖向形式的表遍历转为横向的表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#热力图heatmap"><span class="nav-number">39.</span> <span class="nav-text">热力图heatmap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#箱形图"><span class="nav-number">40.</span> <span class="nav-text">箱形图</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    
    <i class="fa fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">梦不成</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">本站字数共计&#58;</span>
    
    <span title="本站字数共计">141k</span>
  
</div>












<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>  
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("04/17/2019 11:28:36");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-users"></i> 您是第
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      位访客
    </span>
  

  
</div>








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  









  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  
  <script type="text/javascript">
  wpac_init = window.wpac_init || [];
  wpac_init.push({widget: 'Rating', id: 18789,
    el: 'wpac-rating',
    color: 'fc6423'
  });
  (function() {
    if ('WIDGETPACK_LOADED' in window) return;
    WIDGETPACK_LOADED = true;
    var mc = document.createElement('script');
    mc.type = 'text/javascript';
    mc.async = true;
    mc.src = '//embed.widgetpack.com/widget.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
  })();
  </script>


  

  

  


  
   <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas> 
   <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
   <script type="text/javascript" src="/js/src/fireworks.js"></script>
  
  
  undefined

  <!-- 点击复制按钮 -->
  <script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script>
<script type="text/javascript" src="/js/src/custom.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"superSample":2,"width":160,"height":320,"position":"left","hOffset":-12,"vOffset":-43},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"tagMode":false});</script></body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>

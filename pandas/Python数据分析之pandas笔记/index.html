<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">

<script>
    (function(){
        if(''){
            if (prompt('åšä¸»ç§æœ‰æ–‡ç« ï¼Œè¯·è¾“å…¥å¯†ç :  shulu520') !== ''){
                alert('å¯†ç é”™è¯¯ï¼');
                history.back();
            }
        }
    })();
</script>


  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">










  <meta name="baidu-site-verification" content="J3muXvxFkF">







  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.jpg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="pandas,">





  <link rel="alternate" href="/rss2.xml" title="æ¢¦ä¸æˆ" type="application/atom+xml">







  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "5af61f84"
    });
  daovoice('update');
  </script>


<meta name="description" content="æ•°æ®åˆ†æå·¥å…·ï¼šPandas">
<meta name="keywords" content="pandas">
<meta property="og:type" content="article">
<meta property="og:title" content="Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®°">
<meta property="og:url" content="https://shulu520.com/pandas/Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®°/index.html">
<meta property="og:site_name" content="æ¢¦ä¸æˆ">
<meta property="og:description" content="æ•°æ®åˆ†æå·¥å…·ï¼šPandas">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2021-04-15T06:39:39.698Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®°">
<meta name="twitter:description" content="æ•°æ®åˆ†æå·¥å…·ï¼šPandas">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://shulu520.com/pandas/Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®°/">





  <title>Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®° | æ¢¦ä¸æˆ</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">æ¢¦ä¸æˆ</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">æ€å¿µå¦‚é©¬-è‡ªåˆ«ç¦»-æœªåœè¹„</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äºæˆ‘
          </a>
        </li>
      
        
        <li class="menu-item menu-item-love">
          <a href="/love/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            love
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ–‡ç« æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            æ–‡ç« åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            æ–‡ç« å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-ç•™è¨€æ¿">
          <a href="/guestbook" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br>
            
            ç•™è¨€æ¿
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="æ¥å•Šï¼Œå¿«æ¥æ¢ç´¢æˆ‘çš„ç§˜å¯†å§..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>




<link href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" rel="stylesheet"> </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://shulu520.com/pandas/Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®°/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="æ¢¦ä¸æˆ">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head_icon.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ¢¦ä¸æˆ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®°</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2021-04-15T12:42:39+08:00">
                2021-04-15
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">æ›´æ–°&#58;</span>
              
              <time title="æ›´æ–°" itemprop="dateModified" datetime="2021-04-15T14:39:39+08:00">
                2021-04-15
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/pandas/" itemprop="url" rel="index">
                    <span itemprop="name">pandas</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-free-code-camp"></i> çƒ­åº¦
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>ğŸ”¥
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°&#58;</span>
                
                <span title="å­—æ•°">
                  10.3k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  54 åˆ†é’Ÿ
                </span>
              
            </div>
          

          
              <div class="post-description">
                  æ•°æ®åˆ†æå·¥å…·ï¼šPandas
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>&emsp;&emsp;</p>
</blockquote>
<p><div style="width:100%;height:1px;background-color:pink;opacity:.7"></div><br><a id="more"></a></p>
<h2 id="pandasæ•°æ®å¸§DataFrameåˆ—æ“ä½œ"><a href="#pandasæ•°æ®å¸§DataFrameåˆ—æ“ä½œ" class="headerlink" title="pandasæ•°æ®å¸§DataFrameåˆ—æ“ä½œ"></a>pandasæ•°æ®å¸§DataFrameåˆ—æ“ä½œ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#åˆ›å»ºæ•°æ®å¸§</span><br><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">data = &#123;&quot;name&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;zhan&quot;, &quot;ren&quot;, &quot;dao&quot;], &quot;age&quot;:[18, 20, 16, 34, 25]&#125;</span><br><span class="line">df = pd.DataFrame(data, index=[&quot;rank1&quot;, &quot;rank2&quot;, &quot;rank3&quot;, &quot;rank4&quot;, &quot;rank5&quot;])</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">       name  age</span><br><span class="line">rank1   sun   18</span><br><span class="line">rank2   liu   20</span><br><span class="line">rank3  zhan   16</span><br><span class="line">rank4   ren   34</span><br><span class="line">rank5   dao   25</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># åˆ—è·å–</span><br><span class="line">df[&apos;name&apos;] æˆ–df.name æˆ–df.get(&apos;name&apos;) </span><br><span class="line">#åªæœ‰getæ–¹æ³•æ‰¾ä¸åˆ°ä¸æŠ¥é”™ï¼Œè¿”å›none</span><br><span class="line"></span><br><span class="line">rank1     sun</span><br><span class="line">rank2     liu</span><br><span class="line">rank3    zhan</span><br><span class="line">rank4     ren</span><br><span class="line">rank5     dao</span><br><span class="line">Name: name, dtype: object</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># åˆ—å¢åŠ æˆ–ä¿®æ”¹</span><br><span class="line">df[&apos;sex&apos;]=[&apos;ç”·&apos;,&apos;å¥³&apos;,&apos;ç”·&apos;,&apos;å¥³&apos;,&apos;ç”·&apos;]</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">name	age	sex</span><br><span class="line">rank1	sun	18	ç”·</span><br><span class="line">rank2	liu	20	å¥³</span><br><span class="line">rank3	zhan16	ç”·</span><br><span class="line">rank4	ren	34	å¥³</span><br><span class="line">rank5	dao	25	ç”·</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># åˆ—åˆ é™¤</span><br><span class="line">del df[&apos;age&apos;]</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">	name	 sex</span><br><span class="line">rank1	sun	ç”·</span><br><span class="line">rank2	liu	å¥³</span><br><span class="line">rank3	zhanç”·</span><br><span class="line">rank4	ren	å¥³</span><br><span class="line">rank5	dao	ç”·</span><br></pre></td></tr></table></figure>
<h2 id="pandasæ•°æ®å¸§DataFrameè¡Œæ“ä½œ"><a href="#pandasæ•°æ®å¸§DataFrameè¡Œæ“ä½œ" class="headerlink" title="pandasæ•°æ®å¸§DataFrameè¡Œæ“ä½œ"></a>pandasæ•°æ®å¸§DataFrameè¡Œæ“ä½œ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># è¡Œé€‰æ‹© æŒ‰éæ•°å­—indexå€¼(è‡ªå®šä¹‰éæ•°å­—çš„index)</span><br><span class="line">data = &#123;&quot;name&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;, &quot;ren&quot;, &quot;dao&quot;], &quot;age&quot;:[18, 20, 16, 34, 25]&#125;</span><br><span class="line">df=pd.DataFrame(data,index=[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;])</span><br><span class="line">print(df)</span><br><span class="line">df.loc[&apos;b&apos;]</span><br><span class="line"></span><br><span class="line"> name  age</span><br><span class="line">a  sun   18</span><br><span class="line">b  liu   20</span><br><span class="line">c  hao   16</span><br><span class="line">d  ren   34</span><br><span class="line">e  dao   25</span><br><span class="line"></span><br><span class="line">name    liu</span><br><span class="line">age      20</span><br><span class="line">Name: b, dtype: object</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># è¡Œé€‰æ‹© æŒ‰æ•°å­—indexå€¼</span><br><span class="line">data = &#123;&quot;name&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;, &quot;ren&quot;, &quot;dao&quot;], &quot;age&quot;:[18, 20, 16, 34, 25]&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">df.iloc[2]</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">0  sun   18</span><br><span class="line">1  liu   20</span><br><span class="line">2  hao   16</span><br><span class="line">3  ren   34</span><br><span class="line">4  dao   25</span><br><span class="line"></span><br><span class="line">name    hao</span><br><span class="line">age      16</span><br><span class="line">Name: 2, dtype: object</span><br><span class="line"></span><br><span class="line">#å¯ä»¥ä½¿ç”¨åˆ‡ç‰‡æ“ä½œ`:`è¿ç®—ç¬¦é€‰æ‹©å¤šè¡Œ</span><br><span class="line">#locå’Œilocçš„ç¬¬äºŒä¸ªå‚æ•°éƒ½è¡¨ç¤ºåˆ—é€‰æ‹©ï¼Œä¸å†™å’Œå†™ä¸€ä¸ªå†’å·éƒ½è¡¨ç¤ºæ‰€æœ‰åˆ—</span><br><span class="line">#å‚æ•°ä¹‹é—´é€—å·éš”å¼€</span><br><span class="line">df.iloc[2:4]</span><br><span class="line"></span><br><span class="line">	name	age</span><br><span class="line">2	hao	16</span><br><span class="line">3	ren	34</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># è¡Œä¿®æ”¹</span><br><span class="line">data = &#123;&quot;name&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;, &quot;ren&quot;, &quot;dao&quot;], &quot;age&quot;:[18, 20, 16, 34, 25]&#125;</span><br><span class="line">df=pd.DataFrame(data,index=[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;])</span><br><span class="line">df.loc[&apos;b&apos;]=&#123;&apos;shu&apos;,22&#125;</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">	name age</span><br><span class="line">a	sun	18</span><br><span class="line">b	shu	22</span><br><span class="line">c	hao	16</span><br><span class="line">d	ren	34</span><br><span class="line">e	dao	25</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># è¡Œæ·»åŠ append</span><br><span class="line"># è¡Œæ·»åŠ </span><br><span class="line">df2=pd.DataFrame([[&apos;lul&apos;,17],[&apos;yun&apos;,19]],index=[&apos;f&apos;,&apos;g&apos;],columns=[&apos;name&apos;,&apos;age&apos;])</span><br><span class="line">df=df.append(df2)</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">name	age</span><br><span class="line">a	sun	18</span><br><span class="line">b	lu	23</span><br><span class="line">c	hao	16</span><br><span class="line">d	ren	34</span><br><span class="line">e	dao	25</span><br><span class="line">f	lul	17</span><br><span class="line">g	yun	19</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#è¡Œåˆ é™¤</span><br><span class="line">df3=df[:3]</span><br><span class="line">print(df3)</span><br><span class="line">  name  age</span><br><span class="line">a  sun   18</span><br><span class="line">b   lu   23</span><br><span class="line">c  hao   16</span><br><span class="line"></span><br><span class="line">df4=df3.drop(&apos;b&apos;) </span><br><span class="line">print(df4)</span><br><span class="line">  name  age</span><br><span class="line">a  sun   18</span><br><span class="line">c  hao   16</span><br></pre></td></tr></table></figure>
<h2 id="æŸ¥çœ‹å¤´å°¾"><a href="#æŸ¥çœ‹å¤´å°¾" class="headerlink" title="æŸ¥çœ‹å¤´å°¾"></a>æŸ¥çœ‹å¤´å°¾</h2><ul>
<li>ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¿«é€Ÿæµè§ˆæ•°æ®ç»“æ„ï¼Œå¯ä»¥ä¼ æ•°å­—å‚æ•°ï¼Œè¡¨ç¤ºè·å–å‡ æ¡æ•°æ®</li>
<li>df.head()</li>
<li>df.tail()</li>
</ul>
<h2 id="é‡å»ºç´¢å¼•reindex"><a href="#é‡å»ºç´¢å¼•reindex" class="headerlink" title="é‡å»ºç´¢å¼•reindex"></a>é‡å»ºç´¢å¼•reindex</h2><ul>
<li>å…¶ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªé€‚åº”æ–°ç´¢å¼•çš„æ–°å¯¹è±¡</li>
<li>å‚æ•°indexè¡Œç´¢å¼•</li>
<li>å‚æ•°columnsåˆ—ç´¢å¼•</li>
<li>indexå’Œcolumnså¿…é¡»æ˜¯åŸç´¢å¼•çš„å­é›†</li>
<li>copy=true</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">df=pd.DataFrame([[&apos;lul&apos;,17],[&apos;yun&apos;,19]],columns=[&apos;name&apos;,&apos;age&apos;])</span><br><span class="line">print(df)</span><br><span class="line">df2=df.reindex(index=[1],columns=[&apos;name&apos;,&apos;age&apos;])</span><br><span class="line">print(&apos;df2:&apos;)</span><br><span class="line">print(df2)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">0  lul   17</span><br><span class="line">1  yun   19</span><br><span class="line"></span><br><span class="line">df2:</span><br><span class="line">  name  age</span><br><span class="line">1  yun   19</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">0  lul   17</span><br><span class="line">1  yun   19</span><br></pre></td></tr></table></figure>
<h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#æŒ‰è¡Œç´¢å¼•æ’åº</span><br><span class="line"></span><br><span class="line">data = &#123;&quot;name&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;, &quot;ren&quot;, &quot;dao&quot;], &quot;age&quot;:[18, 20, 16, 34, 25]&#125;</span><br><span class="line">df=pd.DataFrame(data,index=[3,2,4,0,1])</span><br><span class="line">print(df)</span><br><span class="line">df2=df.sort_index() #æŒ‰è¡Œç´¢å¼•æ’åº</span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">3  sun   18</span><br><span class="line">2  liu   20</span><br><span class="line">4  hao   16</span><br><span class="line">0  ren   34</span><br><span class="line">1  dao   25</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">0  ren   34</span><br><span class="line">1  dao   25</span><br><span class="line">2  liu   20</span><br><span class="line">3  sun   18</span><br><span class="line">4  hao   16</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#å‡é™åºå¯é€‰ascendingå‚æ•°</span><br><span class="line">df3=df.sort_index(ascending=False) #é™åº</span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">4  hao   16</span><br><span class="line">3  sun   18</span><br><span class="line">2  liu   20</span><br><span class="line">1  dao   25</span><br><span class="line">0  ren   34</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#æŒ‰åˆ—ç´¢å¼•æ’åº</span><br><span class="line">data = &#123;&quot;col2&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;], &quot;col3&quot;:[18, 20, 16],&quot;col1&quot;:[&apos;sd&apos;,&apos;dd&apos;,8]&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">df2=df.sort_index(axis=1) #æŒ‰åˆ—ç´¢å¼•æ’åº</span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line">  col2  col3 col1</span><br><span class="line">0  sun    18   sd</span><br><span class="line">1  liu    20   dd</span><br><span class="line">2  hao    16    8</span><br><span class="line"></span><br><span class="line">  col1 col2  col3</span><br><span class="line">0   sd  sun    18</span><br><span class="line">1   dd  liu    20</span><br><span class="line">2    8  hao    16</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># æŒ‰æŸåˆ—çš„å€¼æ’åº</span><br><span class="line">data = &#123;&quot;col2&quot;: [&quot;sun&quot;, &quot;liu&quot;, &quot;hao&quot;], &quot;col3&quot;:[18, 20, 16],&quot;col1&quot;:[&apos;sd&apos;,&apos;dd&apos;,8]&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">df2=df.sort_values(by=&apos;col3&apos;) #å¯¹col3åˆ—çš„å€¼æ’åº</span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line">  col2  col3 col1</span><br><span class="line">0  sun    18   sd</span><br><span class="line">1  liu    20   dd</span><br><span class="line">2  hao    16    8</span><br><span class="line"></span><br><span class="line">  col2  col3 col1</span><br><span class="line">2  hao    16    8</span><br><span class="line">0  sun    18   sd</span><br><span class="line">1  liu    20   dd</span><br></pre></td></tr></table></figure>
<h2 id="å±‚æ¬¡åŒ–ç´¢å¼•"><a href="#å±‚æ¬¡åŒ–ç´¢å¼•" class="headerlink" title="å±‚æ¬¡åŒ–ç´¢å¼•"></a>å±‚æ¬¡åŒ–ç´¢å¼•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#å±‚æ¬¡åŒ–è¡Œç´¢å¼•</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#å±‚æ¬¡åŒ–åˆ—ç´¢å¼•</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#è¡Œåˆ—åŒæ—¶å±‚æ¬¡åŒ–ç´¢å¼•</span><br><span class="line">mindex1 = pd.MultiIndex.from_product([list(&quot;ABC&quot;),[&apos;æœŸä¸­&apos;,&apos;æœŸæœ«&apos;]])</span><br><span class="line">mindex2=pd.MultiIndex.from_product([[&apos;Python&apos;,&apos;Java&apos;, &apos;C++&apos;],[&apos;å»å¹´&apos;,&apos;ä»Šå¹´&apos;]])</span><br><span class="line">socre = np.random.randint(0,150,(6,6))</span><br><span class="line">df = pd.DataFrame(data = socre,index = mindex1,columns = mindex2)</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">       Python	   Java	    C++</span><br><span class="line">      å»å¹´ ä»Šå¹´	å»å¹´ ä»Šå¹´	å»å¹´ ä»Šå¹´</span><br><span class="line">A	æœŸä¸­ 133  107	66	 67	  52	143</span><br><span class="line">  æœŸæœ«  44	 93	59	  3 	55	46</span><br><span class="line">B	æœŸä¸­ 148	 14	123	 136 102	69</span><br><span class="line">  æœŸæœ«  13   97	67	 85	 118	68</span><br><span class="line">C	æœŸä¸­ 139	  0	135	 107	32	64</span><br><span class="line">  æœŸæœ«  51	144	138	 62	  68	35</span><br></pre></td></tr></table></figure>
<h2 id="å±‚æ¬¡åŒ–ç´¢å¼•é€‰æ‹©"><a href="#å±‚æ¬¡åŒ–ç´¢å¼•é€‰æ‹©" class="headerlink" title="å±‚æ¬¡åŒ–ç´¢å¼•é€‰æ‹©"></a>å±‚æ¬¡åŒ–ç´¢å¼•é€‰æ‹©</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#å±‚æ¬¡åŒ–ç´¢å¼•é€‰æ‹©</span><br><span class="line">df[[&apos;Java&apos;,&apos;C++&apos;]]</span><br><span class="line"></span><br><span class="line">		Java	C++</span><br><span class="line">å»å¹´	ä»Šå¹´	å»å¹´	ä»Šå¹´</span><br><span class="line">A	æœŸä¸­	45	26	79	89</span><br><span class="line">æœŸæœ«	130	113	122	42</span><br><span class="line">B	æœŸä¸­	79	44	45	8</span><br><span class="line">æœŸæœ«	116	125	23	31</span><br><span class="line">C	æœŸä¸­	148	141	117	99</span><br><span class="line">æœŸæœ«	27	50	102	23</span><br><span class="line"></span><br><span class="line">df[&apos;Java&apos;][&apos;ä»Šå¹´&apos;]</span><br><span class="line"></span><br><span class="line">A  æœŸä¸­     26</span><br><span class="line">   æœŸæœ«    113</span><br><span class="line">B  æœŸä¸­     44</span><br><span class="line">   æœŸæœ«    125</span><br><span class="line">C  æœŸä¸­    141</span><br><span class="line">   æœŸæœ«     50</span><br><span class="line">Name: ä»Šå¹´, dtype: int32</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df.loc[&apos;A&apos;]</span><br><span class="line"></span><br><span class="line">	   Python	    Java	   C++</span><br><span class="line">    å»å¹´	ä»Šå¹´	å»å¹´	ä»Šå¹´	å»å¹´	ä»Šå¹´</span><br><span class="line">æœŸä¸­	125	  142	 45	 26  	79	   89</span><br><span class="line">æœŸæœ«	108	  108	 130	113	122	  42</span><br></pre></td></tr></table></figure>
<h2 id="å±‚æ¬¡åŒ–è¡Œç´¢å¼•è¡Œåˆ—è½¬ç½®"><a href="#å±‚æ¬¡åŒ–è¡Œç´¢å¼•è¡Œåˆ—è½¬ç½®" class="headerlink" title="å±‚æ¬¡åŒ–è¡Œç´¢å¼•è¡Œåˆ—è½¬ç½®"></a>å±‚æ¬¡åŒ–è¡Œç´¢å¼•è¡Œåˆ—è½¬ç½®</h2><ul>
<li>stack()å°†åˆ—ç´¢å¼•å˜ä¸ºè¡Œç´¢å¼•</li>
<li>unstack()å°†è¡Œç´¢å¼•å˜ä¸ºåˆ—ç´¢å¼•</li>
<li>levelå‚æ•°ï¼šlevel=0å¯¹ä¸€çº§ç´¢å¼•æ“ä½œï¼Œ=1å¯¹äºŒçº§ç´¢å¼•æ“ä½œ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mindex1 = pd.MultiIndex.from_product([list(&quot;ABC&quot;),[&apos;æœŸä¸­&apos;,&apos;æœŸæœ«&apos;]])</span><br><span class="line">mindex2=pd.MultiIndex.from_product([[&apos;Python&apos;,&apos;Java&apos;, &apos;C++&apos;],[&apos;å»å¹´&apos;,&apos;ä»Šå¹´&apos;]])</span><br><span class="line">socre = np.random.randint(0,150,(6,6))</span><br><span class="line">df = pd.DataFrame(data = socre,index = mindex1,columns = mindex2)</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">       Python	   Java	    C++</span><br><span class="line">      å»å¹´ ä»Šå¹´	å»å¹´ ä»Šå¹´	å»å¹´ ä»Šå¹´</span><br><span class="line">A	æœŸä¸­ 133  107	66	 67	  52	143</span><br><span class="line">  æœŸæœ«  44	 93	59	  3 	55	46</span><br><span class="line">B	æœŸä¸­ 148	 14	123	 136 102	69</span><br><span class="line">  æœŸæœ«  13   97	67	 85	 118	68</span><br><span class="line">C	æœŸä¸­ 139	  0	135	 107	32	64</span><br><span class="line">  æœŸæœ«  51	144	138	 62	  68	35</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#ä¸€çº§åˆ—ç´¢å¼•å˜ä¸ºæœ€å°çº§è¡Œç´¢å¼•</span><br><span class="line"></span><br><span class="line">df.stack(level=0) </span><br><span class="line"></span><br><span class="line">          ä»Šå¹´	å»å¹´</span><br><span class="line">A	æœŸä¸­	C++	90	18</span><br><span class="line">      Java	6	  1</span><br><span class="line">    Python	61	34</span><br><span class="line">  æœŸæœ«	C++	84	78</span><br><span class="line">      Java	95	105</span><br><span class="line">    Python	113	132</span><br><span class="line">B	æœŸä¸­  C++	146	80</span><br><span class="line">      Java	114	139</span><br><span class="line">    Python	42	104</span><br><span class="line">  æœŸæœ« C++	142	113</span><br><span class="line">      Java	118	59</span><br><span class="line">    Python	95	85</span><br><span class="line">C	æœŸä¸­	C++	80	20</span><br><span class="line">      Java	126	118</span><br><span class="line">    Python	125	99</span><br><span class="line">  æœŸæœ« C++	51	43</span><br><span class="line">      Java	97	84</span><br><span class="line">    Python	29	16</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#äºŒçº§åˆ—ç´¢å¼•å˜ä¸ºæœ€å°çº§è¡Œç´¢å¼•</span><br><span class="line"></span><br><span class="line">df.stack(level=1) </span><br><span class="line"></span><br><span class="line">			      C++	Java	Python</span><br><span class="line">A	æœŸä¸­	ä»Šå¹´	90	6	    61</span><br><span class="line">        å»å¹´	18	1	    34</span><br><span class="line">  æœŸæœ«	ä»Šå¹´	84	95	  113</span><br><span class="line">        å»å¹´	78	105	  132</span><br><span class="line">B	æœŸä¸­	ä»Šå¹´	146	114	  42</span><br><span class="line">        å»å¹´	80	139	  104</span><br><span class="line">  æœŸæœ«	ä»Šå¹´	142	118	  95</span><br><span class="line">        å»å¹´	113	59	  85</span><br><span class="line">C	æœŸä¸­	ä»Šå¹´	80	126	  125</span><br><span class="line">        å»å¹´	20	118	  99</span><br><span class="line">  æœŸæœ«	ä»Šå¹´	51	97	  29</span><br><span class="line">        å»å¹´	43	84	  16</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#ä¸€çº§è¡Œç´¢å¼•å˜ä¸ºæœ€å°çº§åˆ—ç´¢å¼•</span><br><span class="line">df.unstack(level=0)</span><br><span class="line"></span><br><span class="line">	      Python	                   Java	                    C++</span><br><span class="line">        å»å¹´	        ä»Šå¹´	     å»å¹´	     ä»Šå¹´	        å»å¹´	      ä»Šå¹´</span><br><span class="line">      A	  B	  C	  A	  B	 C	 A	B	  C	  A 	B	  C	 A	 B	 C	 A	 B	 C</span><br><span class="line">æœŸä¸­	34	104	99	61	42 125	1	139	118	6	114	 126	18	80	20	90	146	80</span><br><span class="line">æœŸæœ«	132	85	16	113	95 29	 105 59	84	95 118 97	 78	 113	43	84	142	51</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#äºŒçº§è¡Œç´¢å¼•å˜ä¸ºæœ€å°çº§åˆ—ç´¢å¼•</span><br><span class="line">df.unstack(level=1)</span><br><span class="line"></span><br><span class="line">  Python	                  Java                  	C++</span><br><span class="line">  å»å¹´	        ä»Šå¹´	      å»å¹´	      ä»Šå¹´	    å»å¹´	      ä»Šå¹´</span><br><span class="line">  æœŸä¸­	æœŸæœ«	æœŸä¸­	æœŸæœ«	æœŸä¸­	æœŸæœ«	æœŸä¸­	æœŸæœ«	æœŸä¸­	æœŸæœ«	æœŸä¸­	æœŸæœ«</span><br><span class="line">A	34	  132	  61	  113	  1	  105	  6	    95	  18	 78	   90	  84</span><br><span class="line">B	104	   85	  42	  95	139   	59	114	  118	  80	 113	146	  142</span><br><span class="line">C	99	   16	  125	  29	118	   84	  126	   97	  20	 43	   80	  51</span><br></pre></td></tr></table></figure>
<h2 id="æ—¥æœŸä¸æ—¶é—´"><a href="#æ—¥æœŸä¸æ—¶é—´" class="headerlink" title="æ—¥æœŸä¸æ—¶é—´"></a>æ—¥æœŸä¸æ—¶é—´</h2><ul>
<li>pandasæ¨¡å—ä¸‹çš„datetimeæ¨¡å—åœ¨å°†æ¥çš„ç‰ˆæœ¬ä¸­ä¼šè¢«å¼ƒç”¨</li>
<li>å»ºè®®ç›´æ¥å¼•å…¥datetimeæ¨¡å—ä½¿ç”¨</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">from datetime import datetime</span><br></pre></td></tr></table></figure>
<h3 id="è·å–æ—¥æœŸã€æ—¶é—´å’Œæ—¶é—´æˆ³"><a href="#è·å–æ—¥æœŸã€æ—¶é—´å’Œæ—¶é—´æˆ³" class="headerlink" title="è·å–æ—¥æœŸã€æ—¶é—´å’Œæ—¶é—´æˆ³"></a>è·å–æ—¥æœŸã€æ—¶é—´å’Œæ—¶é—´æˆ³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(datetime.now())</span><br><span class="line">print(datetime.now().date())</span><br><span class="line">print(datetime.now().time())</span><br><span class="line">print(datetime.now().timestamp())</span><br><span class="line"></span><br><span class="line">2021-04-12 14:11:17.790021</span><br><span class="line">2021-04-12</span><br><span class="line">14:11:17.791025</span><br><span class="line">1618207877.791025</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">print(datetime.today())</span><br><span class="line">print(datetime.today().date())</span><br><span class="line">print(datetime.today().time())</span><br><span class="line">print(datetime.today().timestamp())</span><br><span class="line"></span><br><span class="line">2021-04-12 14:35:16.016302</span><br><span class="line">2021-04-12</span><br><span class="line">14:35:16.016302</span><br><span class="line">1618209316.016302</span><br><span class="line"></span><br><span class="line">pd.datetime.now()</span><br><span class="line">2021-04-12 14:35:16.017273</span><br></pre></td></tr></table></figure>
<h3 id="å­—ç¬¦ä¸²è½¬ä¸ºæ—¥æœŸæ—¶é—´"><a href="#å­—ç¬¦ä¸²è½¬ä¸ºæ—¥æœŸæ—¶é—´" class="headerlink" title="å­—ç¬¦ä¸²è½¬ä¸ºæ—¥æœŸæ—¶é—´"></a>å­—ç¬¦ä¸²è½¬ä¸ºæ—¥æœŸæ—¶é—´</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">d=&apos;2021-5-1&apos;</span><br><span class="line">d1=[&apos;2021-1-1&apos;,&apos;2021-2-8&apos;,&apos;2021-3-2&apos;]</span><br><span class="line">d2=[&apos;2021-1-1&apos;,&apos;shulu&apos;,&apos;2021-3-2&apos;]</span><br><span class="line">print(pd.to_datetime(d))</span><br><span class="line">print(pd.to_datetime(d1))</span><br><span class="line">print(pd.to_datetime(d2,errors=&apos;ignore&apos;))</span><br><span class="line">print(pd.to_datetime(d2,errors=&apos;coerce&apos;))</span><br><span class="line"></span><br><span class="line">print(pd.Timestamp(d))</span><br><span class="line"></span><br><span class="line">2021-05-01 00:00:00</span><br><span class="line">DatetimeIndex([&apos;2021-01-01&apos;, &apos;2021-02-08&apos;, &apos;2021-03-02&apos;], dtype=&apos;datetime64[ns]&apos;, freq=None)</span><br><span class="line">Index([&apos;2021-1-1&apos;, &apos;shulu&apos;, &apos;2021-3-2&apos;], dtype=&apos;object&apos;)</span><br><span class="line">DatetimeIndex([&apos;2021-01-01&apos;, &apos;NaT&apos;, &apos;2021-03-02&apos;], dtype=&apos;datetime64[ns]&apos;, freq=None)</span><br><span class="line">2021-05-01 00:00:00</span><br><span class="line">#NaTè¡¨ç¤ºä¸æ˜¯ä¸€ä¸ªæ—¶é—´çš„å€¼(ç›¸å½“äºNaN)</span><br></pre></td></tr></table></figure>
<h3 id="æ—¶é—´å·®"><a href="#æ—¶é—´å·®" class="headerlink" title="æ—¶é—´å·®"></a>æ—¶é—´å·®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">past=datetime(2017, 4, 16, 21, 21, 20, 871000)</span><br><span class="line">now=datetime.now()</span><br><span class="line">delta=now-past</span><br><span class="line">print(delta) </span><br><span class="line">print(delta.days)</span><br><span class="line"></span><br><span class="line">1456 days, 17:30:33.216922</span><br><span class="line">1456</span><br><span class="line"></span><br><span class="line">print(pd.Timedelta(now - past))</span><br><span class="line">1456 days 17:30:33.216922</span><br></pre></td></tr></table></figure>
<h3 id="æ—¶é—´æˆ³ç´¢å¼•DatetimeIndexçš„å¿«é€Ÿåˆ›å»º"><a href="#æ—¶é—´æˆ³ç´¢å¼•DatetimeIndexçš„å¿«é€Ÿåˆ›å»º" class="headerlink" title="æ—¶é—´æˆ³ç´¢å¼•DatetimeIndexçš„å¿«é€Ÿåˆ›å»º"></a>æ—¶é—´æˆ³ç´¢å¼•DatetimeIndexçš„å¿«é€Ÿåˆ›å»º</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(pd.date_range(start=&apos;2021-5-1&apos;,end=&apos;2021-5-3&apos;))</span><br><span class="line">print(pd.date_range(start=&apos;2021-6-15&apos;,end=&apos;2021-8-6&apos;,freq=&apos;M&apos;))</span><br><span class="line">print(pd.date_range(start=&apos;2021-5-1&apos;,periods=3))</span><br><span class="line">print(pd.date_range(end=&apos;2021-5-1&apos;,periods=3))</span><br><span class="line"></span><br><span class="line">DatetimeIndex([&apos;2021-05-01&apos;, &apos;2021-05-02&apos;, &apos;2021-05-03&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)</span><br><span class="line">DatetimeIndex([&apos;2021-06-30&apos;, &apos;2021-07-31&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;M&apos;)</span><br><span class="line">DatetimeIndex([&apos;2021-05-01&apos;, &apos;2021-05-02&apos;, &apos;2021-05-03&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)</span><br><span class="line">DatetimeIndex([&apos;2021-04-29&apos;, &apos;2021-04-30&apos;, &apos;2021-05-01&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)</span><br></pre></td></tr></table></figure>
<h2 id="é‡é‡‡æ ·"><a href="#é‡é‡‡æ ·" class="headerlink" title="é‡é‡‡æ ·"></a>é‡é‡‡æ ·</h2><ul>
<li>é‡æ–°é‡‡æ ·ï¼Œæ˜¯å¯¹åŸæ ·æœ¬é‡æ–°å¤„ç†çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæ˜¯ä¸€ä¸ªå¯¹å¸¸è§„æ—¶é—´åºåˆ—æ•°æ®é‡æ–°é‡‡æ ·å’Œé¢‘ç‡è½¬æ¢çš„ä¾¿æ·çš„æ–¹æ³•ã€‚</li>
<li>é™é‡‡æ ·ï¼šé«˜é¢‘æ•°æ®åˆ°ä½é¢‘æ•°æ®</li>
<li>å‡é‡‡æ ·ï¼šä½é¢‘æ•°æ®åˆ°é«˜é¢‘æ•°æ®</li>
</ul>
<h3 id="é™é‡‡æ ·"><a href="#é™é‡‡æ ·" class="headerlink" title="é™é‡‡æ ·"></a>é™é‡‡æ ·</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">index = pd.date_range(&apos;1/1/2021&apos;, periods=9, freq=&apos;D&apos;)</span><br><span class="line">series = pd.Series(range(9), index=index)</span><br><span class="line">print(series)</span><br><span class="line"></span><br><span class="line">2021-01-01    0</span><br><span class="line">2021-01-02    1</span><br><span class="line">2021-01-03    2</span><br><span class="line">2021-01-04    3</span><br><span class="line">2021-01-05    4</span><br><span class="line">2021-01-06    5</span><br><span class="line">2021-01-07    6</span><br><span class="line">2021-01-08    7</span><br><span class="line">2021-01-09    8</span><br><span class="line">Freq: D, dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#é»˜è®¤ï¼šclosed=left, label=left</span><br><span class="line">print(series.resample(&apos;3D&apos;)) #DatetimeIndexResampler å¾—åˆ°è¿™ä¸ªé‡é‡‡æ ·æ„å»ºå™¨</span><br><span class="line">DatetimeIndexResampler [freq=&lt;3 * Days&gt;, axis=0, closed=left, label=left, convention=start, origin=start_day]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(series.resample(&apos;3D&apos;).sum()) #é€šè¿‡èšåˆæ–¹æ³•å¯ä»¥å±•ç°å‡ºæ¥</span><br><span class="line">2021-01-01     3</span><br><span class="line">2021-01-04    12</span><br><span class="line">2021-01-07    21</span><br><span class="line">Freq: 3D, dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(series.resample(&apos;3D&apos;,label=&apos;right&apos;).sum())</span><br><span class="line">2021-01-04     3</span><br><span class="line">2021-01-07    12</span><br><span class="line">2021-01-10    21</span><br><span class="line">Freq: 3D, dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print(series.resample(&apos;3D&apos;,closed=&apos;right&apos;).sum())</span><br><span class="line">2020-12-29     0</span><br><span class="line">2021-01-01     6</span><br><span class="line">2021-01-04    15</span><br><span class="line">2021-01-07    15</span><br><span class="line">Freq: 3D, dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print(series.resample(&apos;3D&apos;,label=&apos;right&apos;,closed=&apos;right&apos;).sum())</span><br><span class="line">2021-01-01     0</span><br><span class="line">2021-01-04     6</span><br><span class="line">2021-01-07    15</span><br><span class="line">2021-01-10    15</span><br><span class="line">Freq: 3D, dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="å¢é‡‡æ ·"><a href="#å¢é‡‡æ ·" class="headerlink" title="å¢é‡‡æ ·"></a>å¢é‡‡æ ·</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">index = pd.date_range(&apos;1/1/2000&apos;, periods=9, freq=&apos;T&apos;)</span><br><span class="line">series = pd.Series(range(9), index=index)</span><br><span class="line">series</span><br><span class="line"></span><br><span class="line">2000-01-01 00:00:00    0</span><br><span class="line">2000-01-01 00:01:00    1</span><br><span class="line">2000-01-01 00:02:00    2</span><br><span class="line">2000-01-01 00:03:00    3</span><br><span class="line">2000-01-01 00:04:00    4</span><br><span class="line">2000-01-01 00:05:00    5</span><br><span class="line">2000-01-01 00:06:00    6</span><br><span class="line">2000-01-01 00:07:00    7</span><br><span class="line">2000-01-01 00:08:00    8</span><br><span class="line">Freq: T, dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">series.resample(&apos;30S&apos;)</span><br><span class="line">&lt;pandas.core.resample.DatetimeIndexResampler object at 0x000002B91F375CA0&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">series.resample(&apos;30S&apos;).asfreq().head() #æ–°ç´¢å¼•æ²¡æœ‰å€¼ï¼Œä¸ºnan</span><br><span class="line"></span><br><span class="line">2000-01-01 00:00:00    0.0</span><br><span class="line">2000-01-01 00:00:30    NaN</span><br><span class="line">2000-01-01 00:01:00    1.0</span><br><span class="line">2000-01-01 00:01:30    NaN</span><br><span class="line">2000-01-01 00:02:00    2.0</span><br><span class="line">Freq: 30S, dtype: float64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">series.resample(&apos;30S&apos;).asfreq().bfill().head(8) #ç”¨åé¢çš„ä¸€ä¸ªæ•°æ®å¡«å……nan</span><br><span class="line">2000-01-01 00:00:00    0.0</span><br><span class="line">2000-01-01 00:00:30    1.0</span><br><span class="line">2000-01-01 00:01:00    1.0</span><br><span class="line">2000-01-01 00:01:30    2.0</span><br><span class="line">2000-01-01 00:02:00    2.0</span><br><span class="line">2000-01-01 00:02:30    3.0</span><br><span class="line">2000-01-01 00:03:00    3.0</span><br><span class="line">2000-01-01 00:03:30    4.0</span><br><span class="line">Freq: 30S, dtype: float64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">series.resample(&apos;30S&apos;).asfreq().ffill().head(6) #ç”¨å‰é¢çš„ä¸€ä¸ªæ•°æ®å¡«å……nan</span><br><span class="line">2000-01-01 00:00:00    0.0</span><br><span class="line">2000-01-01 00:00:30    0.0</span><br><span class="line">2000-01-01 00:01:00    1.0</span><br><span class="line">2000-01-01 00:01:30    1.0</span><br><span class="line">2000-01-01 00:02:00    2.0</span><br><span class="line">2000-01-01 00:02:30    2.0</span><br><span class="line">Freq: 30S, dtype: float64</span><br></pre></td></tr></table></figure>
<h2 id="æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯å‡½æ•°"><a href="#æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯å‡½æ•°" class="headerlink" title="æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯å‡½æ•°"></a>æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯å‡½æ•°</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line"> &apos;Name&apos;:pd.Series([&apos;Tom&apos;,&apos;James&apos;,&apos;Ricky&apos;,&apos;Vin&apos;,&apos;Steve&apos;,&apos;Minsu&apos;,&apos;Jack&apos;,&apos;Lee&apos;,&apos;David&apos;]),</span><br><span class="line"> &apos;Age&apos;:pd.Series([25,np.nan,25,23,30,29,23,34,40]),</span><br><span class="line"> &apos;Rating&apos;:pd.Series([4.23,3.24,np.nan,2.56,3.20,4.6,3.8,np.nan,2.98])</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">print(&quot;åŸæ•°æ®ï¼š&quot;)</span><br><span class="line">print(df)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">åŸæ•°æ®ï¼š</span><br><span class="line">    Name   Age  Rating</span><br><span class="line">0    Tom  25.0    4.23</span><br><span class="line">1  James   NaN    3.24</span><br><span class="line">2  Ricky  25.0     NaN</span><br><span class="line">3    Vin  23.0    2.56</span><br><span class="line">4  Steve  30.0    3.20</span><br><span class="line">5  Minsu  29.0    4.60</span><br><span class="line">6   Jack  23.0    3.80</span><br><span class="line">7    Lee  34.0     NaN</span><br><span class="line">8  David  40.0    2.98</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;count():éç©ºè§‚æµ‹æ•°é‡&quot;)</span><br><span class="line">print(df.count())</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">count():éç©ºè§‚æµ‹æ•°é‡</span><br><span class="line"></span><br><span class="line">Name      9</span><br><span class="line">Age       8</span><br><span class="line">Rating    7</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;sum():è¿”å›æ‰€è¯·æ±‚è½´çš„å€¼çš„æ€»å’Œã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè½´ä¸ºç´¢å¼•(axis=0)&quot;)</span><br><span class="line">print(df.sum())</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">Name      TomJamesRickyVinSteveMinsuJackLeeDavid</span><br><span class="line">Age                                          229</span><br><span class="line">Rating                                     24.61</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;sum():axis=1&quot;)</span><br><span class="line">print(df.sum(1))</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">0    29.23</span><br><span class="line">1     3.24</span><br><span class="line">2    25.00</span><br><span class="line">3    25.56</span><br><span class="line">4    33.20</span><br><span class="line">5    33.60</span><br><span class="line">6    26.80</span><br><span class="line">7    34.00</span><br><span class="line">8    42.98</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;cumsum()ç´¯è®¡æ€»å’Œ&apos;)</span><br><span class="line">print(df.cumsum())</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">                                     Name    Age  Rating</span><br><span class="line">0                                     Tom   25.0    4.23</span><br><span class="line">1                                TomJames    NaN    7.47</span><br><span class="line">2                           TomJamesRicky   50.0     NaN</span><br><span class="line">3                        TomJamesRickyVin   73.0   10.03</span><br><span class="line">4                   TomJamesRickyVinSteve  103.0   13.23</span><br><span class="line">5              TomJamesRickyVinSteveMinsu  132.0   17.83</span><br><span class="line">6          TomJamesRickyVinSteveMinsuJack  155.0   21.63</span><br><span class="line">7       TomJamesRickyVinSteveMinsuJackLee  189.0     NaN</span><br><span class="line">8  TomJamesRickyVinSteveMinsuJackLeeDavid  229.0   24.61</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;cumprod()ç´¯è®¡ä¹˜ç§¯&apos;)</span><br><span class="line">print(df[[&apos;Age&apos;,&apos;Rating&apos;]].cumprod())</span><br><span class="line"></span><br><span class="line">            Age       Rating</span><br><span class="line">0  2.500000e+01     4.230000</span><br><span class="line">1           NaN    13.705200</span><br><span class="line">2  6.250000e+02          NaN</span><br><span class="line">3  1.437500e+04    35.085312</span><br><span class="line">4  4.312500e+05   112.272998</span><br><span class="line">5  1.250625e+07   516.455793</span><br><span class="line">6  2.876438e+08  1962.532012</span><br><span class="line">7  9.779888e+09          NaN</span><br><span class="line">8  3.911955e+11  5848.345396</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#å”¯ä¸€å€¼ å»é‡</span><br><span class="line">s=pd.Series(list(&apos;asaddvfshu&apos;))</span><br><span class="line">print(s.value_counts()) #é‡å¤å€¼è®¡æ•°</span><br><span class="line">sq=s.unique() #å»é‡</span><br><span class="line">print(s) </span><br><span class="line">print(sq) #[&apos;a&apos; &apos;s&apos; &apos;d&apos; &apos;v&apos; &apos;f&apos; &apos;h&apos; &apos;u&apos;]</span><br><span class="line">print(pd.Series(sq)) #åŒ…è£…æˆSeries</span><br><span class="line"></span><br><span class="line">d    2</span><br><span class="line">a    2</span><br><span class="line">s    2</span><br><span class="line">v    1</span><br><span class="line">f    1</span><br><span class="line">h    1</span><br><span class="line">u    1</span><br><span class="line">dtype: int64</span><br><span class="line"></span><br><span class="line">0    a</span><br><span class="line">1    s</span><br><span class="line">2    a</span><br><span class="line">3    d</span><br><span class="line">4    d</span><br><span class="line">5    v</span><br><span class="line">6    f</span><br><span class="line">7    s</span><br><span class="line">8    h</span><br><span class="line">9    u</span><br><span class="line">dtype: object</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0    a</span><br><span class="line">1    s</span><br><span class="line">2    d</span><br><span class="line">3    v</span><br><span class="line">4    f</span><br><span class="line">5    h</span><br><span class="line">6    u</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">## æˆå‘˜èµ„æ ¼</span><br><span class="line">s=pd.Series(list([123]))</span><br><span class="line">s.isin([123,22])</span><br><span class="line"></span><br><span class="line">0    True</span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure>
<h2 id="pandasçš„å­—ç¬¦ä¸²æ“ä½œ"><a href="#pandasçš„å­—ç¬¦ä¸²æ“ä½œ" class="headerlink" title="pandasçš„å­—ç¬¦ä¸²æ“ä½œ"></a>pandasçš„å­—ç¬¦ä¸²æ“ä½œ</h2><ul>
<li>æŸä¸€åˆ—.str.contains(å­—ç¬¦) ç­›é€‰å‡ºå«æœ‰ç‰¹å®šå­—ç¬¦ä¸²çš„è¡Œ</li>
<li>æŸä¸€åˆ—.str.split(åˆ†å‰²å­—ç¬¦) åˆ†å‰²å­—ç¬¦ä¸²(åŠ å‚æ•°expand=Trueåˆ†å‰²åå˜ä¸¤åˆ—)</li>
<li>æŸä¸€åˆ—.str.replace(old,new)å­—ç¬¦ä¸²çš„æ›¿æ¢</li>
<li>æŸä¸€åˆ—.str.startswith() ä¸ endswith()å­—ç¬¦ä¸²ä¸¤ç«¯çš„å­—ç¬¦çš„åˆ¤æ–­ </li>
<li>æŸä¸€åˆ—.str.findall()æ­£åˆ™è¡¨è¾¾å¼ ä»¥æ•°ç»„å½¢å¼è¿”å› </li>
<li>æŸä¸€åˆ—.str.cat()æ‹¼æ¥å­—ç¬¦ä¸²</li>
<li>æŸä¸€åˆ—.str.extract() æŠ½å–åŒ¹é…çš„å­—ç¬¦ä¸²å‡ºæ¥ï¼Œæ³¨æ„è¦åŠ ä¸Šæ‹¬å·ï¼Œå¦‚extract(â€œ([d-z])â€)</li>
<li>æŸä¸€åˆ—.str.match() æ£€æµ‹æ˜¯å¦å…¨éƒ¨åŒ¹é…ç»™å®šç‚¹çš„å­—ç¬¦ä¸²æˆ–è€…è¡¨è¾¾å¼</li>
<li>æŸä¸€åˆ—.str.strip()å»é™¤ç‰¹å®šå­—ç¬¦(åŒ…æ‹¬lstripå’Œrstrip)</li>
<li>æŸä¸€åˆ—.str.get() è·å–æŒ‡å®šä½ç½®çš„å­—ç¬¦ä¸²</li>
<li>æŸä¸€åˆ—.str.pad() å·¦å³è¡¥é½</li>
<li>æŸä¸€åˆ—.str.len()len() è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦</li>
<li>æŸä¸€åˆ—.str.center() ä¸­é—´è¡¥é½</li>
<li>æŸä¸€åˆ—.str.ljust() å³è¾¹è¡¥é½ rjust() å·¦è¾¹è¡¥é½</li>
<li>æŸä¸€åˆ—.str.zfill() å·¦è¾¹è¡¥0</li>
<li>æŸä¸€åˆ—.str.lower() å…¨éƒ¨å°å†™ upper() å…¨éƒ¨å¤§å†™</li>
<li>æŸä¸€åˆ—.str.repeat() é‡å¤</li>
<li>æŸä¸€åˆ—.str.wrap() åœ¨æŒ‡å®šçš„ä½ç½®åŠ å›è½¦ç¬¦å·</li>
<li>æŸä¸€åˆ—.str.slice() æŒ‰ç»™ç‚¹çš„å¼€å§‹ç»“æŸä½ç½®åˆ‡å‰²å­—ç¬¦ä¸²</li>
<li>æŸä¸€åˆ—.str.slice_replace() ä½¿ç”¨ç»™å®šçš„å­—ç¬¦ä¸²ï¼Œæ›¿æ¢æŒ‡å®šçš„ä½ç½®çš„å­—ç¬¦</li>
<li>æŸä¸€åˆ—.str.count() è®¡ç®—ç»™å®šå•è¯å‡ºç°çš„æ¬¡æ•°</li>
<li>æŸä¸€åˆ—.str.strip() å»é™¤å‰åçš„ç©ºç™½å­—ç¬¦</li>
<li>æŸä¸€åˆ—.str.strip() lstrip() rstrip() å»é™¤å‰åçš„ç©ºç™½å­—ç¬¦</li>
<li>æŸä¸€åˆ—.str.find() ä»å·¦è¾¹å¼€å§‹ï¼ŒæŸ¥æ‰¾ç»™å®šå­—ç¬¦ä¸²çš„æ‰€åœ¨ä½ç½® rfind() ä»å³è¾¹å¼€å§‹</li>
<li>æŸä¸€åˆ—.str.index() æŸ¥æ‰¾ç»™å®šå­—ç¬¦ä¸²çš„ä½ç½®ï¼Œæ³¨æ„ï¼Œå¦‚æœä¸å­˜åœ¨è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆä¼šæŠ¥é”™</li>
<li>æŸä¸€åˆ—.str.capitalize() é¦–å­—ç¬¦å¤§å†™</li>
<li>æŸä¸€åˆ—.str.swapcase() å¤§å°å†™äº’æ¢</li>
<li>æŸä¸€åˆ—.str.isalnum() æ˜¯å¦å…¨éƒ¨æ˜¯æ•°å­—å’Œå­—æ¯ç»„æˆ</li>
<li>æŸä¸€åˆ—.str.isdecimal() æ˜¯å¦å…¨æ˜¯æ•°å­—</li>
<li>æŸä¸€åˆ—.str.isdigit() æ˜¯å¦å…¨éƒ¨éƒ½æ˜¯æ•°å­—</li>
<li>æŸä¸€åˆ—.str.istitle() æ˜¯å¦åªæœ‰é¦–å­—æ¯ä¸ºå¤§å†™ï¼Œå…¶ä»–å­—æ¯ä¸ºå°å†™</li>
<li>æŸä¸€åˆ—.str.isspace() æ˜¯å¦ç©ºæ ¼</li>
<li>æŸä¸€åˆ—.str.islower() æ˜¯å¦å…¨éƒ¨å°å†™</li>
<li>æŸä¸€åˆ—.str.isalpha() æ˜¯å¦å…¨éƒ¨æ˜¯å­—æ¯</li>
</ul>
<h2 id="åˆ—çš„åˆå¹¶merge-ä»¥æŸä¸ªé”®ä¸ºå‚è€ƒï¼Œé»˜è®¤how-â€™innerâ€™ä½¿ç”¨é”®çš„äº¤é›†"><a href="#åˆ—çš„åˆå¹¶merge-ä»¥æŸä¸ªé”®ä¸ºå‚è€ƒï¼Œé»˜è®¤how-â€™innerâ€™ä½¿ç”¨é”®çš„äº¤é›†" class="headerlink" title="åˆ—çš„åˆå¹¶merge,ä»¥æŸä¸ªé”®ä¸ºå‚è€ƒï¼Œé»˜è®¤how=â€™innerâ€™ä½¿ç”¨é”®çš„äº¤é›†"></a>åˆ—çš„åˆå¹¶merge,ä»¥æŸä¸ªé”®ä¸ºå‚è€ƒï¼Œé»˜è®¤how=â€™innerâ€™ä½¿ç”¨é”®çš„äº¤é›†</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">left = pd.DataFrame(&#123;</span><br><span class="line">         &apos;id&apos;:[1,2,3,4,5],</span><br><span class="line">         &apos;Name&apos;: [&apos;Alex&apos;, &apos;Amy&apos;, &apos;Allen&apos;, &apos;Alice&apos;, &apos;Ayoung&apos;],</span><br><span class="line">         &apos;subject_id&apos;:[&apos;sub1&apos;,&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">right = pd.DataFrame(</span><br><span class="line">         &#123;&apos;id&apos;:[1,2,3,4,5],</span><br><span class="line">         &apos;Name&apos;: [&apos;Billy&apos;, &apos;Brian&apos;, &apos;Bran&apos;, &apos;Bryce&apos;, &apos;Betty&apos;],</span><br><span class="line">         &apos;subject_id&apos;:[&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub3&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">print (left)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">print (right)</span><br><span class="line"></span><br><span class="line">   id    Name subject_id</span><br><span class="line">0   1    Alex       sub1</span><br><span class="line">1   2     Amy       sub2</span><br><span class="line">2   3   Allen       sub4</span><br><span class="line">3   4   Alice       sub6</span><br><span class="line">4   5  Ayoung       sub5</span><br><span class="line">========================================</span><br><span class="line">   id   Name subject_id</span><br><span class="line">0   1  Billy       sub2</span><br><span class="line">1   2  Brian       sub4</span><br><span class="line">2   3   Bran       sub3</span><br><span class="line">3   4  Bryce       sub6</span><br><span class="line">4   5  Betty       sub5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># åœ¨ä¸€ä¸ªé”®ä¸Šåˆå¹¶ä¸¤ä¸ªæ•°æ®å¸§</span><br><span class="line">mdf=pd.merge(left,right,on=&apos;id&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">   id  Name_x subject_id_x Name_y subject_id_y</span><br><span class="line">0   1    Alex         sub1  Billy         sub2</span><br><span class="line">1   2     Amy         sub2  Brian         sub4</span><br><span class="line">2   3   Allen         sub4   Bran         sub3</span><br><span class="line">3   4   Alice         sub6  Bryce         sub6</span><br><span class="line">4   5  Ayoung         sub5  Betty         sub5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># åˆå¹¶å¤šä¸ªé”®ä¸Šçš„ä¸¤ä¸ªæ•°æ®å¸§</span><br><span class="line">mdf=pd.merge(left,right,on=[&apos;id&apos;,&apos;subject_id&apos;])</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">   id  Name_x subject_id Name_y</span><br><span class="line">0   4   Alice       sub6  Bryce</span><br><span class="line">1   5  Ayoung       sub5  Betty</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨â€œhowâ€çš„å‚æ•°</span><br><span class="line"># leftä½¿ç”¨å·¦ä¾§å¯¹è±¡çš„é”®</span><br><span class="line"># rightä½¿ç”¨å³ä¾§å¯¹è±¡çš„é”®</span><br><span class="line"># outerä½¿ç”¨é”®çš„å¹¶é›†</span><br><span class="line"># innerä½¿ç”¨é”®çš„äº¤é›† é»˜è®¤inner</span><br><span class="line">mdf=pd.merge(left,right,on=&apos;subject_id&apos;,how=&apos;left&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">mdf=pd.merge(left,right,on=&apos;subject_id&apos;,how=&apos;right&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">mdf=pd.merge(left,right,on=&apos;subject_id&apos;,how=&apos;inner&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">mdf=pd.merge(left,right,on=&apos;subject_id&apos;,how=&apos;outer&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">   id_x  Name_x subject_id  id_y Name_y</span><br><span class="line">0     1    Alex       sub1   NaN    NaN</span><br><span class="line">1     2     Amy       sub2   1.0  Billy</span><br><span class="line">2     3   Allen       sub4   2.0  Brian</span><br><span class="line">3     4   Alice       sub6   4.0  Bryce</span><br><span class="line">4     5  Ayoung       sub5   5.0  Betty</span><br><span class="line">========================================</span><br><span class="line">   id_x  Name_x subject_id  id_y Name_y</span><br><span class="line">0   2.0     Amy       sub2     1  Billy</span><br><span class="line">1   3.0   Allen       sub4     2  Brian</span><br><span class="line">2   NaN     NaN       sub3     3   Bran</span><br><span class="line">3   4.0   Alice       sub6     4  Bryce</span><br><span class="line">4   5.0  Ayoung       sub5     5  Betty</span><br><span class="line">========================================</span><br><span class="line">   id_x  Name_x subject_id  id_y Name_y</span><br><span class="line">0     2     Amy       sub2     1  Billy</span><br><span class="line">1     3   Allen       sub4     2  Brian</span><br><span class="line">2     4   Alice       sub6     4  Bryce</span><br><span class="line">3     5  Ayoung       sub5     5  Betty</span><br><span class="line">========================================</span><br><span class="line">   id_x  Name_x subject_id  id_y Name_y</span><br><span class="line">0   1.0    Alex       sub1   NaN    NaN</span><br><span class="line">1   2.0     Amy       sub2   1.0  Billy</span><br><span class="line">2   3.0   Allen       sub4   2.0  Brian</span><br><span class="line">3   4.0   Alice       sub6   4.0  Bryce</span><br><span class="line">4   5.0  Ayoung       sub5   5.0  Betty</span><br><span class="line">5   NaN     NaN       sub3   3.0   Bran</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">left = pd.DataFrame(&#123;</span><br><span class="line">         &apos;id&apos;:[1,2,3,4,5],</span><br><span class="line">         &apos;Name&apos;: [&apos;Alex&apos;, &apos;Amy&apos;, &apos;Allen&apos;, &apos;Alice&apos;, &apos;Ayoung&apos;],</span><br><span class="line">         &apos;sub_l&apos;:[&apos;sub1&apos;,&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">right = pd.DataFrame(</span><br><span class="line">         &#123;&apos;id&apos;:[1,2,3,4,5],</span><br><span class="line">         &apos;Name&apos;: [&apos;Billy&apos;, &apos;Brian&apos;, &apos;Bran&apos;, &apos;Bryce&apos;, &apos;Betty&apos;],</span><br><span class="line">         &apos;sub_r&apos;:[&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub3&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">print (left)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">print (right)</span><br><span class="line"></span><br><span class="line">   id    Name sub_l</span><br><span class="line">0   1    Alex  sub1</span><br><span class="line">1   2     Amy  sub2</span><br><span class="line">2   3   Allen  sub4</span><br><span class="line">3   4   Alice  sub6</span><br><span class="line">4   5  Ayoung  sub5</span><br><span class="line">========================================</span><br><span class="line">   id   Name sub_r</span><br><span class="line">0   1  Billy  sub2</span><br><span class="line">1   2  Brian  sub4</span><br><span class="line">2   3   Bran  sub3</span><br><span class="line">3   4  Bryce  sub6</span><br><span class="line">4   5  Betty  sub5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mdf=pd.merge(left,right,left_on=&apos;sub_l&apos;,right_on=&apos;sub_r&apos;)</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">   id_x  Name_x sub_l  id_y Name_y sub_r</span><br><span class="line">0     2     Amy  sub2     1  Billy  sub2</span><br><span class="line">1     3   Allen  sub4     2  Brian  sub4</span><br><span class="line">2     4   Alice  sub6     4  Bryce  sub6</span><br><span class="line">3     5  Ayoung  sub5     5  Betty  sub5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">left = pd.DataFrame(&#123;</span><br><span class="line">         &apos;id&apos;:[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;],</span><br><span class="line">         &apos;Name&apos;: [&apos;Alex&apos;, &apos;Amy&apos;, &apos;Allen&apos;, &apos;Alice&apos;, &apos;Ayoung&apos;],</span><br><span class="line">         &apos;sub_l&apos;:[&apos;sub1&apos;,&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;)</span><br><span class="line">right = pd.DataFrame(</span><br><span class="line">         &#123;&apos;Name&apos;: [&apos;Billy&apos;, &apos;Brian&apos;, &apos;Bran&apos;, &apos;Bryce&apos;, &apos;Betty&apos;],</span><br><span class="line">         &apos;sub_r&apos;:[&apos;sub2&apos;,&apos;sub4&apos;,&apos;sub3&apos;,&apos;sub6&apos;,&apos;sub5&apos;]&#125;,index=[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;])</span><br><span class="line">print (left)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">print (right)</span><br><span class="line"></span><br><span class="line">  id    Name sub_l</span><br><span class="line">0  a    Alex  sub1</span><br><span class="line">1  b     Amy  sub2</span><br><span class="line">2  c   Allen  sub4</span><br><span class="line">3  d   Alice  sub6</span><br><span class="line">4  e  Ayoung  sub5</span><br><span class="line">========================================</span><br><span class="line">    Name sub_r</span><br><span class="line">a  Billy  sub2</span><br><span class="line">b  Brian  sub4</span><br><span class="line">c   Bran  sub3</span><br><span class="line">d  Bryce  sub6</span><br><span class="line">e  Betty  sub5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mdf=pd.merge(left,right,left_on=&apos;id&apos;,right_index=True)</span><br><span class="line">print(mdf)</span><br><span class="line"></span><br><span class="line">  id  Name_x sub_l Name_y sub_r</span><br><span class="line">0  a    Alex  sub1  Billy  sub2</span><br><span class="line">1  b     Amy  sub2  Brian  sub4</span><br><span class="line">2  c   Allen  sub4   Bran  sub3</span><br><span class="line">3  d   Alice  sub6  Bryce  sub6</span><br><span class="line">4  e  Ayoung  sub5  Betty  sub5</span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®å¸§çš„å †å concatï¼Œé»˜è®¤join-â€™outerâ€™å–å¹¶é›†ï¼Œaxis-0ç«–å‘å †å "><a href="#æ•°æ®å¸§çš„å †å concatï¼Œé»˜è®¤join-â€™outerâ€™å–å¹¶é›†ï¼Œaxis-0ç«–å‘å †å " class="headerlink" title="æ•°æ®å¸§çš„å †å concatï¼Œé»˜è®¤join=â€™outerâ€™å–å¹¶é›†ï¼Œaxis=0ç«–å‘å †å "></a>æ•°æ®å¸§çš„å †å concatï¼Œé»˜è®¤join=â€™outerâ€™å–å¹¶é›†ï¼Œaxis=0ç«–å‘å †å </h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;, &apos;A3&apos;],</span><br><span class="line">                    &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;, &apos;B3&apos;],</span><br><span class="line">                    &apos;C&apos;: [&apos;C0&apos;, &apos;C1&apos;, &apos;C2&apos;, &apos;C3&apos;],</span><br><span class="line">                    &apos;D&apos;: [&apos;D0&apos;, &apos;D1&apos;, &apos;D2&apos;, &apos;D3&apos;]&#125;,</span><br><span class="line">                   index=[0, 1, 2, 3])</span><br><span class="line">df2 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A4&apos;, &apos;A5&apos;, &apos;A6&apos;, &apos;A7&apos;],</span><br><span class="line">                    &apos;B&apos;: [&apos;B4&apos;, &apos;B5&apos;, &apos;B6&apos;, &apos;B7&apos;],</span><br><span class="line">                    &apos;C&apos;: [&apos;C4&apos;, &apos;C5&apos;, &apos;C6&apos;, &apos;C7&apos;],</span><br><span class="line">                    &apos;D&apos;: [&apos;D4&apos;, &apos;D5&apos;, &apos;D6&apos;, &apos;D7&apos;]&#125;,</span><br><span class="line">                   index=[4, 5, 6, 7])</span><br><span class="line">df3 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A8&apos;, &apos;A9&apos;, &apos;A10&apos;, &apos;A11&apos;],</span><br><span class="line">                    &apos;B&apos;: [&apos;B8&apos;, &apos;B9&apos;, &apos;B10&apos;, &apos;B11&apos;],</span><br><span class="line">                    &apos;C&apos;: [&apos;C8&apos;, &apos;C9&apos;, &apos;C10&apos;, &apos;C11&apos;],</span><br><span class="line">                    &apos;D&apos;: [&apos;D8&apos;, &apos;D9&apos;, &apos;D10&apos;, &apos;D11&apos;]&#125;,</span><br><span class="line">                   index=[8, 9, 10, 11])</span><br><span class="line"></span><br><span class="line">print(&quot;df1:&quot;)</span><br><span class="line">print(df1)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">print(&quot;df2:&quot;)</span><br><span class="line">print(df2)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">print(&quot;df3:&quot;)</span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line">df1:</span><br><span class="line">    A   B   C   D</span><br><span class="line">0  A0  B0  C0  D0</span><br><span class="line">1  A1  B1  C1  D1</span><br><span class="line">2  A2  B2  C2  D2</span><br><span class="line">3  A3  B3  C3  D3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df2:</span><br><span class="line">    A   B   C   D</span><br><span class="line">4  A4  B4  C4  D4</span><br><span class="line">5  A5  B5  C5  D5</span><br><span class="line">6  A6  B6  C6  D6</span><br><span class="line">7  A7  B7  C7  D7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df3:</span><br><span class="line">      A    B    C    D</span><br><span class="line">8    A8   B8   C8   D8</span><br><span class="line">9    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#é»˜è®¤join=&apos;outer&apos;å–å¹¶é›†ï¼Œé»˜è®¤axis=0ç«–å‘å †å </span><br><span class="line">cdf=pd.concat([df1,df2,df3]) </span><br><span class="line">print(cdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line"># ä½¿ç”¨ä¼ é€’çš„é”®ä½œä¸ºæœ€å¤–å±‚æ„å»ºå±‚æ¬¡ç´¢å¼•ã€‚</span><br><span class="line">cdf=pd.concat([df1,df2,df3],keys=[&apos;x&apos;,&apos;y&apos;,&apos;z&apos;])</span><br><span class="line">print(cdf)</span><br><span class="line"></span><br><span class="line">      A    B    C    D</span><br><span class="line">0    A0   B0   C0   D0</span><br><span class="line">1    A1   B1   C1   D1</span><br><span class="line">2    A2   B2   C2   D2</span><br><span class="line">3    A3   B3   C3   D3</span><br><span class="line">4    A4   B4   C4   D4</span><br><span class="line">5    A5   B5   C5   D5</span><br><span class="line">6    A6   B6   C6   D6</span><br><span class="line">7    A7   B7   C7   D7</span><br><span class="line">8    A8   B8   C8   D8</span><br><span class="line">9    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br><span class="line">========================================</span><br><span class="line">        A    B    C    D</span><br><span class="line">x 0    A0   B0   C0   D0</span><br><span class="line">  1    A1   B1   C1   D1</span><br><span class="line">  2    A2   B2   C2   D2</span><br><span class="line">  3    A3   B3   C3   D3</span><br><span class="line">y 4    A4   B4   C4   D4</span><br><span class="line">  5    A5   B5   C5   D5</span><br><span class="line">  6    A6   B6   C6   D6</span><br><span class="line">  7    A7   B7   C7   D7</span><br><span class="line">z 8    A8   B8   C8   D8</span><br><span class="line">  9    A9   B9   C9   D9</span><br><span class="line">  10  A10  B10  C10  D10</span><br><span class="line">  11  A11  B11  C11  D11</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#ä¿®æ”¹df3çš„indexç´¢å¼•ï¼Œæ–¹ä¾¿å¯¹æ¯”</span><br><span class="line">df3 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A8&apos;, &apos;A9&apos;, &apos;A10&apos;, &apos;A11&apos;],</span><br><span class="line">                    &apos;B&apos;: [&apos;B8&apos;, &apos;B9&apos;, &apos;B10&apos;, &apos;B11&apos;],</span><br><span class="line">                    &apos;C&apos;: [&apos;C8&apos;, &apos;C9&apos;, &apos;C10&apos;, &apos;C11&apos;],</span><br><span class="line">                    &apos;D&apos;: [&apos;D8&apos;, &apos;D9&apos;, &apos;D10&apos;, &apos;D11&apos;]&#125;,</span><br><span class="line">                   index=[6, 7, 10, 11])</span><br><span class="line">print(df3)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line"></span><br><span class="line">cdf=pd.concat([df1,df2,df3])</span><br><span class="line">print(cdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line"># å¦‚æœæƒ³è¦ç”Ÿæˆçš„å¯¹è±¡éµå¾ªæ–°çš„ç´¢å¼•ï¼Œè¯·å°†ignore_indexè®¾ç½®ä¸ºTrue</span><br><span class="line">cdf=pd.concat([df1,df2,df3],ignore_index=True)</span><br><span class="line">print(cdf)</span><br><span class="line"></span><br><span class="line">      A    B    C    D</span><br><span class="line">6    A8   B8   C8   D8</span><br><span class="line">7    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br><span class="line">========================================</span><br><span class="line">      A    B    C    D</span><br><span class="line">0    A0   B0   C0   D0</span><br><span class="line">1    A1   B1   C1   D1</span><br><span class="line">2    A2   B2   C2   D2</span><br><span class="line">3    A3   B3   C3   D3</span><br><span class="line">4    A4   B4   C4   D4</span><br><span class="line">5    A5   B5   C5   D5</span><br><span class="line">6    A6   B6   C6   D6</span><br><span class="line">7    A7   B7   C7   D7</span><br><span class="line">6    A8   B8   C8   D8</span><br><span class="line">7    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br><span class="line">========================================</span><br><span class="line">      A    B    C    D</span><br><span class="line">0    A0   B0   C0   D0</span><br><span class="line">1    A1   B1   C1   D1</span><br><span class="line">2    A2   B2   C2   D2</span><br><span class="line">3    A3   B3   C3   D3</span><br><span class="line">4    A4   B4   C4   D4</span><br><span class="line">5    A5   B5   C5   D5</span><br><span class="line">6    A6   B6   C6   D6</span><br><span class="line">7    A7   B7   C7   D7</span><br><span class="line">8    A8   B8   C8   D8</span><br><span class="line">9    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">cdf=pd.concat([df1,df2],axis=1) #æ¨ªå‘å †å æ•°æ®å¸§</span><br><span class="line">print(cdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">cdf=pd.concat([df2,df3],axis=1) #6,7ä¸¤è¡Œç´¢å¼•ä¸€æ ·</span><br><span class="line">print(cdf)</span><br><span class="line">print(&quot;========================================&quot;)</span><br><span class="line">cdf=pd.concat([df2,df3],axis=1,join=&apos;inner&apos;) #å–äº¤é›†</span><br><span class="line">print(cdf)</span><br><span class="line"></span><br><span class="line">     A    B    C    D    A    B    C    D</span><br><span class="line">0   A0   B0   C0   D0  NaN  NaN  NaN  NaN</span><br><span class="line">1   A1   B1   C1   D1  NaN  NaN  NaN  NaN</span><br><span class="line">2   A2   B2   C2   D2  NaN  NaN  NaN  NaN</span><br><span class="line">3   A3   B3   C3   D3  NaN  NaN  NaN  NaN</span><br><span class="line">4  NaN  NaN  NaN  NaN   A4   B4   C4   D4</span><br><span class="line">5  NaN  NaN  NaN  NaN   A5   B5   C5   D5</span><br><span class="line">6  NaN  NaN  NaN  NaN   A6   B6   C6   D6</span><br><span class="line">7  NaN  NaN  NaN  NaN   A7   B7   C7   D7</span><br><span class="line">========================================</span><br><span class="line">      A    B    C    D    A    B    C    D</span><br><span class="line">4    A4   B4   C4   D4  NaN  NaN  NaN  NaN</span><br><span class="line">5    A5   B5   C5   D5  NaN  NaN  NaN  NaN</span><br><span class="line">6    A6   B6   C6   D6   A8   B8   C8   D8</span><br><span class="line">7    A7   B7   C7   D7   A9   B9   C9   D9</span><br><span class="line">10  NaN  NaN  NaN  NaN  A10  B10  C10  D10</span><br><span class="line">11  NaN  NaN  NaN  NaN  A11  B11  C11  D11</span><br><span class="line">========================================</span><br><span class="line">    A   B   C   D   A   B   C   D</span><br><span class="line">6  A6  B6  C6  D6  A8  B8  C8  D8</span><br><span class="line">7  A7  B7  C7  D7  A9  B9  C9  D9</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cdf.index=[0,1]</span><br><span class="line">print(cdf)</span><br><span class="line"></span><br><span class="line">    A   B   C   D   A   B   C   D</span><br><span class="line">0  A6  B6  C6  D6  A8  B8  C8  D8</span><br><span class="line">1  A7  B7  C7  D7  A9  B9  C9  D9</span><br></pre></td></tr></table></figure>
<h2 id="å»é‡duplicated-drop-duplicates"><a href="#å»é‡duplicated-drop-duplicates" class="headerlink" title="å»é‡duplicated(),drop_duplicates()"></a>å»é‡duplicated(),drop_duplicates()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># å»é‡</span><br><span class="line">data=&#123;</span><br><span class="line">    &apos;age&apos;:[1,2,1,2,3,2,1,4,5,3]</span><br><span class="line">&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line">print(df.duplicated()) #å¾—åˆ°å¸ƒå°”å‹df</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line">#é€šè¿‡å¸ƒå°”å‹ç´¢å¼•å¾—åˆ°å»é‡åçš„å€¼</span><br><span class="line">print(df[df.duplicated()==False]) </span><br><span class="line"></span><br><span class="line">   age</span><br><span class="line">0    1</span><br><span class="line">1    2</span><br><span class="line">2    1</span><br><span class="line">3    2</span><br><span class="line">4    3</span><br><span class="line">5    2</span><br><span class="line">6    1</span><br><span class="line">7    4</span><br><span class="line">8    5</span><br><span class="line">9    3</span><br><span class="line">`````````````````````````</span><br></pre></td></tr></table></figure>
<p>0    False<br>1    False<br>2     True<br>3     True<br>4    False<br>5     True<br>6     True<br>7    False<br>8    False<br>9     True<br>dtype: bool<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">   age</span><br><span class="line">0    1</span><br><span class="line">1    2</span><br><span class="line">4    3</span><br><span class="line">7    4</span><br><span class="line">8    5</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line">```</span><br><span class="line">#åœ¨åŸæ•°æ®ä¹‹ä¸Šä¿®æ”¹</span><br><span class="line">df.drop_duplicates(inplace=True)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">   age</span><br><span class="line">0    1</span><br><span class="line">1    2</span><br><span class="line">4    3</span><br><span class="line">7    4</span><br><span class="line">8    5</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">## æ›¿æ¢replace</span><br><span class="line">```</span><br><span class="line">data=&#123;</span><br><span class="line">    &apos;name&apos;:[&apos;shu&apos;,&apos;lu&apos;,&apos;yun&apos;,&apos;wu&apos;,&apos;jia&apos;,&apos;yi&apos;],</span><br><span class="line">    &apos;age&apos;:[1,2,1,4,5,3]</span><br><span class="line">&#125;</span><br><span class="line">df=pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line"></span><br><span class="line">print(df[&apos;age&apos;].replace(1,18)) #ç”¨18æ›¿æ¢æ‰€æœ‰çš„1</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line"></span><br><span class="line">print(df[&apos;age&apos;].replace([2,4],20)) #ç”¨20æ›¿æ¢æ‰€æœ‰çš„2ï¼Œ4</span><br><span class="line">print(&apos;````````````````````````````&apos;)</span><br><span class="line"></span><br><span class="line">df[&apos;name&apos;].replace(&#123; #å¤šä¸ªå€¼åˆ†åˆ«æ›¿æ¢</span><br><span class="line">    &apos;lu&apos;:&apos;lulu&apos;,</span><br><span class="line">    &apos;yi&apos;:&apos;loveyi&apos;,</span><br><span class="line">    &apos;jia&apos;:&apos;jiaa&apos;</span><br><span class="line">&#125;,inplace=True) #inplace=Trueä¿®æ”¹åŸå§‹å€¼</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">  name  age</span><br><span class="line">0  shu    1</span><br><span class="line">1   lu    2</span><br><span class="line">2  yun    1</span><br><span class="line">3   wu    4</span><br><span class="line">4  jia    5</span><br><span class="line">5   yi    3</span><br></pre></td></tr></table></figure></p>
<p>0    18<br>1     2<br>2    18<br>3     4<br>4     5<br>5     3<br>Name: age, dtype: int64<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0     1</span><br><span class="line">1    20</span><br><span class="line">2     1</span><br><span class="line">3    20</span><br><span class="line">4     5</span><br><span class="line">5     3</span><br><span class="line">Name: age, dtype: int64</span><br></pre></td></tr></table></figure></p>
<pre><code>name  age
</code></pre><p>0     shu    1<br>1    lulu    2<br>2     yun    1<br>3      wu    4<br>4    jiaa    5<br>5  loveyi    3<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## åˆ†ç»„groupbyï¼Œæˆ‘ä»¬å°†æ•°æ®åˆ†æˆå¤šä¸ªé›†åˆï¼Œå¹¶åœ¨æ¯ä¸ªå­é›†ä¸Šåº”ç”¨ä¸€äº›å‡½æ•°</span><br><span class="line">- åˆ†ç»„åå¯ä»¥æ‰§è¡Œæ“ä½œï¼š</span><br><span class="line">- èšåˆï¼šè®¡ç®—æ±‡æ€»ç»Ÿè®¡ï¼ŒæŒ‡å¯¹æœ‰å…³æ•°æ®è¿›è¡Œå†…å®¹æŒ‘é€‰ã€åˆ†æã€å½’ç±»ï¼Œæœ€ååˆ†æå¾—åˆ°æƒ³è¦çš„ç»“æœ</span><br><span class="line">- è½¬æ¢ï¼šæ‰§è¡Œä¸€äº›ç‰¹å®šäºç»„çš„æ“ä½œ</span><br><span class="line">- è¿‡æ»¤ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ä¸¢å¼ƒæ•°æ®</span><br></pre></td></tr></table></figure></p>
<h1 id="æ•°æ®æ‹†åˆ†æˆç»„å¹¶æŸ¥çœ‹"><a href="#æ•°æ®æ‹†åˆ†æˆç»„å¹¶æŸ¥çœ‹" class="headerlink" title="æ•°æ®æ‹†åˆ†æˆç»„å¹¶æŸ¥çœ‹"></a><strong>æ•°æ®æ‹†åˆ†æˆç»„å¹¶æŸ¥çœ‹</strong></h1><p>import numpy as np<br>import pandas as pd</p>
<p>data = {<br>    â€˜Teamâ€™: [â€˜Ridersâ€™, â€˜Ridersâ€™, â€˜Devilsâ€™, â€˜Devilsâ€™, â€˜Kingsâ€™,<br>    â€˜kingâ€™, â€˜Kingsâ€™, â€˜Kingsâ€™, â€˜Ridersâ€™, â€˜Royalsâ€™, â€˜Royalsâ€™, â€˜Ridersâ€™],<br>    â€˜Rankâ€™: [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2],<br>    â€˜Yearâ€™: [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017],<br>    â€˜Pointsâ€™:[876,789,863,673,741,812,756,788,694,701,804,690]<br>}<br>df = pd.DataFrame(data)<br>print(df)<br>print(â€œ\nâ€)<br>gs = df.groupby(â€œTeamâ€) #æŒ‰åˆ—åˆ†ç»„<br>print(gs) #DataFrameGroupByç±»å¯¹è±¡<br>print(â€œ\nâ€)<br>print(gs.groups) #å­—å…¸å½¢å¼ï¼Œé”®ä¸ºé˜Ÿåï¼Œå€¼ä¸ºç´¢å¼•æ„æˆçš„åˆ—è¡¨<br>print(â€œ\nâ€)</p>
<pre><code>Team  Rank  Year  Points
</code></pre><p>0   Riders     1  2014     876<br>1   Riders     2  2015     789<br>2   Devils     2  2014     863<br>3   Devils     3  2015     673<br>4    Kings     3  2014     741<br>5     king     4  2015     812<br>6    Kings     1  2016     756<br>7    Kings     1  2017     788<br>8   Riders     2  2016     694<br>9   Royals     4  2014     701<br>10  Royals     1  2015     804<br>11  Riders     2  2017     690</p>
<p>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x000001FF1ACEE4C0&gt;</p>
<p>{â€˜Devilsâ€™: [2, 3], â€˜Kingsâ€™: [4, 6, 7], â€˜Ridersâ€™: [0, 1, 8, 11], â€˜Royalsâ€™: [9, 10], â€˜kingâ€™: [5]}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"># éå†åˆ†ç»„ç»“æœ</span><br><span class="line">gs = df.groupby(&quot;Team&quot;)</span><br><span class="line">for name, g in gs:</span><br><span class="line">    print(name)</span><br><span class="line">    print(g)</span><br><span class="line">    print(&quot;------------------------------&quot;)</span><br><span class="line"></span><br><span class="line">Devils</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">2  Devils     2  2014     863</span><br><span class="line">3  Devils     3  2015     673</span><br><span class="line">------------------------------</span><br><span class="line">Kings</span><br><span class="line">    Team  Rank  Year  Points</span><br><span class="line">4  Kings     3  2014     741</span><br><span class="line">6  Kings     1  2016     756</span><br><span class="line">7  Kings     1  2017     788</span><br><span class="line">------------------------------</span><br><span class="line">Riders</span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line">------------------------------</span><br><span class="line">Royals</span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">------------------------------</span><br><span class="line">king</span><br><span class="line">   Team  Rank  Year  Points</span><br><span class="line">5  king     4  2015     812</span><br><span class="line">------------------------------</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">gs = df.groupby([&quot;Team&quot;, &quot;Year&quot;]) #æŒ‰å¤šåˆ—åˆ†ç»„</span><br><span class="line">print(gs.groups)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">for name, g in gs:</span><br><span class="line">    print(name)</span><br><span class="line">    print(g)</span><br><span class="line">    print(&quot;-------------------------------&quot;)</span><br><span class="line"></span><br><span class="line">&#123;(&apos;Devils&apos;, 2014): [2], (&apos;Devils&apos;, 2015): [3], (&apos;Kings&apos;, 2014): [4], (&apos;Kings&apos;, 2016): [6], (&apos;Kings&apos;, 2017): [7], (&apos;Riders&apos;, 2014): [0], (&apos;Riders&apos;, 2015): [1], (&apos;Riders&apos;, 2016): [8], (&apos;Riders&apos;, 2017): [11], (&apos;Royals&apos;, 2014): [9], (&apos;Royals&apos;, 2015): [10], (&apos;king&apos;, 2015): [5]&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(&apos;Devils&apos;, 2014)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">2  Devils     2  2014     863</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Devils&apos;, 2015)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">3  Devils     3  2015     673</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Kings&apos;, 2014)</span><br><span class="line">    Team  Rank  Year  Points</span><br><span class="line">4  Kings     3  2014     741</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Kings&apos;, 2016)</span><br><span class="line">    Team  Rank  Year  Points</span><br><span class="line">6  Kings     1  2016     756</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Kings&apos;, 2017)</span><br><span class="line">    Team  Rank  Year  Points</span><br><span class="line">7  Kings     1  2017     788</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Riders&apos;, 2014)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">0  Riders     1  2014     876</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Riders&apos;, 2015)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">1  Riders     2  2015     789</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Riders&apos;, 2016)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">8  Riders     2  2016     694</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Riders&apos;, 2017)</span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Royals&apos;, 2014)</span><br><span class="line">     Team  Rank  Year  Points</span><br><span class="line">9  Royals     4  2014     701</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;Royals&apos;, 2015)</span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">-------------------------------</span><br><span class="line">(&apos;king&apos;, 2015)</span><br><span class="line">   Team  Rank  Year  Points</span><br><span class="line">5  king     4  2015     812</span><br><span class="line">-------------------------------</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># **é€‰æ‹©ä¸€ä¸ªåˆ†ç»„**</span><br><span class="line">gs = df.groupby(&quot;Year&quot;)</span><br><span class="line">g = gs.get_group(2017)</span><br><span class="line">print(g)</span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">11  Riders     2  2017     690</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">gs=df.groupby(df.dtypes,axis=1) #æŒ‰æ•°æ®ç±»å‹åˆ†ç»„</span><br><span class="line">for name, g in gs:</span><br><span class="line">    print(name)</span><br><span class="line">    print(g)</span><br><span class="line">    print(&quot;-------------------------------&quot;)</span><br><span class="line"></span><br><span class="line">int64</span><br><span class="line">    Rank  Year  Points</span><br><span class="line">0      1  2014     876</span><br><span class="line">1      2  2015     789</span><br><span class="line">2      2  2014     863</span><br><span class="line">3      3  2015     673</span><br><span class="line">4      3  2014     741</span><br><span class="line">5      4  2015     812</span><br><span class="line">6      1  2016     756</span><br><span class="line">7      1  2017     788</span><br><span class="line">8      2  2016     694</span><br><span class="line">9      4  2014     701</span><br><span class="line">10     1  2015     804</span><br><span class="line">11     2  2017     690</span><br><span class="line">-------------------------------</span><br><span class="line">object</span><br><span class="line">      Team</span><br><span class="line">0   Riders</span><br><span class="line">1   Riders</span><br><span class="line">2   Devils</span><br><span class="line">3   Devils</span><br><span class="line">4    Kings</span><br><span class="line">5     king</span><br><span class="line">6    Kings</span><br><span class="line">7    Kings</span><br><span class="line">8   Riders</span><br><span class="line">9   Royals</span><br><span class="line">10  Royals</span><br><span class="line">11  Riders</span><br><span class="line">-------------------------------</span><br></pre></td></tr></table></figure>
<h2 id="èšåˆï¼Œæ“ä½œåˆ†ç»„åçš„æ•°æ®"><a href="#èšåˆï¼Œæ“ä½œåˆ†ç»„åçš„æ•°æ®" class="headerlink" title="èšåˆï¼Œæ“ä½œåˆ†ç»„åçš„æ•°æ®"></a>èšåˆï¼Œæ“ä½œåˆ†ç»„åçš„æ•°æ®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"># èšåˆ **æ“ä½œåˆ†ç»„åçš„æ•°æ®**  å¿½ç•¥nanå€¼</span><br><span class="line">data = &#123;</span><br><span class="line">    &apos;Team&apos;: [&apos;Riders&apos;, &apos;Riders&apos;, &apos;Devils&apos;, &apos;Devils&apos;, &apos;Kings&apos;,</span><br><span class="line">    &apos;king&apos;, &apos;Kings&apos;, &apos;Kings&apos;, &apos;Riders&apos;, &apos;Royals&apos;, &apos;Royals&apos;, &apos;Riders&apos;],</span><br><span class="line">    &apos;Rank&apos;: [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2],</span><br><span class="line">    &apos;Year&apos;: [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017],</span><br><span class="line">    &apos;Points&apos;:[876,789,863,673,741,812,756,788,694,701,804,690]</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line"># åº”ç”¨ä¸€ä¸ªèšåˆå‡½æ•°</span><br><span class="line">gs=df.groupby(&apos;Team&apos;).sum()#æŒ‰é˜Ÿååˆ†ç»„ï¼Œå¹¶å¯¹æ¯ä¸ªé˜Ÿçš„å…¶ä»–é¡¹ç›®æ±‚å’Œ</span><br><span class="line">print(gs)</span><br><span class="line">print(&apos;----------------------------&apos;)</span><br><span class="line"></span><br><span class="line"># åŒæ—¶åº”ç”¨å¤šä¸ªèšåˆå‡½æ•°</span><br><span class="line">gs=df.groupby(&apos;Team&apos;)</span><br><span class="line"></span><br><span class="line"># è‹¥è¦å¯¹æ¯ä¸ªé¡¹ç›®éƒ½åº”ç”¨å¤šä¸ªå‡½æ•°ï¼Œåˆ™åªéœ€df.groupby(&apos;Team&apos;).agg([å„ä¸ªæ–¹æ³•å³å¯])</span><br><span class="line">#è¿™é‡Œï¼ŒæŒ‰é˜Ÿååˆ†ç»„ï¼Œå¹¶å¯¹æ¯ä¸ªé˜Ÿçš„&apos;Rank&apos;é¡¹ç›®æ±‚å„ä¸ªå€¼</span><br><span class="line">g=gs[&apos;Rank&apos;].agg([np.sum,np.min,np.size])#æŒ‰é˜Ÿååˆ†ç»„ï¼Œå¹¶å¯¹æ¯ä¸ªé˜Ÿçš„å…¶ä»–é¡¹ç›®æ±‚å’Œ</span><br><span class="line">print(g)</span><br><span class="line">g.columns=[&apos;æ±‚å’Œ&apos;,&apos;æœ€å°å€¼&apos;,&apos;ä¸ªæ•°&apos;]</span><br><span class="line">g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">2   Devils     2  2014     863</span><br><span class="line">3   Devils     3  2015     673</span><br><span class="line">4    Kings     3  2014     741</span><br><span class="line">5     king     4  2015     812</span><br><span class="line">6    Kings     1  2016     756</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Rank  Year  Points</span><br><span class="line">Team                      </span><br><span class="line">Devils     5  4029    1536</span><br><span class="line">Kings      5  6047    2285</span><br><span class="line">Riders     7  8062    3049</span><br><span class="line">Royals     5  4029    1505</span><br><span class="line">king       4  2015     812</span><br><span class="line">----------------------------</span><br><span class="line">        sum  amin  size</span><br><span class="line">Team                   </span><br><span class="line">Devils    5     2     2</span><br><span class="line">Kings     5     1     3</span><br><span class="line">Riders    7     1     4</span><br><span class="line">Royals    5     1     2</span><br><span class="line">king      4     4     1</span><br><span class="line"></span><br><span class="line">      æ±‚å’Œ	æœ€å°å€¼	ä¸ªæ•°</span><br><span class="line">Team			</span><br><span class="line">Devils	5	    2	    2</span><br><span class="line">Kings	  5	    1	    3</span><br><span class="line">Riders	7	    1	    4</span><br><span class="line">Royals	5	    1	    2</span><br><span class="line">king	  4	    4	    1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># applyèšåˆ åº”ç”¨è‡ªå·±å†™çš„å‡½æ•°</span><br><span class="line">data = &#123;</span><br><span class="line">    &apos;Team&apos;: [&apos;Riders&apos;, &apos;Riders&apos;, &apos;Devils&apos;, &apos;Devils&apos;, &apos;Kings&apos;,</span><br><span class="line">    &apos;king&apos;, &apos;Kings&apos;, &apos;Kings&apos;, &apos;Riders&apos;, &apos;Royals&apos;, &apos;Royals&apos;, &apos;Riders&apos;],</span><br><span class="line">    &apos;Rank&apos;: [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2],</span><br><span class="line">    &apos;Year&apos;: [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017],</span><br><span class="line">    &apos;Points&apos;:[876,789,863,673,741,812,756,788,694,701,804,690]</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line"># åº”ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„èšåˆå‡½æ•°</span><br><span class="line">gs=df.groupby(&apos;Team&apos;)[&apos;Rank&apos;].apply(lambda x:x+10)</span><br><span class="line">print(gs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">2   Devils     2  2014     863</span><br><span class="line">3   Devils     3  2015     673</span><br><span class="line">4    Kings     3  2014     741</span><br><span class="line">5     king     4  2015     812</span><br><span class="line">6    Kings     1  2016     756</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0     11</span><br><span class="line">1     12</span><br><span class="line">2     12</span><br><span class="line">3     13</span><br><span class="line">4     13</span><br><span class="line">5     14</span><br><span class="line">6     11</span><br><span class="line">7     11</span><br><span class="line">8     12</span><br><span class="line">9     14</span><br><span class="line">10    11</span><br><span class="line">11    12</span><br><span class="line">Name: Rank, dtype: int64</span><br></pre></td></tr></table></figure>
<h2 id="è½¬æ¢"><a href="#è½¬æ¢" class="headerlink" title="è½¬æ¢"></a>è½¬æ¢</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">print(df)</span><br><span class="line">gs = df.groupby(&quot;Team&quot;)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line"># è½¬æ¢è¿”å›ç´¢å¼•ä¸åŸDataFrameçš„ç´¢å¼•ç›¸åŒçš„å¯¹è±¡</span><br><span class="line"># å¯¹æ¯”gs=df.groupby(&apos;Team&apos;).sum()çœ‹æ›´å¥½ç†è§£</span><br><span class="line"></span><br><span class="line">print(gs.transform(np.sum))</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">print(gs[&quot;Points&quot;].transform(np.sum))</span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">2   Devils     2  2014     863</span><br><span class="line">3   Devils     3  2015     673</span><br><span class="line">4    Kings     3  2014     741</span><br><span class="line">5     king     4  2015     812</span><br><span class="line">6    Kings     1  2016     756</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Rank  Year  Points</span><br><span class="line">0      7  8062    3049</span><br><span class="line">1      7  8062    3049</span><br><span class="line">2      5  4029    1536</span><br><span class="line">3      5  4029    1536</span><br><span class="line">4      5  6047    2285</span><br><span class="line">5      4  2015     812</span><br><span class="line">6      5  6047    2285</span><br><span class="line">7      5  6047    2285</span><br><span class="line">8      7  8062    3049</span><br><span class="line">9      5  4029    1505</span><br><span class="line">10     5  4029    1505</span><br><span class="line">11     7  8062    3049</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0     3049</span><br><span class="line">1     3049</span><br><span class="line">2     1536</span><br><span class="line">3     1536</span><br><span class="line">4     2285</span><br><span class="line">5      812</span><br><span class="line">6     2285</span><br><span class="line">7     2285</span><br><span class="line">8     3049</span><br><span class="line">9     1505</span><br><span class="line">10    1505</span><br><span class="line">11    3049</span><br><span class="line">Name: Points, dtype: int64</span><br></pre></td></tr></table></figure>
<h2 id="è¿‡æ»¤-æ ¹æ®å®šä¹‰çš„æ ‡å‡†ï¼Œè¿‡æ»¤æ•°æ®å¹¶è¿”å›æ•°æ®çš„å­é›†"><a href="#è¿‡æ»¤-æ ¹æ®å®šä¹‰çš„æ ‡å‡†ï¼Œè¿‡æ»¤æ•°æ®å¹¶è¿”å›æ•°æ®çš„å­é›†" class="headerlink" title="è¿‡æ»¤ æ ¹æ®å®šä¹‰çš„æ ‡å‡†ï¼Œè¿‡æ»¤æ•°æ®å¹¶è¿”å›æ•°æ®çš„å­é›†"></a>è¿‡æ»¤ æ ¹æ®å®šä¹‰çš„æ ‡å‡†ï¼Œè¿‡æ»¤æ•°æ®å¹¶è¿”å›æ•°æ®çš„å­é›†</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">print(df)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">gs = df.groupby(&quot;Team&quot;)</span><br><span class="line">print(gs.groups)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">print(gs.filter(lambda x: len(x) &gt;= 4))</span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">2   Devils     2  2014     863</span><br><span class="line">3   Devils     3  2015     673</span><br><span class="line">4    Kings     3  2014     741</span><br><span class="line">5     king     4  2015     812</span><br><span class="line">6    Kings     1  2016     756</span><br><span class="line">7    Kings     1  2017     788</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">9   Royals     4  2014     701</span><br><span class="line">10  Royals     1  2015     804</span><br><span class="line">11  Riders     2  2017     690</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;&apos;Devils&apos;: [2, 3], &apos;Kings&apos;: [4, 6, 7], &apos;Riders&apos;: [0, 1, 8, 11], &apos;Royals&apos;: [9, 10], &apos;king&apos;: [5]&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Team  Rank  Year  Points</span><br><span class="line">0   Riders     1  2014     876</span><br><span class="line">1   Riders     2  2015     789</span><br><span class="line">8   Riders     2  2016     694</span><br><span class="line">11  Riders     2  2017     690</span><br></pre></td></tr></table></figure>
<h2 id="åˆ†ç±»æ•°æ®"><a href="#åˆ†ç±»æ•°æ®" class="headerlink" title="åˆ†ç±»æ•°æ®"></a>åˆ†ç±»æ•°æ®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># åˆ†ç±»æ˜¯Pandasä¸­çš„ä¸€ç§æ•°æ®ç±»å‹ï¼Œé€šå¸¸å®æ—¶çš„æ•°æ®åŒ…æ‹¬é‡å¤çš„æ–‡æœ¬åˆ—</span><br><span class="line"># ä¾‹å¦‚ï¼šæ€§åˆ«ï¼Œå›½å®¶å’Œä»£ç ç­‰ç‰¹å¾æ€»æ˜¯é‡å¤çš„</span><br><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    &quot;name&quot;: pd.Series([&quot;åˆ˜å¾·å&quot;, &quot;é˜¿å°”å¸•è¥¿è¯º&quot;, &quot;æˆå¾·å–„&quot;, &quot;å¼ å­¦å‹&quot;, &quot;é‡‘æ­£ç„•&quot;, &quot;åˆ€éƒ&quot;]),</span><br><span class="line">    &quot;country&quot;: pd.Series([&quot;ä¸­å›½&quot;, &quot;ç¾å›½&quot;, &quot;éŸ©å›½&quot;, &quot;ä¸­å›½&quot;, &quot;éŸ©å›½&quot;, &quot;ä¸­å›½&quot;],dtype=&apos;category&apos;),</span><br><span class="line">    &quot;sex&quot;: pd.Categorical([&quot;ç”·&quot;, &quot;ç”·&quot;, &quot;å¥³&quot;, &quot;ç”·&quot;, &quot;ç”·&quot;, &quot;ç”·&quot;])</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"></span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">name	country	sex</span><br><span class="line">0	åˆ˜å¾·å	ä¸­å›½	ç”·</span><br><span class="line">1	é˜¿å°”å¸•è¥¿è¯º	ç¾å›½	ç”·</span><br><span class="line">2	æˆå¾·å–„	éŸ©å›½	å¥³</span><br><span class="line">3	å¼ å­¦å‹	ä¸­å›½	ç”·</span><br><span class="line">4	é‡‘æ­£ç„•	éŸ©å›½	ç”·</span><br><span class="line">5	åˆ€éƒ	ä¸­å›½	ç”·</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">print(df[&apos;country&apos;])</span><br><span class="line">print(df[&apos;sex&apos;])</span><br><span class="line"></span><br><span class="line">0    ä¸­å›½</span><br><span class="line">1    ç¾å›½</span><br><span class="line">2    éŸ©å›½</span><br><span class="line">3    ä¸­å›½</span><br><span class="line">4    éŸ©å›½</span><br><span class="line">5    ä¸­å›½</span><br><span class="line">Name: country, dtype: category</span><br><span class="line">Categories (3, object): [&apos;ä¸­å›½&apos;, &apos;ç¾å›½&apos;, &apos;éŸ©å›½&apos;]</span><br><span class="line"></span><br><span class="line">0    ç”·</span><br><span class="line">1    ç”·</span><br><span class="line">2    å¥³</span><br><span class="line">3    ç”·</span><br><span class="line">4    ç”·</span><br><span class="line">5    ç”·</span><br><span class="line">Name: sex, dtype: category</span><br><span class="line">Categories (2, object): [&apos;å¥³&apos;, &apos;ç”·&apos;]</span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®é€è§†è¡¨"><a href="#æ•°æ®é€è§†è¡¨" class="headerlink" title="æ•°æ®é€è§†è¡¨"></a>æ•°æ®é€è§†è¡¨</h2><ul>
<li>æœªè®¾ç½®aggfuncæ—¶ï¼Œå®ƒé»˜è®¤aggfunc=â€™meanâ€™è®¡ç®—å‡å€¼</li>
<li>å®ƒæ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªé”®å¯¹æ•°æ®è¿›è¡Œèšåˆï¼Œ</li>
<li>å¹¶æ ¹æ®è¡Œå’Œåˆ—ä¸Šçš„åˆ†ç»„é”®å°†æ•°æ®åˆ†é…åˆ°å„ä¸ªçŸ©å½¢åŒºåŸŸä¸­ã€‚</li>
</ul>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>DataFrame</td>
</tr>
<tr>
<td>values</td>
<td>å¾…èšåˆçš„åˆ—çš„åç§°ã€‚é»˜è®¤èšåˆæ‰€æœ‰æ•°å€¼åˆ—</td>
</tr>
<tr>
<td>index</td>
<td>ç”¨äºåˆ†ç»„çš„åˆ—åæˆ–å…¶ä»–åˆ†ç»„é”®ï¼Œå‡ºç°åœ¨ç»“æœé€è§†è¡¨çš„è¡Œ</td>
</tr>
<tr>
<td>columns</td>
<td>ç”¨äºåˆ†ç»„çš„åˆ—åæˆ–å…¶ä»–åˆ†ç»„é”®ï¼Œå‡ºç°åœ¨ç»“æœé€è§†è¡¨çš„åˆ—</td>
</tr>
<tr>
<td>aggfunc</td>
<td>èšåˆå‡½æ•°æˆ–å‡½æ•°åˆ—è¡¨ï¼Œé»˜è®¤ä¸ºâ€˜meanâ€™ã€‚å¯ä»¥ä½¿ä»»ä½•å¯¹groupbyæœ‰æ•ˆçš„å‡½æ•°</td>
</tr>
<tr>
<td>fill_value</td>
<td>ç”¨äºæ›¿æ¢ç»“æœè¡¨ä¸­çš„ç¼ºå¤±å€¼</td>
</tr>
<tr>
<td>dropna</td>
<td>booleanï¼Œé»˜è®¤ä¸ºTrue</td>
</tr>
<tr>
<td>margins_name</td>
<td>stringï¼Œé»˜è®¤ä¸ºâ€˜ALLâ€™ï¼Œå½“å‚æ•°marginsä¸ºTrueæ—¶ï¼ŒALLè¡Œå’Œåˆ—çš„åå­—</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">path=&apos;E:/Users/lqy/Desktop/Pandaså­¦ä¹ /James_Harden.csv&apos;</span><br><span class="line">df = pd.read_csv(path)</span><br><span class="line">df.head()</span><br><span class="line"></span><br><span class="line">	å¯¹æ‰‹	èƒœè´Ÿ	ä¸»å®¢åœº	å‘½ä¸­	æŠ•ç¯®æ•°	æŠ•ç¯®å‘½ä¸­ç‡	3åˆ†å‘½ä¸­ç‡	ç¯®æ¿	åŠ©æ”»	å¾—åˆ†</span><br><span class="line">0	å‹‡å£«	èƒœ	å®¢	10	23	0.435	0.444	6	11	27</span><br><span class="line">1	å›½ç‹	èƒœ	å®¢	8	21	0.381	0.286	3	9	27</span><br><span class="line">2	å°ç‰›	èƒœ	ä¸»	10	19	0.526	0.462	3	7	29</span><br><span class="line">3	ç°ç†Š	è´Ÿ	ä¸»	8	20	0.400	0.250	5	8	22</span><br><span class="line">4	76äºº	èƒœ	å®¢	10	20	0.500	0.250	3	13	27</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">index</span><br><span class="line">ä½œç”¨ï¼šæ¯ä¸ªpivot_tableå¿…é¡»æ‹¥æœ‰ä¸€ä¸ªindexï¼ŒIndexå°±æ˜¯å±‚æ¬¡å­—æ®µï¼Œ</span><br><span class="line">è¦é€šè¿‡é€è§†è¡¨è·å–ä»€ä¹ˆä¿¡æ¯å°±æŒ‰ç…§ç›¸åº”çš„é¡ºåºè®¾ç½®å­—æ®µï¼Œ</span><br><span class="line">æ‰€ä»¥åœ¨è¿›è¡Œpivotä¹‹å‰ä½ ä¹Ÿéœ€è¦è¶³å¤Ÿäº†è§£ä½ çš„æ•°æ®</span><br><span class="line"></span><br><span class="line"># å¦‚æœæƒ³æŸ¥çœ‹å“ˆç™»å¯¹é˜µæ¯ä¸ªé˜Ÿä¼çš„å¾—åˆ†ï¼Œé¦–å…ˆæˆ‘ä»¬å°†å¯¹æ‰‹è®¾ç½®ä¸ºindex</span><br><span class="line">pd.pivot_table(df,index=[u&apos;å¯¹æ‰‹&apos;]).head()</span><br><span class="line"></span><br><span class="line">	  3åˆ†å‘½ä¸­ç‡	åŠ©æ”»	å‘½ä¸­	å¾—åˆ†	æŠ•ç¯®å‘½ä¸­ç‡	æŠ•ç¯®æ•°	ç¯®æ¿</span><br><span class="line">å¯¹æ‰‹							</span><br><span class="line">76äºº	0.3395	10.0	9.0	28.0	0.4405	20.5	3.5</span><br><span class="line">å‹‡å£«	0.4440	11.0	10.0	27.0	0.4350	23.0	6.0</span><br><span class="line">å›½ç‹	0.2860	9.0	8.0	27.0	0.3810	21.0	3.0</span><br><span class="line">å¤ªé˜³	0.5450	7.0	12.0	48.0	0.5450	22.0	2.0</span><br><span class="line">å°ç‰›	0.4620	7.0	10.0	29.0	0.5260	19.0	3.0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># å¯¹æ‰‹æˆä¸ºäº†ç¬¬ä¸€å±‚ç´¢å¼•ï¼Œè¿˜æƒ³çœ‹çœ‹å¯¹é˜µåŒä¸€å¯¹æ‰‹åœ¨ä¸åŒä¸»å®¢åœºä¸‹çš„æ•°æ®ï¼Œ</span><br><span class="line"># è¯•ç€å°†å¯¹æ‰‹ä¸èƒœè´Ÿä¸ä¸»å®¢åœºéƒ½è®¾ç½®ä¸ºindexï¼Œå…¶å®å°±å˜æˆä¸ºäº†ä¸¤å±‚ç´¢å¼•</span><br><span class="line">pd.pivot_table(df,index=[u&apos;å¯¹æ‰‹&apos;, u&apos;ä¸»å®¢åœº&apos;]).head()</span><br><span class="line"></span><br><span class="line">		3åˆ†å‘½ä¸­ç‡	åŠ©æ”»	å‘½ä¸­	å¾—åˆ†	æŠ•ç¯®å‘½ä¸­ç‡	æŠ•ç¯®æ•°	ç¯®æ¿</span><br><span class="line">å¯¹æ‰‹	ä¸»å®¢åœº							</span><br><span class="line">76äºº	ä¸»	0.429	7.0	8.0	29.0	0.381	21.0	4.0</span><br><span class="line">å®¢	0.250	13.0	10.0	27.0	0.500	20.0	3.0</span><br><span class="line">å‹‡å£«	å®¢	0.444	11.0	10.0	27.0	0.435	23.0	6.0</span><br><span class="line">å›½ç‹	å®¢	0.286	9.0	8.0	27.0	0.381	21.0	3.0</span><br><span class="line">å¤ªé˜³	å®¢	0.545	7.0	12.0	48.0	0.545	22.0	2.0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># è¯•ç€äº¤æ¢ä¸‹å®ƒä»¬çš„é¡ºåºï¼Œæ•°æ®ç»“æœä¸€æ ·</span><br><span class="line">pd.pivot_table(df,index=[u&apos;ä¸»å®¢åœº&apos;,u&apos;å¯¹æ‰‹&apos;]).head(15)</span><br><span class="line"></span><br><span class="line">		      3åˆ†å‘½ä¸­ç‡	åŠ©æ”»	å‘½ä¸­	å¾—åˆ†	æŠ•ç¯®å‘½ä¸­ç‡	æŠ•ç¯®æ•°	ç¯®æ¿</span><br><span class="line">ä¸»å®¢åœº	å¯¹æ‰‹							</span><br><span class="line">    ä¸»	76äºº	0.4290	7.0	8.0	29.0	0.381	21.0	4.0</span><br><span class="line">        å°ç‰›	0.4620	7.0	10.0	29.0	0.526	19.0	3.0</span><br><span class="line">        å°¼å…‹æ–¯	0.3850	10.0	12.0	37.0	0.444	27.0	2.0</span><br><span class="line">        æ˜é‡‘	0.1430	9.0	6.0	21.0	0.375	16.0	8.0</span><br><span class="line">        æ­¥è¡Œè€…	0.3330	10.0	8.0	29.0	0.364	22.0	8.0</span><br><span class="line">        ç°ç†Š	0.3395	8.0	9.5	30.0	0.420	22.5	4.5</span><br><span class="line">        çˆµå£«	0.8750	13.0	19.0	56.0	0.760	25.0	2.0</span><br><span class="line">        çŒ›é¾™	0.2730	11.0	8.0	38.0	0.320	25.0	6.0</span><br><span class="line">        ç¯®ç½‘	0.6150	8.0	13.0	37.0	0.650	20.0	10.0</span><br><span class="line">        éª‘å£«	0.4290	13.0	8.0	35.0	0.381	21.0	11.0</span><br><span class="line">        é¹ˆé¹•	0.4000	17.0	8.0	26.0	0.500	16.0	1.0</span><br><span class="line">    å®¢	76äºº	0.2500	13.0	10.0	27.0	0.500	20.0	3.0</span><br><span class="line">        å‹‡å£«	0.4440	11.0	10.0	27.0	0.435	23.0	6.0</span><br><span class="line">        å›½ç‹	0.2860	9.0	8.0	27.0	0.381	21.0	3.0</span><br><span class="line">        å¤ªé˜³	0.5450	7.0	12.0	48.0	0.545	22.0	2.0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># values</span><br><span class="line"># ä½œç”¨ï¼šå¯ä»¥å¯¹éœ€è¦çš„è®¡ç®—æ•°æ®è¿›è¡Œç­›é€‰</span><br><span class="line"># æ¡ˆä¾‹ï¼šæˆ‘ä»¬åªéœ€è¦james hardenåœ¨ä¸»å®¢åœºå’Œä¸åŒèƒœè´Ÿæƒ…å†µä¸‹çš„å¾—åˆ†ã€ç¯®æ¿ä¸åŠ©æ”»ä¸‰é¡¹æ•°æ®</span><br><span class="line">pd.pivot_table(df,index=[u&apos;ä¸»å®¢åœº&apos;,u&apos;èƒœè´Ÿ&apos;],values=[u&apos;å¾—åˆ†&apos;,u&apos;åŠ©æ”»&apos;,u&apos;ç¯®æ¿&apos;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                åŠ©æ”»	å¾—åˆ†	ç¯®æ¿</span><br><span class="line">ä¸»å®¢åœº èƒœè´Ÿ			</span><br><span class="line">  ä¸»	  èƒœ	10.555556	34.222222	5.444444</span><br><span class="line">        è´Ÿ	8.666667	29.666667	5.000000</span><br><span class="line">  å®¢	  èƒœ	9.000000	32.000000	4.916667</span><br><span class="line">        è´Ÿ	8.000000	20.000000	4.000000</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># aggfunc</span><br><span class="line"></span><br><span class="line"># ä½œç”¨ï¼šè®¾ç½®æˆ‘ä»¬å¯¹æ•°æ®èšåˆæ—¶è¿›è¡Œçš„å‡½æ•°æ“ä½œï¼Œæœªè®¾ç½®aggfuncæ—¶ï¼Œå®ƒé»˜è®¤aggfunc=&apos;mean&apos;è®¡ç®—å‡å€¼</span><br><span class="line"></span><br><span class="line"># 1. è·å¾—james hardenåœ¨ä¸»å®¢åœºå’Œä¸åŒèƒœè´Ÿæƒ…å†µä¸‹çš„æ€»å¾—åˆ†ã€æ€»ç¯®æ¿ã€æ€»åŠ©æ”»</span><br><span class="line">pd.pivot_table(df,index=[u&apos;ä¸»å®¢åœº&apos;,u&apos;èƒœè´Ÿ&apos;],values=[u&apos;å¾—åˆ†&apos;,u&apos;åŠ©æ”»&apos;,u&apos;ç¯®æ¿&apos;],aggfunc=[np.sum,np.max])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    sum	amax</span><br><span class="line">          åŠ©æ”»	å¾—åˆ†	ç¯®æ¿	åŠ©æ”»	å¾—åˆ†	ç¯®æ¿</span><br><span class="line">ä¸»å®¢åœº	èƒœè´Ÿ						</span><br><span class="line">    ä¸»	èƒœ	95	308	49	17	56	11</span><br><span class="line">        è´Ÿ	26	89	15	11	38	6</span><br><span class="line">    å®¢	èƒœ	108	384	59	15	48	10</span><br><span class="line">        è´Ÿ	8	  20	4	  8	  20	4</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># aggfuncä¹Ÿå¯ä»¥ä½¿ç”¨dictç±»å‹ï¼ŒåŠ©æ”»æ±‚min,maxå’Œmean,å¾—åˆ†æ±‚mean</span><br><span class="line">pd.pivot_table(df,index=[u&apos;å¯¹æ‰‹&apos;,u&apos;èƒœè´Ÿ&apos;],values=[u&apos;å¾—åˆ†&apos;,u&apos;åŠ©æ”»&apos;,u&apos;ç¯®æ¿&apos;],</span><br><span class="line">               aggfunc=&#123;u&apos;å¾—åˆ†&apos;:np.mean, u&apos;åŠ©æ”»&apos;:[min, max, np.mean]&#125;).head()</span><br><span class="line"></span><br><span class="line">		      åŠ©æ”»	        å¾—åˆ†</span><br><span class="line">          max	mean	min	mean</span><br><span class="line">å¯¹æ‰‹	èƒœè´Ÿ				</span><br><span class="line">76äºº	èƒœ	13.0	13.0	13.0	27.0</span><br><span class="line">      è´Ÿ	7.0	  7.0	  7.0	  29.0</span><br><span class="line">å‹‡å£«	èƒœ	11.0	11.0	11.0	27.0</span><br><span class="line">å›½ç‹	èƒœ	9.0	  9.0	  9.0	  27.0</span><br><span class="line">å¤ªé˜³	èƒœ	7.0	  7.0	  7.0	  48.0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># columns</span><br><span class="line"></span><br><span class="line"># ä½œç”¨ï¼šç±»ä¼¼Indexå¯ä»¥è®¾ç½®åˆ—å±‚æ¬¡å­—æ®µï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªå¿…è¦å‚æ•°ï¼Œä½œä¸ºä¸€ç§åˆ†å‰²æ•°æ®çš„å¯é€‰æ–¹å¼</span><br><span class="line">pd.pivot_table(df,index=[u&apos;å¯¹æ‰‹&apos;,u&apos;èƒœè´Ÿ&apos;],columns=[u&apos;ä¸»å®¢åœº&apos;],values=[u&apos;å¾—åˆ†&apos;]).head()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        å¾—åˆ†</span><br><span class="line">    ä¸»å®¢åœº	ä¸»	å®¢</span><br><span class="line">å¯¹æ‰‹	èƒœè´Ÿ		</span><br><span class="line">76äºº	èƒœ	NaN	27.0</span><br><span class="line">      è´Ÿ	29.0	NaN</span><br><span class="line">å‹‡å£«	èƒœ	NaN	27.0</span><br><span class="line">å›½ç‹	èƒœ	NaN	27.0</span><br><span class="line">å¤ªé˜³	èƒœ	NaN	48.0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># fill_value</span><br><span class="line"></span><br><span class="line"># ä½œç”¨ï¼šå¡«å……ç©ºå€¼</span><br><span class="line">pd.pivot_table(df,index=[u&apos;å¯¹æ‰‹&apos;,u&apos;èƒœè´Ÿ&apos;],columns=[u&apos;ä¸»å®¢åœº&apos;],values=[u&apos;å¾—åˆ†&apos;], fill_value=0).head()</span><br><span class="line"></span><br><span class="line">		  å¾—åˆ†</span><br><span class="line">    ä¸»å®¢åœº ä¸»	å®¢</span><br><span class="line">å¯¹æ‰‹	èƒœè´Ÿ		</span><br><span class="line">76äºº	èƒœ	0	  27</span><br><span class="line">      è´Ÿ	29	0</span><br><span class="line">å‹‡å£«	èƒœ	0	  27</span><br><span class="line">å›½ç‹	èƒœ	0	  27</span><br><span class="line">å¤ªé˜³	èƒœ	0	  48</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># margins</span><br><span class="line"></span><br><span class="line"># ä½œç”¨ï¼šæ˜¯å¦è¿›è¡Œæ±‡æ€»</span><br><span class="line">pd.pivot_table(df,index=[u&apos;ä¸»å®¢åœº&apos;],columns=[u&apos;å¯¹æ‰‹&apos;],values=[u&apos;å¾—åˆ†&apos;],aggfunc=[np.sum],fill_value=0,margins=1)</span><br><span class="line"></span><br><span class="line">	    sum</span><br><span class="line">      å¾—åˆ†</span><br><span class="line">å¯¹æ‰‹	76äºº	å‹‡å£«	å›½ç‹	å¤ªé˜³	å°ç‰›	å°¼å…‹æ–¯	å¼€æ‹“è€…	æ˜é‡‘	æ­¥è¡Œè€…	æ¹–äºº	ç°ç†Š	çˆµå£«	çŒ›é¾™	ç¯®ç½‘	è€é¹°	éª‘å£«	é¹ˆé¹•	é»„èœ‚	All</span><br><span class="line">ä¸»å®¢åœº																			</span><br><span class="line">  ä¸»	29	0	0	0	29	37	0	21	29	0	60	56	38	37	0	35	26	0	397</span><br><span class="line">  å®¢	27	27	27	48	0	31	48	0	26	36	49	29	0	0	29	0	0	27	404</span><br><span class="line">  All	56	27	27	48	29	68	48	21	55	36	109	85	38	37	29	35	26	27	801</span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®äº¤å‰è¡¨"><a href="#æ•°æ®äº¤å‰è¡¨" class="headerlink" title="æ•°æ®äº¤å‰è¡¨"></a>æ•°æ®äº¤å‰è¡¨</h2><ol>
<li>é€è§†è¡¨pivot_table()æ˜¯ä¸€ç§è¿›è¡Œåˆ†ç»„ç»Ÿè®¡çš„å‡½æ•°ï¼Œå‚æ•°aggfuncå†³å®šç»Ÿè®¡ç±»å‹</li>
<li>äº¤å‰è¡¨crosstab()æ˜¯ä¸€ç§ç‰¹æ®Šçš„pivot_table()ï¼Œä¸“ç”¨äºè®¡ç®—åˆ†ç»„é¢‘ç‡</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;&apos;Sample&apos;: range(1, 8), </span><br><span class="line">                   &apos;Gender&apos;: [&apos;Female&apos;, &apos;Male&apos;, &apos;Female&apos;, &apos;Male&apos;, &apos;Male&apos;, &apos;Male&apos;, &apos;Female&apos;], </span><br><span class="line">                   &apos;Handedness&apos;: [&apos;Right-handed&apos;, &apos;Left-handed&apos;, &apos;Right-handed&apos;, &apos;Right-handed&apos;, &apos;Left-handed&apos;, &apos;Right-handed&apos;, &apos;Right-handed&apos;]&#125;)</span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">	Sample	Gender	Handedness</span><br><span class="line">0	1	Female	Right-handed</span><br><span class="line">1	2	Male	Left-handed</span><br><span class="line">2	3	Female	Right-handed</span><br><span class="line">3	4	Male	Right-handed</span><br><span class="line">4	5	Male	Left-handed</span><br><span class="line">5	6	Male	Right-handed</span><br><span class="line">6	7	Female	Right-handed</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># éœ€æ±‚ï¼šæ ¹æ®æ€§åˆ«å’Œç”¨æ‰‹ä¹ æƒ¯å¯¹è¿™æ®µæ•°æ®è¿›è¡Œç»Ÿè®¡æ±‡æ€»</span><br><span class="line"></span><br><span class="line"># 1. pivot_table()å®ç°è¯¥åŠŸèƒ½</span><br><span class="line">pd.pivot_table(df, index=[&apos;Gender&apos;], columns=&apos;Handedness&apos;, aggfunc=len, margins=True)</span><br><span class="line"></span><br><span class="line">	    Sample</span><br><span class="line">Handedness	Left-handed	Right-handed	All</span><br><span class="line">    Gender			</span><br><span class="line">    Female	NaN	          3.0       	3</span><br><span class="line">      Male	2.0	          2.0	        4</span><br><span class="line">       All	2.0	          5.0	         7</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># crosstab()å‡½æ•°ä¼šæ›´æ–¹ä¾¿</span><br><span class="line">pd.crosstab(df.Gender, df.Handedness, margins=True)</span><br><span class="line"></span><br><span class="line">Handedness	Left-handed	Right-handed	All</span><br><span class="line">    Gender			</span><br><span class="line">    Female	0	              3	          3</span><br><span class="line">      Male	2	              2	          4</span><br><span class="line">      All	  2	              5	          7</span><br></pre></td></tr></table></figure>
<h2 id="IOæ“ä½œ-æ–‡ä»¶è¯»å†™"><a href="#IOæ“ä½œ-æ–‡ä»¶è¯»å†™" class="headerlink" title="IOæ“ä½œ æ–‡ä»¶è¯»å†™"></a>IOæ“ä½œ æ–‡ä»¶è¯»å†™</h2><table>
<thead>
<tr>
<th>read_csv</th>
<th>è¯»å–CSVæ–‡ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>read_excel</td>
<td>è¯»å–Excelæ–‡ä»¶</td>
</tr>
<tr>
<td>read_html</td>
<td>è¯»å–ç½‘é¡µHTMLæ–‡ä»¶</td>
</tr>
<tr>
<td>read_sql</td>
<td>è¯»å–sqlæ•°æ®åº“</td>
</tr>
<tr>
<td>read_sql_table</td>
<td>è¯»å–sqlæ•°æ®åº“ä¸­çš„è¡¨</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>å¸¸ç”¨å†™æ–‡ä»¶æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>to_csv</td>
<td>å†™CSVæ–‡ä»¶</td>
</tr>
<tr>
<td>to_excel</td>
<td>å†™Excelæ–‡ä»¶</td>
</tr>
<tr>
<td>to_sql</td>
<td>å†™æ•°æ®åº“</td>
</tr>
</tbody>
</table>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>encodingä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ç”¨utf-8ç¼–ç è¿›è¡Œä¿å­˜ï¼Œå¦‚æœå‡ºç°ä¸­æ–‡ç¼–ç é”™è¯¯ï¼Œåˆ™å¯ä»¥ä¾æ¬¡æ¢ç”¨gbkï¼Œgb2312 , gb18030ï¼Œä¸€èˆ¬æ€»èƒ½æˆåŠŸçš„ï¼Œæœ¬ä¾‹ä¸­ç”¨utf-8</li>
<li>to_csvæ–¹æ³•ï¼Œå…·ä½“å‚æ•°è¿˜æœ‰å¾ˆå¤šï¼Œå¯ä»¥å»çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œè¿™é‡Œæåˆ°ä¸€ä¸ªindex = Falseå‚æ•°ï¼Œè¡¨ç¤ºä¿å­˜csvçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ä¿å­˜pandas çš„Data frameçš„è¡Œç´¢å¼•1234è¿™æ ·çš„åºå·ï¼Œé»˜è®¤æƒ…å†µä¸åŠ çš„è¯æ˜¯index = Trueï¼Œä¼šæœ‰è¡Œå·ï¼Œè¿™ç‚¹åœ¨ä¿å­˜æ•°æ®åº“mysqlçš„æ—¶å€™ä½“ç°å°¤å…¶æ˜æ˜¾ï¼Œä¸æ³¨æ„çš„è¯å¯èƒ½ä¼šå‡ºé”™</li>
</ol>
<p><strong>ä»csvæ–‡ä»¶è¯»å–åï¼Œä½œä¸ºDataFrameæ—¶ï¼Œä¼šè‡ªåŠ¨æ·»åŠ ç´¢å¼•åˆ—ï¼Œç„¶åä¿å­˜ï¼Œå½“å†æ¬¡è¯»å–æ—¶ï¼Œä¼šå¤šä¸€åˆ—å«ï¼šUnnamed: 0 ï¼Œå¤„ç†å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df=pd.read_csv(&quot;./data.csv&quot;, index_col=[&quot;Unnamed: 0&quot;])</span><br><span class="line"></span><br><span class="line">æˆ–è€…ç›´æ¥åˆ é™¤è¿™ä¸€åˆ—ï¼š</span><br><span class="line"></span><br><span class="line">del df[&apos;Unnamed: 0&apos;]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#dtypeçš„åˆ—å¯ä»¥ä½œä¸ºå­—å…¸ä¼ é€’,åˆ†åˆ«æŒ‡å®šæŸä¸€åˆ—çš„æ•°æ®ç±»å‹</span><br><span class="line">dtype=&#123;&apos;id&apos;: np.float64&#125;</span><br></pre></td></tr></table></figure>
<p><div style="width:100%;height:1px;background-color:pink;opacity:.7"></div></p>
<center><a target="_blank" style="color:skyblue;font-weight:bold;" href="http://wpa.qq.com/msgrd?v=3&uin=2642816105&site=qq&menu=yes">æœ‰äº‹æ‚¨Qæˆ‘ğŸ‘‡</a></center>


      
    </div>
    
    
    

    
      <div>
        
<div style="text-align:center;color: #006400;font-size:14px;">
	------ The Happy Ending<i class="fa fa-paw"></i>Thanks for your reading! ------</div>

      </div>
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>å†™çš„ä¸é”™å˜›ï¼Œèµä½ åƒğŸ¬</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>ğŸ¤ğŸ¤ğŸ¤</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="æ¢¦ä¸æˆ å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="æ¢¦ä¸æˆ æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>
    æ¢¦ä¸æˆ
  </li>
  <li class="post-copyright-link">
    <strong>åŸå§‹é“¾æ¥ï¼š</strong>
    <a href="https://shulu520.com/pandas/Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®°/" title="Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®°">https://shulu520.com/pandas/Pythonæ•°æ®åˆ†æä¹‹pandasç¬”è®°/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> è®¸å¯åè®®ã€‚æ¬¢è¿è½¬è½½ï¼Œè¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/pandas/" rel="tag"><i class="fa fa-tag"></i> pandas</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        
          <div class="wp_rating">
            <div id="wpac-rating"></div>
          </div>
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/NumPy/Pythonæ•°æ®åˆ†æä¹‹NumPyç¬”è®°/" rel="next" title="æ•°æ®åˆ†æä¹‹NumPyç¬”è®°">
                <i class="fa fa-chevron-left"></i> æ•°æ®åˆ†æä¹‹NumPyç¬”è®°
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/æ•°æ®åˆ†æ/Pythonæ•°æ®åˆ†æä¹‹Matplotlibç¬”è®°/" rel="prev" title="Matplotlib">
                Matplotlib <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80MzgyMi8yMDM1Nw=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/head_icon.gif" alt="æ¢¦ä¸æˆ">
            
              <p class="site-author-name" itemprop="name">æ¢¦ä¸æˆ</p>
              <p class="site-description motion-element" itemprop="description">å›å­ç”Ÿéå¼‚ä¹Ÿï¼Œå–„å‡äºç‰©ä¹Ÿ</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">116</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">63</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">56</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/rss2.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lqyasl" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:2642816105@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#pandasæ•°æ®å¸§DataFrameåˆ—æ“ä½œ"><span class="nav-number">1.</span> <span class="nav-text">pandasæ•°æ®å¸§DataFrameåˆ—æ“ä½œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pandasæ•°æ®å¸§DataFrameè¡Œæ“ä½œ"><span class="nav-number">2.</span> <span class="nav-text">pandasæ•°æ®å¸§DataFrameè¡Œæ“ä½œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æŸ¥çœ‹å¤´å°¾"><span class="nav-number">3.</span> <span class="nav-text">æŸ¥çœ‹å¤´å°¾</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é‡å»ºç´¢å¼•reindex"><span class="nav-number">4.</span> <span class="nav-text">é‡å»ºç´¢å¼•reindex</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ’åº"><span class="nav-number">5.</span> <span class="nav-text">æ’åº</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å±‚æ¬¡åŒ–ç´¢å¼•"><span class="nav-number">6.</span> <span class="nav-text">å±‚æ¬¡åŒ–ç´¢å¼•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å±‚æ¬¡åŒ–ç´¢å¼•é€‰æ‹©"><span class="nav-number">7.</span> <span class="nav-text">å±‚æ¬¡åŒ–ç´¢å¼•é€‰æ‹©</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å±‚æ¬¡åŒ–è¡Œç´¢å¼•è¡Œåˆ—è½¬ç½®"><span class="nav-number">8.</span> <span class="nav-text">å±‚æ¬¡åŒ–è¡Œç´¢å¼•è¡Œåˆ—è½¬ç½®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ—¥æœŸä¸æ—¶é—´"><span class="nav-number">9.</span> <span class="nav-text">æ—¥æœŸä¸æ—¶é—´</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è·å–æ—¥æœŸã€æ—¶é—´å’Œæ—¶é—´æˆ³"><span class="nav-number">9.1.</span> <span class="nav-text">è·å–æ—¥æœŸã€æ—¶é—´å’Œæ—¶é—´æˆ³</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å­—ç¬¦ä¸²è½¬ä¸ºæ—¥æœŸæ—¶é—´"><span class="nav-number">9.2.</span> <span class="nav-text">å­—ç¬¦ä¸²è½¬ä¸ºæ—¥æœŸæ—¶é—´</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ—¶é—´å·®"><span class="nav-number">9.3.</span> <span class="nav-text">æ—¶é—´å·®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ—¶é—´æˆ³ç´¢å¼•DatetimeIndexçš„å¿«é€Ÿåˆ›å»º"><span class="nav-number">9.4.</span> <span class="nav-text">æ—¶é—´æˆ³ç´¢å¼•DatetimeIndexçš„å¿«é€Ÿåˆ›å»º</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é‡é‡‡æ ·"><span class="nav-number">10.</span> <span class="nav-text">é‡é‡‡æ ·</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#é™é‡‡æ ·"><span class="nav-number">10.1.</span> <span class="nav-text">é™é‡‡æ ·</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¢é‡‡æ ·"><span class="nav-number">10.2.</span> <span class="nav-text">å¢é‡‡æ ·</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯å‡½æ•°"><span class="nav-number">11.</span> <span class="nav-text">æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯å‡½æ•°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pandasçš„å­—ç¬¦ä¸²æ“ä½œ"><span class="nav-number">12.</span> <span class="nav-text">pandasçš„å­—ç¬¦ä¸²æ“ä½œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åˆ—çš„åˆå¹¶merge-ä»¥æŸä¸ªé”®ä¸ºå‚è€ƒï¼Œé»˜è®¤how-â€™innerâ€™ä½¿ç”¨é”®çš„äº¤é›†"><span class="nav-number">13.</span> <span class="nav-text">åˆ—çš„åˆå¹¶merge,ä»¥æŸä¸ªé”®ä¸ºå‚è€ƒï¼Œé»˜è®¤how=â€™innerâ€™ä½¿ç”¨é”®çš„äº¤é›†</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ•°æ®å¸§çš„å †å concatï¼Œé»˜è®¤join-â€™outerâ€™å–å¹¶é›†ï¼Œaxis-0ç«–å‘å †å "><span class="nav-number">14.</span> <span class="nav-text">æ•°æ®å¸§çš„å †å concatï¼Œé»˜è®¤join=â€™outerâ€™å–å¹¶é›†ï¼Œaxis=0ç«–å‘å †å </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å»é‡duplicated-drop-duplicates"><span class="nav-number">15.</span> <span class="nav-text">å»é‡duplicated(),drop_duplicates()</span></a></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#æ•°æ®æ‹†åˆ†æˆç»„å¹¶æŸ¥çœ‹"><span class="nav-number"></span> <span class="nav-text">æ•°æ®æ‹†åˆ†æˆç»„å¹¶æŸ¥çœ‹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#èšåˆï¼Œæ“ä½œåˆ†ç»„åçš„æ•°æ®"><span class="nav-number">1.</span> <span class="nav-text">èšåˆï¼Œæ“ä½œåˆ†ç»„åçš„æ•°æ®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è½¬æ¢"><span class="nav-number">2.</span> <span class="nav-text">è½¬æ¢</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è¿‡æ»¤-æ ¹æ®å®šä¹‰çš„æ ‡å‡†ï¼Œè¿‡æ»¤æ•°æ®å¹¶è¿”å›æ•°æ®çš„å­é›†"><span class="nav-number">3.</span> <span class="nav-text">è¿‡æ»¤ æ ¹æ®å®šä¹‰çš„æ ‡å‡†ï¼Œè¿‡æ»¤æ•°æ®å¹¶è¿”å›æ•°æ®çš„å­é›†</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åˆ†ç±»æ•°æ®"><span class="nav-number">4.</span> <span class="nav-text">åˆ†ç±»æ•°æ®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ•°æ®é€è§†è¡¨"><span class="nav-number">5.</span> <span class="nav-text">æ•°æ®é€è§†è¡¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ•°æ®äº¤å‰è¡¨"><span class="nav-number">6.</span> <span class="nav-text">æ•°æ®äº¤å‰è¡¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IOæ“ä½œ-æ–‡ä»¶è¯»å†™"><span class="nav-number">7.</span> <span class="nav-text">IOæ“ä½œ æ–‡ä»¶è¯»å†™</span></a></li></ol></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    
    <i class="fa fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">æ¢¦ä¸æˆ</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">æœ¬ç«™å­—æ•°å…±è®¡&#58;</span>
    
    <span title="æœ¬ç«™å­—æ•°å…±è®¡">132.7k</span>
  
</div>












<!-- ç½‘ç«™è¿è¡Œæ—¶é—´çš„è®¾ç½® -->
<span id="timeDate">è½½å…¥å¤©æ•°...</span>
<span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>  
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("04/17/2019 11:28:36");//æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²è¿è¡Œ "+dnum+" å¤© ";
        document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’";
    }
setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-users"></i> æ‚¨æ˜¯ç¬¬
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      ä½è®¿å®¢
    </span>
  

  
</div>








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  









  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  
  <script type="text/javascript">
  wpac_init = window.wpac_init || [];
  wpac_init.push({widget: 'Rating', id: 18789,
    el: 'wpac-rating',
    color: 'fc6423'
  });
  (function() {
    if ('WIDGETPACK_LOADED' in window) return;
    WIDGETPACK_LOADED = true;
    var mc = document.createElement('script');
    mc.type = 'text/javascript';
    mc.async = true;
    mc.src = '//embed.widgetpack.com/widget.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
  })();
  </script>


  

  

  


  
   <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas> 
   <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
   <script type="text/javascript" src="/js/src/fireworks.js"></script>
  
  
  undefined

  <!-- ç‚¹å‡»å¤åˆ¶æŒ‰é’® -->
  <script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script>
<script type="text/javascript" src="/js/src/custom.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"superSample":2,"width":160,"height":320,"position":"left","hOffset":-12,"vOffset":-43},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"tagMode":false});</script></body>
</html>
<!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>
